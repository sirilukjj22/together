var jSuites;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.jspreadsheet=t():e.jspreadsheet=t()}(self,function(){var __webpack_modules__={243:function(e){var n,o;function r(e){var t=o[e];return void 0!==t||(t=o[e]={exports:{}},n[e].call(t.exports,t,t.exports,r)),t.exports}e.exports=(n={765:function(e,t){var n=function(e){e.version="1.0.2";var d=Math;function c(e,t){for(var n=0,o=0;n<e.length;++n)o=t*o+e[n];return o}function p(e,t,n,o,r){if(0===t)return n;if(1===t)return o;for(var i=2/e,l=o,s=1;s<t;++s)l=o*s*i+r*n,n=o,o=l;return l}function t(n,o,e,r,i){return function(e,t){if(r){if(0===e)return 1==r?-1/0:1/0;if(e<0)return NaN}return 0===t?n(e):1===t?o(e):t<0?NaN:p(e,t|=0,n(e),o(e),i)}}function u(e,t){if(0===(t=Math.round(t)))return(n=e)<=3.75?c(j,n*n/14.0625):d.exp(d.abs(n))/d.sqrt(d.abs(n))*c(v,3.75/d.abs(n));var n;if(1===t)return(n=e)<3.75?n*c(y,n*n/14.0625):(n<0?-1:1)*d.exp(d.abs(n))/d.sqrt(d.abs(n))*c(x,3.75/d.abs(n));if(t<0)return NaN;if(0===d.abs(e))return 0;if(e==1/0)return 1/0;for(var o,r=0,i=2/d.abs(e),l=0,s=1,a=2*d.round((t+d.round(d.sqrt(40*t)))/2);0<a;a--)o=a*i*s+l,l=s,1e10<d.abs(s=o)&&(s*=1e-10,l*=1e-10,r*=1e-10),a==t&&(r=l);return r*=u(e,0)/s,e<0&&t%2?-r:r}C=.636619772,E=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),A=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),L=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),M=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse(),I=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),N=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),T=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),D=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();var i,l,s,a,f,h,g,m,b,j,v,y,x,n,o,r,w,C,E,A,L,M,I,N,T,D,S=function e(t,n){if(n=Math.round(n),!isFinite(t))return isNaN(t)?t:0;if(n<0)return(n%2?-1:1)*e(t,-n);if(t<0)return(n%2?-1:1)*e(-t,n);if(0===n)return k(t);if(1===n)return R(t);if(0===t)return 0;var o=0;if(n<t)o=p(t,n,k(t),R(t),-1);else{for(var r,i=!1,l=0,s=0,a=1,c=2/t,u=2*d.floor((n+d.floor(d.sqrt(40*n)))/2);0<u;u--)r=u*c*a-l,l=a,1e10<d.abs(a=r)&&(a*=1e-10,l*=1e-10,o*=1e-10,s*=1e-10),i&&(s+=a),i=!i,u==n&&(o=l);o/=s=2*s-a}return o},O=(i=.636619772,l=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),s=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),a=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),f=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),h=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),g=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),m=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),b=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),t(function(e){var t=0,n=0,o=e*e,r=e-.785398164;return e<8?(t=c(l,o))/(n=c(s,o))+i*S(e,0)*d.log(e):(t=c(a,o=64/o),n=c(f,o),d.sqrt(i/e)*(d.sin(r)*t+d.cos(r)*n*8/e))},function(e){var t=0,n=0,o=e*e,r=e-2.356194491;return e<8?(t=e*c(h,o))/(n=c(g,o))+i*(S(e,1)*d.log(e)-1/e):(t=c(m,o=64/o),n=c(b,o),d.sqrt(i/e)*(d.sin(r)*t+d.cos(r)*n*8/e))},0,1,-1)),F=(j=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),v=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),y=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),x=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),n=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),o=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),r=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),w=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse(),t(function(e){return e<=2?-d.log(e/2)*u(e,0)+c(n,e*e/4):d.exp(-e)/d.sqrt(e)*c(o,2/e)},function(e){return e<=2?d.log(e/2)*u(e,1)+1/e*c(r,e*e/4):d.exp(-e)/d.sqrt(e)*c(w,2/e)},0,2,1));function k(e){var t,n=0,o=0,r=e*e;return e<8?(n=c(E,r))/(o=c(A,r)):(t=e-.785398164,n=c(L,r=64/r),o=c(M,r),d.sqrt(C/e)*(d.cos(t)*n-d.sin(t)*o*8/e))}function R(e){var t=0,n=0,o=0,r=e*e,i=d.abs(e)-2.356194491;return Math.abs(e)<8?t=(n=e*c(I,r))/(o=c(N,r)):(n=c(T,r=64/r),o=c(D,r),t=d.sqrt(C/d.abs(e))*(d.cos(i)*n-d.sin(i)*o*8/d.abs(e)),e<0&&(t=-t)),t}e.besselj=S,e.bessely=O,e.besseli=u,e.besselk=F};"undefined"==typeof DO_NOT_EXPORT_BESSEL?n(t):n({})},162:function(e){var p,c,u,d,i,n;function f(e,t){var n=e.length,o=t[0].length-1,r=n-o-1,i=p.lstsq(t,e),l=p.multiply(t,i.map(function(e){return[e]})).map(function(e){return e[0]}),s=p.subtract(e,l),a=p.mean(e),c=p.sum(l.map(function(e){return Math.pow(e-a,2)})),u=p.sum(e.map(function(e,t){return Math.pow(e-l[t],2)})),d=c+u;return{exog:t,endog:e,nobs:n,df_model:o,df_resid:r,coef:i,predict:l,resid:s,ybar:a,SST:d,SSE:c,SSR:u,R2:c/d}}function r(e,t,n,o){if(1<e||1<n||e<=0||n<=0)throw new Error("Proportions should be greater than 0 and less than 1");var r=(e*t+n*o)/(t+o);return(e-n)/u.sqrt(r*(1-r)*(1/t+1/o))}e.exports=(function(a,u){var c=a.utils.isFunction;function d(e,t){return e-t}function p(e,t,n){return u.max(t,u.min(e,n))}a.sum=function(e){for(var t=0,n=e.length;0<=--n;)t+=e[n];return t},a.sumsqrd=function(e){for(var t=0,n=e.length;0<=--n;)t+=e[n]*e[n];return t},a.sumsqerr=function(e){for(var t,n=a.mean(e),o=0,r=e.length;0<=--r;)o+=(t=e[r]-n)*t;return o},a.sumrow=function(e){for(var t=0,n=e.length;0<=--n;)t+=e[n];return t},a.product=function(e){for(var t=1,n=e.length;0<=--n;)t*=e[n];return t},a.min=function(e){for(var t=e[0],n=0;++n<e.length;)e[n]<t&&(t=e[n]);return t},a.max=function(e){for(var t=e[0],n=0;++n<e.length;)e[n]>t&&(t=e[n]);return t},a.unique=function(e){for(var t={},n=[],o=0;o<e.length;o++)t[e[o]]||(t[e[o]]=!0,n.push(e[o]));return n},a.mean=function(e){return a.sum(e)/e.length},a.meansqerr=function(e){return a.sumsqerr(e)/e.length},a.geomean=function(e){e=e.map(u.log),e=a.mean(e);return u.exp(e)},a.median=function(e){var t=e.length,e=e.slice().sort(d);return 1&t?e[t/2|0]:(e[t/2-1]+e[t/2])/2},a.cumsum=function(e){return a.cumreduce(e,function(e,t){return e+t})},a.cumprod=function(e){return a.cumreduce(e,function(e,t){return e*t})},a.diff=function(e){for(var t=[],n=e.length,o=1;o<n;o++)t.push(e[o]-e[o-1]);return t},a.rank=function(e){for(var t=[],n={},o=0;o<e.length;o++)n[s=e[o]]?n[s]++:(n[s]=1,t.push(s));var r=t.sort(d),i={},l=1;for(o=0;o<r.length;o++){var s,a=n[s=r[o]];i[s]=(l+(l+a-1))/2,l+=a}return e.map(function(e){return i[e]})},a.mode=function(e){for(var t=e.length,n=e.slice().sort(d),o=1,r=0,i=0,l=[],s=0;s<t;s++)n[s]===n[s+1]?o++:(r<o?(l=[n[s]],r=o,i=0):o===r&&(l.push(n[s]),i++),o=1);return 0===i?l[0]:l},a.range=function(e){return a.max(e)-a.min(e)},a.variance=function(e,t){return a.sumsqerr(e)/(e.length-(t?1:0))},a.pooledvariance=function(e){return e.reduce(function(e,t){return e+a.sumsqerr(t)},0)/(e.reduce(function(e,t){return e+t.length},0)-e.length)},a.deviation=function(e){for(var t=a.mean(e),n=e.length,o=new Array(n),r=0;r<n;r++)o[r]=e[r]-t;return o},a.stdev=function(e,t){return u.sqrt(a.variance(e,t))},a.pooledstdev=function(e){return u.sqrt(a.pooledvariance(e))},a.meandev=function(e){for(var t=a.mean(e),n=[],o=e.length-1;0<=o;o--)n.push(u.abs(e[o]-t));return a.mean(n)},a.meddev=function(e){for(var t=a.median(e),n=[],o=e.length-1;0<=o;o--)n.push(u.abs(e[o]-t));return a.median(n)},a.coeffvar=function(e){return a.stdev(e)/a.mean(e)},a.quartiles=function(e){var t=e.length,e=e.slice().sort(d);return[e[u.round(t/4)-1],e[u.round(t/2)-1],e[u.round(3*t/4)-1]]},a.quantiles=function(e,t,n,o){var r,i,l,s=e.slice().sort(d),a=[t.length],c=e.length;for(void 0===n&&(n=3/8),void 0===o&&(o=3/8),r=0;r<t.length;r++)l=c*(l=t[r])+(n+l*(1-n-o)),i=u.floor(p(l,1,c-1)),l=p(l-i,0,1),a[r]=(1-l)*s[i-1]+l*s[i];return a},a.percentile=function(e,t,n){e=e.slice().sort(d),t=t*(e.length+(n?1:-1))+(n?0:1),n=parseInt(t);return n+1<e.length?e[n-1]+(t-n)*(e[n]-e[n-1]):e[n-1]},a.percentileOfScore=function(e,t,n){for(var o,r=0,i=e.length,l="strict"===n?!0:!1,s=0;s<i;s++)o=e[s],(l&&o<t||!l&&o<=t)&&r++;return r/i},a.histogram=function(e,t){t=t||4;for(var n=a.min(e),o=(a.max(e)-n)/t,r=e.length,i=[],l=0;l<t;l++)i[l]=0;for(l=0;l<r;l++)i[u.min(u.floor((e[l]-n)/o),t-1)]+=1;return i},a.covariance=function(e,t){for(var n=a.mean(e),o=a.mean(t),r=e.length,i=new Array(r),l=0;l<r;l++)i[l]=(e[l]-n)*(t[l]-o);return a.sum(i)/(r-1)},a.corrcoeff=function(e,t){return a.covariance(e,t)/a.stdev(e,1)/a.stdev(t,1)},a.spearmancoeff=function(e,t){return e=a.rank(e),t=a.rank(t),a.corrcoeff(e,t)},a.stanMoment=function(e,t){for(var n=a.mean(e),o=a.stdev(e),r=e.length,i=0,l=0;l<r;l++)i+=u.pow((e[l]-n)/o,t);return i/e.length},a.skewness=function(e){return a.stanMoment(e,3)},a.kurtosis=function(e){return a.stanMoment(e,4)-3};for(var f=a.prototype,e="cumsum cumprod".split(" "),t=0;t<e.length;t++)!function(i){f[i]=function(e,t){var n=[],o=0,r=this;if(c(e)&&(t=e,e=!1),t)return setTimeout(function(){t.call(r,f[i].call(r,e))}),this;if(1<this.length){for(r=!0===e?this:this.transpose();o<r.length;o++)n[o]=a[i](r[o]);return n}return a[i](this[0],e)}}(e[t]);for(var n="sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" "),o=0;o<n.length;o++)!function(i){f[i]=function(e,t){var n=[],o=0,r=this;if(c(e)&&(t=e,e=!1),t)return setTimeout(function(){t.call(r,f[i].call(r,e))}),this;if(1<this.length){for("sumrow"!==i&&(r=!0===e?this:this.transpose());o<r.length;o++)n[o]=a[i](r[o]);return!0===e?a[i](a.utils.toVector(n)):n}return a[i](this[0],e)}}(n[o]);for(var r="quantiles percentileOfScore".split(" "),i=0;i<r.length;i++)!function(s){f[s]=function(){var e,t,n=[],o=0,r=this,i=Array.prototype.slice.call(arguments);if(c(i[i.length-1]))return e=i[i.length-1],t=i.slice(0,i.length-1),setTimeout(function(){e.call(r,f[s].apply(r,t))}),this;e=void 0;function l(e){return a[s].apply(r,[e].concat(i))}if(1<this.length){for(r=r.transpose();o<r.length;o++)n[o]=l(r[o]);return n}return l(this[0])}}(r[i])}(p=function(s,a){var t=Array.prototype.concat,e=Array.prototype.slice,n=Object.prototype.toString;function c(e,t){e=t<e?e:t;return s.pow(10,17-~~(s.log(0<e?e:-e)*s.LOG10E))}var u=Array.isArray||function(e){return"[object Array]"===n.call(e)};function d(e){return"[object Function]"===n.call(e)}function p(e){return"number"==typeof e&&e-e==0}function f(){return new f._init(arguments)}function o(){return 0}function r(){return 1}function i(e,t){return e===t?1:0}function l(e,t,n,o){var r,i=[],l=e.length;if(t===a&&n===a&&o===a)return f.copy(e);if(o=o||1,(t=0<=(t=t||0)?t:l+t)===(n=0<=(n=n||e.length)?n:l+n)||0===o)return[];if(t<n&&o<0)return[];if(n<t&&0<o)return[];if(0<o)for(r=t;r<n;r+=o)i.push(e[r]);else for(r=t;n<r;r+=o)i.push(e[r]);return i}f.fn=f.prototype,(f._init=function(e){if(u(e[0]))if(u(e[0][0])){d(e[1])&&(e[0]=f.map(e[0],e[1]));for(var t=0;t<e[0].length;t++)this[t]=e[0][t];this.length=e[0].length}else this[0]=d(e[1])?f.map(e[0],e[1]):e[0],this.length=1;else{if(p(e[0]))this[0]=f.seq.apply(null,e);else{if(e[0]instanceof f)return f(e[0].toArray());this[0]=[]}this.length=1}return this}).prototype=f.prototype,(f._init.constructor=f).utils={calcRdx:c,isArray:u,isFunction:d,isNumber:p,toVector:function(e){return t.apply([],e)}},f._random_fn=s.random,f.setRandom=function(e){if("function"!=typeof e)throw new TypeError("fn is not a function");f._random_fn=e},f.extend=function(e){var t,n;if(1===arguments.length){for(n in e)f[n]=e[n];return this}for(t=1;t<arguments.length;t++)for(n in arguments[t])e[n]=arguments[t][n];return e},f.rows=function(e){return e.length||1},f.cols=function(e){return e[0].length||1},f.dimensions=function(e){return{rows:f.rows(e),cols:f.cols(e)}},f.row=function(t,e){return u(e)?e.map(function(e){return f.row(t,e)}):t[e]},f.rowa=function(e,t){return f.row(e,t)},f.col=function(o,e){var r;if(u(e))return r=f.arange(o.length).map(function(){return new Array(e.length)}),e.forEach(function(t,n){f.arange(o.length).forEach(function(e){r[e][n]=o[e][t]})}),r;for(var t=new Array(o.length),n=0;n<o.length;n++)t[n]=[o[n][e]];return t},f.cola=function(e,t){return f.col(e,t).map(function(e){return e[0]})},f.diag=function(e){for(var t=f.rows(e),n=new Array(t),o=0;o<t;o++)n[o]=[e[o][o]];return n},f.antidiag=function(e){for(var t=f.rows(e)-1,n=new Array(t),o=0;0<=t;t--,o++)n[o]=[e[o][t]];return n},f.transpose=function(e){for(var t,n,o=[],r=(e=u(e[0])?e:[e]).length,i=e[0].length,l=0;l<i;l++){for(t=new Array(r),n=0;n<r;n++)t[n]=e[n][l];o.push(t)}return 1===o.length?o[0]:o},f.map=function(e,t,n){for(var o,r=(e=u(e[0])?e:[e]).length,i=e[0].length,l=n?e:new Array(r),s=0;s<r;s++)for(l[s]||(l[s]=new Array(i)),o=0;o<i;o++)l[s][o]=t(e[s][o],s,o);return 1===l.length?l[0]:l},f.cumreduce=function(e,t,n){for(var o,r=(e=u(e[0])?e:[e]).length,i=e[0].length,l=n?e:new Array(r),s=0;s<r;s++)for(l[s]||(l[s]=new Array(i)),0<i&&(l[s][0]=e[s][0]),o=1;o<i;o++)l[s][o]=t(l[s][o-1],e[s][o]);return 1===l.length?l[0]:l},f.alter=function(e,t){return f.map(e,t,!0)},f.create=function(e,t,n){var o,r,i=new Array(e);for(d(t)&&(n=t,t=e),o=0;o<e;o++)for(i[o]=new Array(t),r=0;r<t;r++)i[o][r]=n(o,r);return i},f.zeros=function(e,t){return p(t)||(t=e),f.create(e,t,o)},f.ones=function(e,t){return p(t)||(t=e),f.create(e,t,r)},f.rand=function(e,t){return p(t)||(t=e),f.create(e,t,f._random_fn)},f.identity=function(e,t){return p(t)||(t=e),f.create(e,t,i)},f.symmetric=function(e){var t,n,o=e.length;if(e.length!==e[0].length)return!1;for(t=0;t<o;t++)for(n=0;n<o;n++)if(e[n][t]!==e[t][n])return!1;return!0},f.clear=function(e){return f.alter(e,o)},f.seq=function(e,t,n,o){d(o)||(o=!1);for(var r=[],i=c(e,t),l=(t*i-e*i)/((n-1)*i),s=e,a=0;s<=t&&a<n;s=(e*i+l*i*++a)/i)r.push(o?o(s,a):s);return r},f.arange=function(e,t,n){var o,r=[];if(n=n||1,t===a&&(t=e,e=0),e===t||0===n)return[];if(e<t&&n<0)return[];if(t<e&&0<n)return[];if(0<n)for(o=e;o<t;o+=n)r.push(o);else for(o=e;t<o;o+=n)r.push(o);return r},f.slice=function(e,t){var n,o;return p((t=t||{}).row)?p(t.col)?e[t.row][t.col]:l(f.rowa(e,t.row),(n=t.col||{}).start,n.end,n.step):p(t.col)?l(f.cola(e,t.col),(o=t.row||{}).start,o.end,o.step):(o=t.row||{},n=t.col||{},l(e,o.start,o.end,o.step).map(function(e){return l(e,n.start,n.end,n.step)}))},f.sliceAssign=function(r,e,i){var t,n;if(p(e.row)){if(p(e.col))return r[e.row][e.col]=i;e.col=e.col||{},e.col.start=e.col.start||0,e.col.end=e.col.end||r[0].length,e.col.step=e.col.step||1;var l=f.arange(e.col.start,s.min(r.length,e.col.end),e.col.step),o=e.row;l.forEach(function(e,t){r[o][e]=i[t]})}else p(e.col)?(e.row=e.row||{},e.row.start=e.row.start||0,e.row.end=e.row.end||r.length,e.row.step=e.row.step||1,t=f.arange(e.row.start,s.min(r[0].length,e.row.end),e.row.step),n=e.col,t.forEach(function(e,t){r[e][n]=i[t]})):(i[0].length===a&&(i=[i]),e.row.start=e.row.start||0,e.row.end=e.row.end||r.length,e.row.step=e.row.step||1,e.col.start=e.col.start||0,e.col.end=e.col.end||r[0].length,e.col.step=e.col.step||1,t=f.arange(e.row.start,s.min(r.length,e.row.end),e.row.step),l=f.arange(e.col.start,s.min(r[0].length,e.col.end),e.col.step),t.forEach(function(n,o){l.forEach(function(e,t){r[n][e]=i[o][t]})}));return r},f.diagonal=function(e){var n=f.zeros(e.length,e.length);return e.forEach(function(e,t){n[t][t]=e}),n},f.copy=function(e){return e.map(function(e){return p(e)?e:e.map(function(e){return e})})};for(var h=f.prototype,g=(h.length=0,h.push=Array.prototype.push,h.sort=Array.prototype.sort,h.splice=Array.prototype.splice,h.slice=Array.prototype.slice,h.toArray=function(){return 1<this.length?e.call(this):e.call(this)[0]},h.map=function(e,t){return f(f.map(this,e,t))},h.cumreduce=function(e,t){return f(f.cumreduce(this,e,t))},h.alter=function(e){return f.alter(this,e),this},"transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),m=0;m<g.length;m++)!function(o){h[o]=function(e){var t,n=this;return e?(setTimeout(function(){e.call(n,h[o].call(n))}),this):(t=f[o](this),u(t)?f(t):t)}}(g[m]);for(var b="row col".split(" "),j=0;j<b.length;j++)!function(o){h[o]=function(e,t){var n=this;return t?(setTimeout(function(){t.call(n,h[o].call(n,e))}),this):f(f[o](this,e))}}(b[j]);for(var v="create zeros ones rand identity".split(" "),y=0;y<v.length;y++)!function(e){h[e]=function(){return f(f[e].apply(null,arguments))}}(v[y]);return f}(Math),Math),function(f,h){f.gammaln=function(e){var t,n=0,o=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],r=1.000000000190015,i=(t=e=e)+5.5;for(i-=(e+.5)*h.log(i);n<6;n++)r+=o[n]/++t;return h.log(2.5066282746310007*r/e)-i},f.loggam=function(e){var t,n,o,r,i,l=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059],s=e,a=0;if(1==e||2==e)return 0;for(t=1/((s=e<=7?e+(a=h.floor(7-e)):s)*s),n=2*h.PI,r=l[9],i=8;0<=i;i--)r=r*t+l[i];if(o=r/s+.5*h.log(n)+(s-.5)*h.log(s)-s,e<=7)for(i=1;i<=a;i++)o-=h.log(s-1),--s;return o},f.gammafn=function(e){var t,n,o,r=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],i=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],l=!1,s=0,a=0,c=0,u=e;if(171.6243769536076<e)return 1/0;if(u<=0){if(!(o=u%1+36e-17))return 1/0;l=(1&u?-1:1)*h.PI/h.sin(h.PI*o),u=1-u}for(n=(e=u)<1?u++:(u-=s=(0|u)-1)-1,t=0;t<8;++t)c=(c+r[t])*n,a=a*n+i[t];if(o=c/a+1,e<u)o/=e;else if(u<e)for(t=0;t<s;++t)o*=u,u++;return o=l?l/o:o},f.gammap=function(e,t){return f.lowRegGamma(e,t)*f.gammafn(e)},f.lowRegGamma=function(e,t){var n,o=f.gammaln(e),r=e,i=1/e,l=i,s=t+1-e,a=1/1e-30,c=1/s,u=c,d=1,p=-~(8.5*h.log(1<=e?e:1/e)+.4*e+17);if(t<0||e<=0)return NaN;if(t<e+1){for(;d<=p;d++)i+=l*=t/++r;return i*h.exp(-t+e*h.log(t)-o)}for(;d<=p;d++)u*=(c=1/((n=-d*(d-e))*c+(s+=2)))*(a=s+n/a);return 1-u*h.exp(-t+e*h.log(t)-o)},f.factorialln=function(e){return e<0?NaN:f.gammaln(e+1)},f.factorial=function(e){return e<0?NaN:f.gammafn(e+1)},f.combination=function(e,t){return 170<e||170<t?h.exp(f.combinationln(e,t)):f.factorial(e)/f.factorial(t)/f.factorial(e-t)},f.combinationln=function(e,t){return f.factorialln(e)-f.factorialln(t)-f.factorialln(e-t)},f.permutation=function(e,t){return f.factorial(e)/f.factorial(e-t)},f.betafn=function(e,t){if(!(e<=0||t<=0))return 170<e+t?h.exp(f.betaln(e,t)):f.gammafn(e)*f.gammafn(t)/f.gammafn(e+t)},f.betaln=function(e,t){return f.gammaln(e)+f.gammaln(t)-f.gammaln(e+t)},f.betacf=function(e,t,n){for(var o,r,i=1e-30,l=1,s=t+n,a=t+1,c=t-1,u=1,d=1-s*e/a,p=d=1/(d=h.abs(d)<i?i:d);l<=100&&(d=1+(o=l*(n-l)*e/((c+(r=2*l))*(t+r)))*d,p*=(d=1/(d=h.abs(d)<i?i:d))*(u=h.abs(u=1+o/u)<i?i:u),d=1+(o=-(t+l)*(s+l)*e/((t+r)*(a+r)))*d,p*=r=(d=1/(d=h.abs(d)<i?i:d))*(u=h.abs(u=1+o/u)<i?i:u),!(h.abs(r-1)<3e-7));l++);return p},f.gammapinv=function(e,t){var n,o,r,i,l,s=0,a=t-1,c=f.gammaln(t);if(1<=e)return h.max(100,t+100*h.sqrt(t));if(e<=0)return 0;for(n=1<t?(i=h.log(a),l=h.exp(a*(i-1)-c),n=(2.30753+.27061*(o=h.sqrt(-2*h.log(e<.5?e:1-e))))/(1+o*(.99229+.04481*o))-o,h.max(.001,t*h.pow(1-1/(9*t)-(n=e<.5?-n:n)/(3*h.sqrt(t)),3))):e<(o=1-t*(.253+.12*t))?h.pow(e/o,1/t):1-h.log(1-(e-o)/(1-o));s<12;s++){if(n<=0)return 0;if((n-=o=(r=(f.lowRegGamma(t,n)-e)/(o=1<t?l*h.exp(-(n-a)+a*(h.log(n)-i)):h.exp(-n+a*h.log(n)-c)))/(1-.5*h.min(1,r*((t-1)/n-1))))<=0&&(n=.5*(n+o)),h.abs(o)<1e-8*n)break}return n},f.erf=function(e){var t,n,o,r=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],i=r.length-1,l=!1,s=0,a=0;for(e<0&&(e=-e,l=!0),t=4*(o=2/(2+e))-2;0<i;i--)s=t*(n=s)-a+r[i],a=n;return o=o*h.exp(-e*e+.5*(r[0]+t*s)-a),l?o-1:1-o},f.erfc=function(e){return 1-f.erf(e)},f.erfcinv=function(e){var t,n,o,r,i=0;if(2<=e)return-100;if(e<=0)return 100;for(t=-.70711*((2.30753+.27061*(o=h.sqrt(-2*h.log((r=e<1?e:2-e)/2))))/(1+o*(.99229+.04481*o))-o);i<2;i++)t+=(n=f.erfc(t)-r)/(1.1283791670955126*h.exp(-t*t)-t*n);return e<1?t:-t},f.ibetainv=function(e,t,n){var o,r,i,l,s,a,c,u=t-1,d=n-1,p=0;if(e<=0)return 0;if(1<=e)return 1;for(l=1<=t&&1<=n?(l=(2.30753+.27061*(r=h.sqrt(-2*h.log(e<.5?e:1-e))))/(1+r*(.99229+.04481*r))-r,a=(l=e<.5?-l:l)*h.sqrt((a=(l*l-3)/6)+(s=2/(1/(2*t-1)+1/(2*n-1))))/s-(1/(2*n-1)-1/(2*t-1))*(a+5/6-2/(3*s)),t/(t+n*h.exp(2*a))):(s=h.log(t/(t+n)),o=h.log(n/(t+n)),e<(r=h.exp(t*s)/t)/(a=r+(i=h.exp(n*o)/n))?h.pow(t*a*e,1/t):1-h.pow(n*a*(1-e),1/n)),c=-f.gammaln(t)-f.gammaln(n)+f.gammaln(t+n);p<10;p++){if(0===l||1===l)return l;if(1<=(l=(l-=r=(i=(f.ibeta(l,t,n)-e)/(r=h.exp(u*h.log(l)+d*h.log(1-l)+c)))/(1-.5*h.min(1,i*(u/l-d/(1-l)))))<=0?.5*(l+r):l)&&(l=.5*(l+r+1)),h.abs(r)<1e-8*l&&0<p)break}return l},f.ibeta=function(e,t,n){var o=0===e||1===e?0:h.exp(f.gammaln(t+n)-f.gammaln(t)-f.gammaln(n)+t*h.log(e)+n*h.log(1-e));return!(e<0||1<e)&&(e<(t+1)/(t+n+2)?o*f.betacf(e,t,n)/t:1-o*f.betacf(1-e,n,t)/n)},f.randn=function(e,t){var n,o,r,i;if(t=t||e,e)return f.create(e,t,function(){return f.randn()});for(;n=f._random_fn(),o=1.7156*(f._random_fn()-.5),.27597<(i=(r=n-.449871)*r+(i=h.abs(o)+.386595)*(.196*i-.25472*r))&&(.27846<i||o*o>-4*h.log(n)*n*n););return o/n},f.randg=function(e,t,n){var o,r,i,l,s,a=e;if(n=n||t,e=e||1,t)return(t=f.zeros(t,n)).alter(function(){return f.randg(e)}),t;e<1&&(e+=1),o=e-1/3,r=1/h.sqrt(9*o);do{for(;(l=1+r*(s=f.randn()))<=0;);}while(l*=l*l,(i=f._random_fn())>1-.331*h.pow(s,4)&&h.log(i)>.5*s*s+o*(1-l+h.log(l)));if(e==a)return o*l;for(;0===(i=f._random_fn()););return h.pow(i,1/a)*o*l};for(var e="gammaln gammafn factorial factorialln".split(" "),t=0;t<e.length;t++)!function(t){f.fn[t]=function(){return f(f.map(this,function(e){return f[t](e)}))}}(e[t]);for(var n="randn".split(" "),o=0;o<n.length;o++)!function(e){f.fn[e]=function(){return f(f[e].apply(null,arguments))}}(n[o])}(p,Math),function(x,w){function l(e,t,n,o){for(var r,i=0,l=1,s=1,a=1,c=0,u=0;w.abs((s-u)/s)>o;)l=a+(r=-(t+c)*(t+n+c)*e/(t+2*c)/(t+2*c+1))*l,s=(i=(u=s)+r*i)+(r=(c+=1)*(n-c)*e/(t+2*c-1)/(t+2*c))*s,i/=a=l+r*a,l/=a,s/=a,a=1;return s/t}function b(e,t,n){var o=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],r=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],i=.5*e;if(8<=i)return 1;for(var l,s=(s=2*x.normal.cdf(i,0,1,1,0)-1)>=w.exp(-50/n)?w.pow(s,n):0,a=i,c=(8-i)/(l=3<e?2:3),u=a+c,d=0,p=n-1,f=1;f<=l;f++){for(var h=0,g=.5*(u+a),m=.5*(u-a),b=1;b<=12;b++){var j,v=g+m*(6<b?o[(j=12-b+1)-1]:-o[(j=b)-1]),y=v*v;if(60<y)break;v=2*x.normal.cdf(v,0,1,1,0)*.5-2*x.normal.cdf(v,e,1,1,0)*.5;v>=w.exp(-30/p)&&(h+=r[j-1]*w.exp(-.5*y)*w.pow(v,p))}d+=h*=2*m*n/w.sqrt(2*w.PI),a=u,u+=c}return(s+=d)<=w.exp(-30/t)?0:1<=(s=w.pow(s,t))?1:s}for(var e="beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" "),t=0;t<e.length;t++)!function(i){x[i]=function e(t,n,o){return this instanceof e?(this._a=t,this._b=n,this._c=o,this):new e(t,n,o)},x.fn[i]=function(e,t,n){e=x[i](e,t,n);return e.data=this,e},x[i].prototype.sample=function(e){var t=this._a,n=this._b,o=this._c;return e?x.alter(e,function(){return x[i].sample(t,n,o)}):x[i].sample(t,n,o)};for(var e="pdf cdf inv".split(" "),t=0;t<e.length;t++)!function(r){x[i].prototype[r]=function(e){var t=this._a,n=this._b,o=this._c;return"number"!=typeof(e=e||0===e?e:this.data)?x.fn.map.call(e,function(e){return x[i][r](e,t,n,o)}):x[i][r](e,t,n,o)}}(e[t]);for(var n="mean median mode variance".split(" "),o=0;o<n.length;o++)!function(e){x[i].prototype[e]=function(){return x[i][e](this._a,this._b,this._c)}}(n[o])}(e[t]);x.extend(x.beta,{pdf:function(e,t,n){return 1<e||e<0?0:1==t&&1==n?1:t<512&&n<512?w.pow(e,t-1)*w.pow(1-e,n-1)/x.betafn(t,n):w.exp((t-1)*w.log(e)+(n-1)*w.log(1-e)-x.betaln(t,n))},cdf:function(e,t,n){return 1<e||e<0?+(1<e):x.ibeta(e,t,n)},inv:function(e,t,n){return x.ibetainv(e,t,n)},mean:function(e,t){return e/(e+t)},median:function(e,t){return x.ibetainv(.5,e,t)},mode:function(e,t){return(e-1)/(e+t-2)},sample:function(e,t){e=x.randg(e);return e/(e+x.randg(t))},variance:function(e,t){return e*t/(w.pow(e+t,2)*(e+t+1))}}),x.extend(x.centralF,{pdf:function(e,t,n){return e<0?0:t<=2?0===e&&t<2?1/0:0===e&&2===t?1:1/x.betafn(t/2,n/2)*w.pow(t/n,t/2)*w.pow(e,t/2-1)*w.pow(1+t/n*e,-(t+n)/2):t*(n/(n+e*t))/2*x.binomial.pdf((t-2)/2,(t+n-2)/2,t*e/(n+e*t))},cdf:function(e,t,n){return e<0?0:x.ibeta(t*e/(t*e+n),t/2,n/2)},inv:function(e,t,n){return n/(t*(1/x.ibetainv(e,t/2,n/2)-1))},mean:function(e,t){return 2<t?t/(t-2):void 0},mode:function(e,t){return 2<e?t*(e-2)/(e*(t+2)):void 0},sample:function(e,t){return 2*x.randg(e/2)/e/(2*x.randg(t/2)/t)},variance:function(e,t){if(!(t<=4))return 2*t*t*(e+t-2)/(e*(t-2)*(t-2)*(t-4))}}),x.extend(x.cauchy,{pdf:function(e,t,n){return n<0?0:n/(w.pow(e-t,2)+w.pow(n,2))/w.PI},cdf:function(e,t,n){return w.atan((e-t)/n)/w.PI+.5},inv:function(e,t,n){return t+n*w.tan(w.PI*(e-.5))},median:function(e){return e},mode:function(e){return e},sample:function(e,t){return x.randn()*w.sqrt(1/(2*x.randg(.5)))*t+e}}),x.extend(x.chisquare,{pdf:function(e,t){return e<0?0:0===e&&2===t?.5:w.exp((t/2-1)*w.log(e)-e/2-t/2*w.log(2)-x.gammaln(t/2))},cdf:function(e,t){return e<0?0:x.lowRegGamma(t/2,e/2)},inv:function(e,t){return 2*x.gammapinv(e,.5*t)},mean:function(e){return e},median:function(e){return e*w.pow(1-2/(9*e),3)},mode:function(e){return 0<e-2?e-2:0},sample:function(e){return 2*x.randg(e/2)},variance:function(e){return 2*e}}),x.extend(x.exponential,{pdf:function(e,t){return e<0?0:t*w.exp(-t*e)},cdf:function(e,t){return e<0?0:1-w.exp(-t*e)},inv:function(e,t){return-w.log(1-e)/t},mean:function(e){return 1/e},median:function(e){return 1/e*w.log(2)},mode:function(){return 0},sample:function(e){return-1/e*w.log(x._random_fn())},variance:function(e){return w.pow(e,-2)}}),x.extend(x.gamma,{pdf:function(e,t,n){return e<0?0:0===e&&1===t?1/n:w.exp((t-1)*w.log(e)-e/n-x.gammaln(t)-t*w.log(n))},cdf:function(e,t,n){return e<0?0:x.lowRegGamma(t,e/n)},inv:function(e,t,n){return x.gammapinv(e,t)*n},mean:function(e,t){return e*t},mode:function(e,t){if(1<e)return(e-1)*t},sample:function(e,t){return x.randg(e)*t},variance:function(e,t){return e*t*t}}),x.extend(x.invgamma,{pdf:function(e,t,n){return e<=0?0:w.exp(-(t+1)*w.log(e)-n/e-x.gammaln(t)+t*w.log(n))},cdf:function(e,t,n){return e<=0?0:1-x.lowRegGamma(t,n/e)},inv:function(e,t,n){return n/x.gammapinv(1-e,t)},mean:function(e,t){return 1<e?t/(e-1):void 0},mode:function(e,t){return t/(e+1)},sample:function(e,t){return t/x.randg(e)},variance:function(e,t){if(!(e<=2))return t*t/((e-1)*(e-1)*(e-2))}}),x.extend(x.kumaraswamy,{pdf:function(e,t,n){return 0===e&&1===t?n:1===e&&1===n?t:w.exp(w.log(t)+w.log(n)+(t-1)*w.log(e)+(n-1)*w.log(1-w.pow(e,t)))},cdf:function(e,t,n){return e<0?0:1<e?1:1-w.pow(1-w.pow(e,t),n)},inv:function(e,t,n){return w.pow(1-w.pow(1-e,1/n),1/t)},mean:function(e,t){return t*x.gammafn(1+1/e)*x.gammafn(t)/x.gammafn(1+1/e+t)},median:function(e,t){return w.pow(1-w.pow(2,-1/t),1/e)},mode:function(e,t){if(1<=e&&1<=t&&1!==e&&1!==t)return w.pow((e-1)/(e*t-1),1/e)},variance:function(){throw new Error("variance not yet implemented")}}),x.extend(x.lognormal,{pdf:function(e,t,n){return e<=0?0:w.exp(-w.log(e)-.5*w.log(2*w.PI)-w.log(n)-w.pow(w.log(e)-t,2)/(2*n*n))},cdf:function(e,t,n){return e<0?0:.5+.5*x.erf((w.log(e)-t)/w.sqrt(2*n*n))},inv:function(e,t,n){return w.exp(-1.4142135623730951*n*x.erfcinv(2*e)+t)},mean:function(e,t){return w.exp(e+t*t/2)},median:function(e){return w.exp(e)},mode:function(e,t){return w.exp(e-t*t)},sample:function(e,t){return w.exp(x.randn()*t+e)},variance:function(e,t){return(w.exp(t*t)-1)*w.exp(2*e+t*t)}}),x.extend(x.noncentralt,{pdf:function(e,t,n){return w.abs(n)<1e-14?x.studentt.pdf(e,t):w.abs(e)<1e-14?w.exp(x.gammaln((t+1)/2)-n*n/2-.5*w.log(w.PI*t)-x.gammaln(t/2)):t/e*(x.noncentralt.cdf(e*w.sqrt(1+2/t),t+2,n)-x.noncentralt.cdf(e,t,n))},cdf:function(e,t,n){var o=1e-14;if(w.abs(n)<o)return x.studentt.cdf(e,t);var r=!1;e<0&&(r=!0,n=-n);for(var i=x.normal.cdf(-n,0,1),l=1+o,s=l,a=e*e/(e*e+t),c=0,u=w.exp(-n*n/2),d=w.exp(-n*n/2-.5*w.log(2)-x.gammaln(1.5))*n;c<200||o<s||o<l;)s=l,0<c&&(u*=n*n/(2*c),d*=n*n/(2*(c+.5))),i+=.5*(l=u*x.beta.cdf(a,c+.5,t/2)+d*x.beta.cdf(a,c+1,t/2)),c++;return r?1-i:i}}),x.extend(x.normal,{pdf:function(e,t,n){return w.exp(-.5*w.log(2*w.PI)-w.log(n)-w.pow(e-t,2)/(2*n*n))},cdf:function(e,t,n){return.5*(1+x.erf((e-t)/w.sqrt(2*n*n)))},inv:function(e,t,n){return-1.4142135623730951*n*x.erfcinv(2*e)+t},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},sample:function(e,t){return x.randn()*t+e},variance:function(e,t){return t*t}}),x.extend(x.pareto,{pdf:function(e,t,n){return e<t?0:n*w.pow(t,n)/w.pow(e,n+1)},cdf:function(e,t,n){return e<t?0:1-w.pow(t/e,n)},inv:function(e,t,n){return t/w.pow(1-e,1/n)},mean:function(e,t){if(!(t<=1))return t*w.pow(e,t)/(t-1)},median:function(e,t){return e*(t*w.SQRT2)},mode:function(e){return e},variance:function(e,t){if(!(t<=2))return e*e*t/(w.pow(t-1,2)*(t-2))}}),x.extend(x.studentt,{pdf:function(e,t){return 1/(w.sqrt(t=1e100<t?1e100:t)*x.betafn(.5,t/2))*w.pow(1+e*e/t,-(t+1)/2)},cdf:function(e,t){var n=t/2;return x.ibeta((e+w.sqrt(e*e+t))/(2*w.sqrt(e*e+t)),n,n)},inv:function(e,t){var n=x.ibetainv(2*w.min(e,1-e),.5*t,.5),n=w.sqrt(t*(1-n)/n);return.5<e?n:-n},mean:function(e){return 1<e?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(e){return x.randn()*w.sqrt(e/(2*x.randg(e/2)))},variance:function(e){return 2<e?e/(e-2):1<e?1/0:void 0}}),x.extend(x.weibull,{pdf:function(e,t,n){return e<0||t<0||n<0?0:n/t*w.pow(e/t,n-1)*w.exp(-w.pow(e/t,n))},cdf:function(e,t,n){return e<0?0:1-w.exp(-w.pow(e/t,n))},inv:function(e,t,n){return t*w.pow(-w.log(1-e),1/n)},mean:function(e,t){return e*x.gammafn(1+1/t)},median:function(e,t){return e*w.pow(w.log(2),1/t)},mode:function(e,t){return t<=1?0:e*w.pow((t-1)/t,1/t)},sample:function(e,t){return e*w.pow(-w.log(x._random_fn()),1/t)},variance:function(e,t){return e*e*x.gammafn(1+2/t)-w.pow(x.weibull.mean(e,t),2)}}),x.extend(x.uniform,{pdf:function(e,t,n){return e<t||n<e?0:1/(n-t)},cdf:function(e,t,n){return e<t?0:e<n?(e-t)/(n-t):1},inv:function(e,t,n){return t+e*(n-t)},mean:function(e,t){return.5*(e+t)},median:function(e,t){return x.mean(e,t)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(e,t){return e/2+t/2+(t/2-e/2)*(2*x._random_fn()-1)},variance:function(e,t){return w.pow(t-e,2)/12}}),x.extend(x.binomial,{pdf:function(e,t,n){return 0===n||1===n?t*n===e?1:0:x.combination(t,e)*w.pow(n,e)*w.pow(1-n,t-e)},cdf:function(e,t,n){var o,r,i=1e-10;return e<0?0:t<=e?1:n<0||1<n||t<=0?NaN:(n=n,o=(e=w.floor(e))+1,r=w.exp(x.gammaln(e=o+(t=t-e))-x.gammaln(t)-x.gammaln(o)+o*w.log(n)+t*w.log(1-n)),e=n<(o+1)/(e+2)?r*l(n,o,t,i):1-r*l(1-n,t,o,i),w.round(1e10*(1-e))/1e10)}}),x.extend(x.negbin,{pdf:function(e,t,n){return e===e>>>0&&(e<0?0:x.combination(e+t-1,t-1)*w.pow(1-n,e)*w.pow(n,t))},cdf:function(e,t,n){var o=0,r=0;if(e<0)return 0;for(;r<=e;r++)o+=x.negbin.pdf(r,t,n);return o}}),x.extend(x.hypgeom,{pdf:function(e,t,n,o){if(e!=e|0)return!1;if(e<0||e<n-(t-o))return 0;if(o<e||n<e)return 0;if(t<2*n)return t<2*o?x.hypgeom.pdf(t-n-o+e,t,t-n,t-o):x.hypgeom.pdf(o-e,t,t-n,o);if(t<2*o)return x.hypgeom.pdf(n-e,t,n,t-o);if(n<o)return x.hypgeom.pdf(e,t,o,n);for(var r=1,i=0,l=0;l<e;l++){for(;1<r&&i<o;)r*=1-n/(t-i),i++;r*=(o-l)*(n-l)/((l+1)*(t-n-o+l+1))}for(;i<o;i++)r*=1-n/(t-i);return w.min(1,w.max(0,r))},cdf:function(e,t,n,o){if(e<0||e<n-(t-o))return 0;if(o<=e||n<=e)return 1;if(t<2*n)return t<2*o?x.hypgeom.cdf(t-n-o+e,t,t-n,t-o):1-x.hypgeom.cdf(o-e-1,t,t-n,o);if(t<2*o)return 1-x.hypgeom.cdf(n-e-1,t,n,t-o);if(n<o)return x.hypgeom.cdf(e,t,o,n);for(var r=1,i=1,l=0,s=0;s<e;s++){for(;1<r&&l<o;){var a=1-n/(t-l);i*=a,r*=a,l++}r+=i*=(o-s)*(n-s)/((s+1)*(t-n-o+s+1))}for(;l<o;l++)r*=1-n/(t-l);return w.min(1,w.max(0,r))}}),x.extend(x.poisson,{pdf:function(e,t){return t<0||e%1!=0||e<0?0:w.pow(t,e)*w.exp(-t)/x.factorial(e)},cdf:function(e,t){var n=[],o=0;if(e<0)return 0;for(;o<=e;o++)n.push(x.poisson.pdf(o,t));return x.sum(n)},mean:function(e){return e},variance:function(e){return e},sampleSmall:function(e){for(var t=1,n=0,o=w.exp(-e);n++,o<(t*=x._random_fn()););return n-1},sampleLarge:function(e){for(var t,n,o,r,i=e,e=w.sqrt(i),l=w.log(i),s=.02483*(o=.931+2.53*e)-.059,a=1.1239+1.1328/(o-3.4),c=.9277-3.6224/(o-2);;){if(t=w.random()-.5,n=w.random(),r=.5-w.abs(t),t=w.floor((2*s/r+o)*t+i+.43),.07<=r&&n<=c)return t;if(!(t<0||r<.013&&r<n)&&w.log(n)+w.log(a)-w.log(s/(r*r)+o)<=t*l-i-x.loggam(t+1))return t}},sample:function(e){return e<10?this.sampleSmall(e):this.sampleLarge(e)}}),x.extend(x.triangular,{pdf:function(e,t,n,o){return n<=t||o<t||n<o?NaN:e<t||n<e?0:e<o?2*(e-t)/((n-t)*(o-t)):e===o?2/(n-t):2*(n-e)/((n-t)*(n-o))},cdf:function(e,t,n,o){return n<=t||o<t||n<o?NaN:e<=t?0:n<=e?1:e<=o?w.pow(e-t,2)/((n-t)*(o-t)):1-w.pow(n-e,2)/((n-t)*(n-o))},inv:function(e,t,n,o){return n<=t||o<t||n<o?NaN:e<=(o-t)/(n-t)?t+(n-t)*w.sqrt(e*((o-t)/(n-t))):t+(n-t)*(1-w.sqrt((1-e)*(1-(o-t)/(n-t))))},mean:function(e,t,n){return(e+t+n)/3},median:function(e,t,n){return n<=(e+t)/2?t-w.sqrt((t-e)*(t-n))/w.sqrt(2):(e+t)/2<n?e+w.sqrt((t-e)*(n-e))/w.sqrt(2):void 0},mode:function(e,t,n){return n},sample:function(e,t,n){var o=x._random_fn();return o<(n-e)/(t-e)?e+w.sqrt(o*(t-e)*(n-e)):t-w.sqrt((1-o)*(t-e)*(t-n))},variance:function(e,t,n){return(e*e+t*t+n*n-e*t-e*n-t*n)/18}}),x.extend(x.arcsine,{pdf:function(e,t,n){return n<=t?NaN:e<=t||n<=e?0:2/w.PI*w.pow(w.pow(n-t,2)-w.pow(2*e-t-n,2),-.5)},cdf:function(e,t,n){return e<t?0:e<n?2/w.PI*w.asin(w.sqrt((e-t)/(n-t))):1},inv:function(e,t,n){return t+(.5-.5*w.cos(w.PI*e))*(n-t)},mean:function(e,t){return t<=e?NaN:(e+t)/2},median:function(e,t){return t<=e?NaN:(e+t)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(e,t){return(e+t)/2+(t-e)/2*w.sin(2*w.PI*x.uniform.sample(0,1))},variance:function(e,t){return t<=e?NaN:w.pow(t-e,2)/8}}),x.extend(x.laplace,{pdf:function(e,t,n){return n<=0?0:w.exp(-w.abs(e-t)/n)/(2*n)},cdf:function(e,t,n){return n<=0?0:e<t?.5*w.exp((e-t)/n):1-.5*w.exp(-(e-t)/n)},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},variance:function(e,t){return 2*t*t},sample:function(e,t){var n=x._random_fn()-.5;return e-t*(n/w.abs(n))*w.log(1-2*w.abs(n))}}),x.extend(x.tukey,{cdf:function(e,t,n){var o=t,r=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],i=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(e<=0)return 0;if(n<2||o<2)return NaN;if(!Number.isFinite(e))return 1;if(25e3<n)return b(e,1,o);var t=.5*n,l=t*w.log(n)-n*w.log(2)-x.gammaln(t),s=t-1,a=.25*n,c=n<=100?1:n<=800?.5:n<=5e3?.25:.125;l+=w.log(c);for(var u=0,d=1;d<=50;d++){for(var p=0,f=(2*d-1)*c,h=1;h<=16;h++){var g,m=8<h?l+s*w.log(f+r[g=h-8-1]*c)-(r[g]*c+f)*a:l+s*w.log(f-r[g=h-1]*c)+(r[g]*c-f)*a;-30<=m&&(p+=b(8<h?e*w.sqrt(.5*(r[g]*c+f)):e*w.sqrt(.5*(-r[g]*c+f)),1,o)*i[g]*w.exp(m))}if(1<=d*c&&p<=1e-14)break;u+=p}if(1e-14<p)throw new Error("tukey.cdf failed to converge");return u=1<u?1:u},inv:function(e,t,n){if(n<2||t<2)return NaN;if(e<0||1<e)return NaN;if(0===e)return 0;if(1===e)return 1/0;o=t,r=n,i=.5-.5*e,i=w.sqrt(w.log(1/(i*i))),i+=((((-453642210148e-16*i-.204231210125)*i-.342242088547)*i-1)*i+.322232421088)/((((.0038560700634*i+.10353775285)*i+.531103462366)*i+.588581570495)*i+.099348462606),r<120&&(i+=(i*i*i+i)/r/4),l=.8832-.2368*i,r<120&&(l+=-1.214/r+1.208*i/r);for(var o,r,i,l,s,a=i*(l*w.log(o-1)+1.4142),c=x.tukey.cdf(a,t,n)-e,u=0<c?w.max(0,a-1):a+1,d=x.tukey.cdf(u,t,n)-e,p=1;p<50;p++)if(s=u-d*(u-a)/(d-c),c=d,a=u,s<0&&(s=0,d=-e),d=x.tukey.cdf(s,t,n)-e,u=s,w.abs(u-a)<1e-4)return s;throw new Error("tukey.inv failed to converge")}})}(p,Math),function(g,m){var s,a,r=Array.prototype.push,t=g.utils.isArray;function u(e){return t(e)||e instanceof g}g.extend({add:function(e,o){return u(o)?(u(o[0])||(o=[o]),g.map(e,function(e,t,n){return e+o[t][n]})):g.map(e,function(e){return e+o})},subtract:function(e,o){return u(o)?(u(o[0])||(o=[o]),g.map(e,function(e,t,n){return e-o[t][n]||0})):g.map(e,function(e){return e-o})},divide:function(e,t){return u(t)?(u(t[0])||(t=[t]),g.multiply(e,g.inv(t))):g.map(e,function(e){return e/t})},multiply:function(e,t){var n,o,r,i,l,s,a,c;if(void 0===e.length&&void 0===t.length)return e*t;if(l=e.length,s=e[0].length,a=g.zeros(l,r=u(t)?t[0].length:s),c=0,u(t)){for(;c<r;c++)for(n=0;n<l;n++){for(o=i=0;o<s;o++)i+=e[n][o]*t[o][c];a[n][c]=i}return 1===l&&1===c?a[0][0]:a}return g.map(e,function(e){return e*t})},outer:function(e,t){return g.multiply(e.map(function(e){return[e]}),[t])},dot:function(e,t){u(e[0])||(e=[e]),u(t[0])||(t=[t]);for(var n,o,r=1===e[0].length&&1!==e.length?g.transpose(e):e,i=1===t[0].length&&1!==t.length?g.transpose(t):t,l=[],s=0,a=r.length,c=r[0].length;s<a;s++){for(l[s]=[],o=n=0;o<c;o++)n+=r[s][o]*i[s][o];l[s]=n}return 1===l.length?l[0]:l},pow:function(e,t){return g.map(e,function(e){return m.pow(e,t)})},exp:function(e){return g.map(e,function(e){return m.exp(e)})},log:function(e){return g.map(e,function(e){return m.log(e)})},abs:function(e){return g.map(e,function(e){return m.abs(e)})},norm:function(e,t){var n=0,o=0;for(isNaN(t)&&(t=2),u(e[0])&&(e=e[0]);o<e.length;o++)n+=m.pow(m.abs(e[o]),t);return m.pow(n,1/t)},angle:function(e,t){return m.acos(g.dot(e,t)/(g.norm(e)*g.norm(t)))},aug:function(e,t){for(var n=[],o=0;o<e.length;o++)n.push(e[o].slice());for(o=0;o<n.length;o++)r.apply(n[o],t[o]);return n},inv:function(e){for(var t,n=e.length,o=e[0].length,r=g.identity(n,o),i=g.gauss_jordan(e,r),l=[],s=0;s<n;s++)for(l[s]=[],t=o;t<i[0].length;t++)l[s][t-o]=i[s][t];return l},det:function e(t){if(2===t.length)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(var n=0,o=0;o<t.length;o++){for(var r=[],i=1;i<t.length;i++){r[i-1]=[];for(var l=0;l<t.length;l++)l<o?r[i-1][l]=t[i][l]:o<l&&(r[i-1][l-1]=t[i][l])}var s=o%2?-1:1;n+=e(r)*t[0][o]*s}return n},gauss_elimination:function(e,t){for(var n,o,r,i,l=0,s=0,a=e.length,c=e[0].length,u=0,d=[],p=(e=g.aug(e,t))[0].length,l=0;l<a;l++){for(n=e[l][l],r=(s=l)+1;r<c;r++)n<m.abs(e[r][l])&&(n=e[r][l],s=r);if(s!=l)for(r=0;r<p;r++)o=e[l][r],e[l][r]=e[s][r],e[s][r]=o;for(s=l+1;s<a;s++)for(i=e[s][l]/e[l][l],r=l;r<p;r++)e[s][r]=e[s][r]-i*e[l][r]}for(l=a-1;0<=l;l--){for(u=0,s=l+1;s<=a-1;s++)u+=d[s]*e[l][s];d[l]=(e[l][p-1]-u)/e[l][l]}return d},gauss_jordan:function(e,t){for(var n,o=g.aug(e,t),r=o.length,i=o[0].length,l=0,s=0;s<r;s++){for(var a=s,c=s+1;c<r;c++)m.abs(o[c][s])>m.abs(o[a][s])&&(a=c);var u=o[s];for(o[s]=o[a],o[a]=u,c=s+1;c<r;c++)for(l=o[c][s]/o[s][s],n=s;n<i;n++)o[c][n]-=o[s][n]*l}for(s=r-1;0<=s;s--){for(l=o[s][s],c=0;c<s;c++)for(n=i-1;s-1<n;n--)o[c][n]-=o[s][n]*o[c][s]/l;for(o[s][s]/=l,n=r;n<i;n++)o[s][n]/=l}return o},triaUpSolve:function(n,e){var o,r=n[0].length,i=g.zeros(1,r)[0],t=!1;return null!=e[0].length&&(e=e.map(function(e){return e[0]}),t=!0),g.arange(r-1,-1,-1).forEach(function(t){o=g.arange(t+1,r).map(function(e){return i[e]*n[t][e]}),i[t]=(e[t]-g.sum(o))/n[t][t]}),t?i.map(function(e){return[e]}):i},triaLowSolve:function(n,e){var o,t=n[0].length,r=g.zeros(1,t)[0],i=!1;return null!=e[0].length&&(e=e.map(function(e){return e[0]}),i=!0),g.arange(t).forEach(function(t){o=g.arange(t).map(function(e){return n[t][e]*r[e]}),r[t]=(e[t]-g.sum(o))/n[t][t]}),i?r.map(function(e){return[e]}):r},lu:function(o){var e,t=o.length,r=g.identity(t),i=g.zeros(o.length,o[0].length);return g.arange(t).forEach(function(e){i[0][e]=o[0][e]}),g.arange(1,t).forEach(function(n){g.arange(n).forEach(function(t){e=g.arange(t).map(function(e){return r[n][e]*i[e][t]}),r[n][t]=(o[n][t]-g.sum(e))/i[t][t]}),g.arange(n,t).forEach(function(t){e=g.arange(n).map(function(e){return r[n][e]*i[e][t]}),i[n][t]=o[e.length][t]-g.sum(e)})}),[r,i]},cholesky:function(e){var o,t=e.length,r=g.zeros(e.length,e[0].length);return g.arange(t).forEach(function(n){o=g.arange(n).map(function(e){return m.pow(r[n][e],2)}),r[n][n]=m.sqrt(e[n][n]-g.sum(o)),g.arange(n+1,t).forEach(function(t){o=g.arange(n).map(function(e){return r[n][e]*r[t][e]}),r[t][n]=(e[n][t]-g.sum(o))/r[n][n]})}),r},gauss_jacobi:function(e,t,n,o){for(var r,i,l,s,a=0,c=0,u=e.length,d=[],p=[],f=[];a<u;a++)for(d[a]=[],p[a]=[],f[a]=[],c=0;c<u;c++)c<a?(d[a][c]=e[a][c],p[a][c]=f[a][c]=0):a<c?(p[a][c]=e[a][c],d[a][c]=f[a][c]=0):(f[a][c]=e[a][c],d[a][c]=p[a][c]=0);for(l=g.multiply(g.multiply(g.inv(f),g.add(d,p)),-1),i=g.multiply(g.inv(f),t),s=g.add(g.multiply(l,r=n),i),a=2;m.abs(g.norm(g.subtract(s,r)))>o;)r=s,s=g.add(g.multiply(l,r),i),a++;return s},gauss_seidel:function(e,t,n,o){for(var r,i,l,s,a,c=0,u=e.length,d=[],p=[],f=[];c<u;c++)for(d[c]=[],p[c]=[],f[c]=[],r=0;r<u;r++)r<c?(d[c][r]=e[c][r],p[c][r]=f[c][r]=0):c<r?(p[c][r]=e[c][r],d[c][r]=f[c][r]=0):(f[c][r]=e[c][r],d[c][r]=p[c][r]=0);for(s=g.multiply(g.multiply(g.inv(g.add(f,d)),p),-1),l=g.multiply(g.inv(g.add(f,d)),t),a=g.add(g.multiply(s,i=n),l),c=2;m.abs(g.norm(g.subtract(a,i)))>o;)i=a,a=g.add(g.multiply(s,i),l),c+=1;return a},SOR:function(e,t,n,o,r){for(var i,l,s,a,c,u=0,d=e.length,p=[],f=[],h=[];u<d;u++)for(p[u]=[],f[u]=[],h[u]=[],i=0;i<d;i++)i<u?(p[u][i]=e[u][i],f[u][i]=h[u][i]=0):u<i?(f[u][i]=e[u][i],p[u][i]=h[u][i]=0):(h[u][i]=e[u][i],p[u][i]=f[u][i]=0);for(a=g.multiply(g.inv(g.add(h,g.multiply(p,r))),g.subtract(g.multiply(h,1-r),g.multiply(f,r))),s=g.multiply(g.multiply(g.inv(g.add(h,g.multiply(p,r))),t),r),c=g.add(g.multiply(a,l=n),s),u=2;m.abs(g.norm(g.subtract(c,l)))>o;)l=c,c=g.add(g.multiply(a,l),s),u++;return c},householder:function(e){for(var t,n,o,r,i,l=e.length,s=e[0].length,a=0,c=[];a<l-1;a++){for(t=0,r=a+1;r<s;r++)t+=e[r][a]*e[r][a];for(t=(0<e[a+1][a]?-1:1)*m.sqrt(t),n=m.sqrt((t*t-e[a+1][a]*t)/2),(c=g.zeros(l,1))[a+1][0]=(e[a+1][a]-t)/(2*n),o=a+2;o<l;o++)c[o][0]=e[o][a]/(2*n);i=g.subtract(g.identity(l,s),g.multiply(g.multiply(c,g.transpose(c)),2)),e=g.multiply(i,g.multiply(e,i))}return e},QR:(s=g.sum,a=g.arange,function(t){var e,n,o,r=t.length,i=t[0].length,l=g.zeros(i,i);for(t=g.copy(t),n=0;n<i;n++){for(l[n][n]=m.sqrt(s(a(r).map(function(e){return t[e][n]*t[e][n]}))),e=0;e<r;e++)t[e][n]=t[e][n]/l[n][n];for(o=n+1;o<i;o++)for(l[n][o]=s(a(r).map(function(e){return t[e][n]*t[e][o]})),e=0;e<r;e++)t[e][o]=t[e][o]-t[e][n]*l[n][o]}return[t,l]}),lstsq:function(e,t){var i,l,n=!1,o=(void 0===t[0].length&&(t=t.map(function(e){return[e]}),n=!0),g.QR(e)),r=o[0],o=o[1],e=e[0].length,r=g.slice(r,{col:{end:e}}),e=(i=g.slice(o,{row:{end:e}}),o=(i=g.copy(i)).length,l=g.identity(o),g.arange(o-1,-1,-1).forEach(function(r){g.sliceAssign(l,{row:r},g.divide(g.slice(l,{row:r}),i[r][r])),g.sliceAssign(i,{row:r},g.divide(g.slice(i,{row:r}),i[r][r])),g.arange(r).forEach(function(e){var t=g.multiply(i[e][r],-1),n=g.slice(i,{row:e}),o=g.multiply(g.slice(i,{row:r}),t),n=(g.sliceAssign(i,{row:e},g.add(n,o)),g.slice(l,{row:e})),o=g.multiply(g.slice(l,{row:r}),t);g.sliceAssign(l,{row:e},g.add(n,o))})}),l),o=g.transpose(r),r=(void 0===o[0].length&&(o=[o]),g.multiply(g.multiply(e,o),t));return void 0===r.length&&(r=[[r]]),n?r.map(function(e){return e[0]}):r},jacobi:function(e){for(var t,n,o,r,i,l,s,a=1,c=e.length,u=g.identity(c,c),d=[];1===a;){for(i=e[0][1],r=1,t=o=0;t<c;t++)for(n=0;n<c;n++)t!=n&&i<m.abs(e[t][n])&&(i=m.abs(e[t][n]),o=t,r=n);for(l=e[o][o]===e[r][r]?0<e[o][r]?m.PI/4:-m.PI/4:m.atan(2*e[o][r]/(e[o][o]-e[r][r]))/2,(s=g.identity(c,c))[o][o]=m.cos(l),s[o][r]=-m.sin(l),s[r][o]=m.sin(l),s[r][r]=m.cos(l),u=g.multiply(u,s),e=g.multiply(g.multiply(g.inv(s),e),s),a=0,t=1;t<c;t++)for(n=1;n<c;n++)t!=n&&.001<m.abs(e[t][n])&&(a=1)}for(t=0;t<c;t++)d.push(e[t][t]);return[u,d]},rungekutta:function(e,t,n,o,r,i){var l,s,a;if(2===i)for(;o<=n;)r+=((l=t*e(o,r))+(s=t*e(o+t,r+l)))/2,o+=t;if(4===i)for(;o<=n;)r+=((l=t*e(o,r))+2*(s=t*e(o+t/2,r+l/2))+2*(a=t*e(o+t/2,r+s/2))+t*e(o+t,r+a))/6,o+=t;return r},romberg:function(e,t,n,o){for(var r,i,l,s,a,c=0,u=(n-t)/2,d=[],p=[],f=[];c<o/2;){for(a=e(t),l=t,s=0;l<=n;l+=u,s++)d[s]=l;for(r=d.length,l=1;l<r-1;l++)a+=(l%2!=0?4:2)*e(d[l]);a=u/3*(a+e(n)),f[c]=a,u/=2,c++}for(i=f.length,r=1;1!==i;){for(l=0;l<i-1;l++)p[l]=(m.pow(4,r)*f[l+1]-f[l])/(m.pow(4,r)-1);i=p.length,f=p,p=[],r++}return f},richardson:function(e,t,n,o){function r(e,t){for(var n,o=0,r=e.length;o<r;o++)e[o]===t&&(n=o);return n}for(var i,l,s,a,c,u=m.abs(n-e[r(e,n)+1]),d=0,p=[],f=[];u<=o;)i=r(e,n+o),l=r(e,n),p[d]=(t[i]-2*t[l]+t[2*l-i])/(o*o),o/=2,d++;for(a=p.length,s=1;1!=a;){for(c=0;c<a-1;c++)f[c]=(m.pow(4,s)*p[c+1]-p[c])/(m.pow(4,s)-1);a=f.length,p=f,f=[],s++}return p},simpson:function(e,t,n,o){for(var r,i=(n-t)/o,l=e(t),s=[],a=t,c=0,u=1;a<=n;a+=i,c++)s[c]=a;for(r=s.length;u<r-1;u++)l+=(u%2!=0?4:2)*e(s[u]);return i/3*(l+e(n))},hermite:function(e,t,n,o){for(var r,i=e.length,l=0,s=0,a=[],c=[],u=[],d=[];s<i;s++){for(a[s]=1,r=0;r<i;r++)s!=r&&(a[s]*=(o-e[r])/(e[s]-e[r]));for(r=c[s]=0;r<i;r++)s!=r&&(c[s]+=1/(e[s]-e[r]));u[s]=(1-2*(o-e[s])*c[s])*(a[s]*a[s]),d[s]=(o-e[s])*(a[s]*a[s]),l+=u[s]*t[s]+d[s]*n[s]}return l},lagrange:function(e,t,n){for(var o,r,i=0,l=0,s=e.length;l<s;l++){for(r=t[l],o=0;o<s;o++)l!=o&&(r*=(n-e[o])/(e[l]-e[o]));i+=r}return i},cubic_spline:function(e,t,n){for(var o,r,i=e.length,l=0,s=[],a=[],c=[],u=[],d=[],p=[];l<i-1;l++)u[l]=e[l+1]-e[l];for(c[0]=0,l=1;l<i-1;l++)c[l]=3/u[l]*(t[l+1]-t[l])-3/u[l-1]*(t[l]-t[l-1]);for(l=1;l<i-1;l++)s[l]=[],a[l]=[],s[l][l-1]=u[l-1],s[l][l]=2*(u[l-1]+u[l]),s[l][l+1]=u[l],a[l][0]=c[l];for(r=g.multiply(g.inv(s),a),o=0;o<i-1;o++)d[o]=(t[o+1]-t[o])/u[o]-u[o]*(r[o+1][0]+2*r[o][0])/3,p[o]=(r[o+1][0]-r[o][0])/(3*u[o]);for(o=0;o<i&&!(e[o]>n);o++);return t[--o]+(n-e[o])*d[o]+g.sq(n-e[o])*r[o]+(n-e[o])*g.sq(n-e[o])*p[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(e){for(var t,n,o,r,i,l=e.length,s=e[0].length,a=0,c=[],u=[],d=[],p=[],f=[],h=[],a=0;a<l;a++)c[a]=g.sum(e[a])/s;for(a=0;a<s;a++)for(p[a]=[],t=0;t<l;t++)p[a][t]=e[t][a]-c[t];for(p=g.transpose(p),a=0;a<l;a++)for(f[a]=[],t=0;t<l;t++)f[a][t]=g.dot([p[a]],[p[t]])/(s-1);for(r=(n=g.jacobi(f))[0],u=n[1],h=g.transpose(r),a=0;a<u.length;a++)for(t=a;t<u.length;t++)u[a]<u[t]&&(i=u[a],u[a]=u[t],u[t]=i,i=h[a],h[a]=h[t],h[t]=i);for(o=g.transpose(p),a=0;a<l;a++)for(d[a]=[],t=0;t<o.length;t++)d[a][t]=g.dot([h[a]],[o[t]]);return[e,u,h,d]}});for(var e="add divide multiply subtract dot pow exp log abs norm angle".split(" "),n=0;n<e.length;n++)!function(o){g.fn[o]=function(e,t){var n=this;return t?(setTimeout(function(){t.call(n,g.fn[o].call(n,e))},15),this):"number"==typeof g[o](this,e)?g[o](this,e):g(g[o](this,e))}}(e[n])}(p,Math),c=p,u=Math,d=[].slice,i=c.utils.isNumber,n=c.utils.isArray,c.extend({zscore:function(){var e=d.call(arguments);return i(e[1])?(e[0]-e[1])/e[2]:(e[0]-c.mean(e[1]))/c.stdev(e[1],e[2])},ztest:function(){var e,t=d.call(arguments);return n(t[1])?(e=c.zscore(t[0],t[1],t[3]),1===t[2]?c.normal.cdf(-u.abs(e),0,1):2*c.normal.cdf(-u.abs(e),0,1)):2<t.length?(e=c.zscore(t[0],t[1],t[2]),1===t[3]?c.normal.cdf(-u.abs(e),0,1):2*c.normal.cdf(-u.abs(e),0,1)):(e=t[0],1===t[1]?c.normal.cdf(-u.abs(e),0,1):2*c.normal.cdf(-u.abs(e),0,1))}}),c.extend(c.fn,{zscore:function(e,t){return(e-this.mean())/this.stdev(t)},ztest:function(e,t,n){e=u.abs(this.zscore(e,n));return 1===t?c.normal.cdf(-e,0,1):2*c.normal.cdf(-e,0,1)}}),c.extend({tscore:function(){var e=d.call(arguments);return 4===e.length?(e[0]-e[1])/(e[2]/u.sqrt(e[3])):(e[0]-c.mean(e[1]))/(c.stdev(e[1],!0)/u.sqrt(e[1].length))},ttest:function(){var e,t=d.call(arguments);return 5===t.length?(e=u.abs(c.tscore(t[0],t[1],t[2],t[3])),1===t[4]?c.studentt.cdf(-e,t[3]-1):2*c.studentt.cdf(-e,t[3]-1)):i(t[1])?(e=u.abs(t[0]),1==t[2]?c.studentt.cdf(-e,t[1]-1):2*c.studentt.cdf(-e,t[1]-1)):(e=u.abs(c.tscore(t[0],t[1])),1==t[2]?c.studentt.cdf(-e,t[1].length-1):2*c.studentt.cdf(-e,t[1].length-1))}}),c.extend(c.fn,{tscore:function(e){return(e-this.mean())/(this.stdev(!0)/u.sqrt(this.cols()))},ttest:function(e,t){return 1===t?1-c.studentt.cdf(u.abs(this.tscore(e)),this.cols()-1):2*c.studentt.cdf(-u.abs(this.tscore(e)),this.cols()-1)}}),c.extend({anovafscore:function(){var e,t,n,o,r,i,l,s,a=d.call(arguments);if(1===a.length){for(r=new Array(a[0].length),l=0;l<a[0].length;l++)r[l]=a[0][l];a=r}for(t=new Array,l=0;l<a.length;l++)t=t.concat(a[l]);for(n=c.mean(t),l=e=0;l<a.length;l++)e+=a[l].length*u.pow(c.mean(a[l])-n,2);for(e/=a.length-1,l=i=0;l<a.length;l++)for(o=c.mean(a[l]),s=0;s<a[l].length;s++)i+=u.pow(a[l][s]-o,2);return e/(i/(t.length-a.length))},anovaftest:function(){var e=d.call(arguments);if(i(e[0]))return 1-c.centralF.cdf(e[0],e[1],e[2]);for(var t=c.anovafscore(e),n=e.length-1,o=0,r=0;r<e.length;r++)o+=e[r].length;return 1-c.centralF.cdf(t,n,o-n-1)},ftest:function(e,t,n){return 1-c.centralF.cdf(e,t,n)}}),c.extend(c.fn,{anovafscore:function(){return c.anovafscore(this.toArray())},anovaftes:function(){for(var e=0,t=0;t<this.length;t++)e+=this[t].length;return c.ftest(this.anovafscore(),this.length-1,e-this.length)}}),c.extend({qscore:function(){var e,t,n,o,r=d.call(arguments),r=i(r[0])?(e=r[0],t=r[1],n=r[2],o=r[3],r[4]):(e=c.mean(r[0]),t=c.mean(r[1]),n=r[0].length,o=r[1].length,r[2]);return u.abs(e-t)/(r*u.sqrt((1/n+1/o)/2))},qtest:function(){var e,t=d.call(arguments),n=(t=3===t.length?(e=t[0],t.slice(1)):7===t.length?(e=c.qscore(t[0],t[1],t[2],t[3],t[4]),t.slice(5)):(e=c.qscore(t[0],t[1],t[2]),t.slice(3)))[0],t=t[1];return 1-c.tukey.cdf(e,t,n-t)},tukeyhsd:function(e){for(var t=c.pooledstdev(e),n=e.map(function(e){return c.mean(e)}),o=e.reduce(function(e,t){return e+t.length},0),r=[],i=0;i<e.length;++i)for(var l=i+1;l<e.length;++l){var s=c.qtest(n[i],n[l],e[i].length,e[l].length,t,o,e.length);r.push([[i,l],s])}return r}}),c.extend({normalci:function(){var e=d.call(arguments),t=new Array(2),n=4===e.length?u.abs(c.normal.inv(e[1]/2,0,1)*e[2]/u.sqrt(e[3])):u.abs(c.normal.inv(e[1]/2,0,1)*c.stdev(e[2])/u.sqrt(e[2].length));return t[0]=e[0]-n,t[1]=e[0]+n,t},tci:function(){var e=d.call(arguments),t=new Array(2),n=4===e.length?u.abs(c.studentt.inv(e[1]/2,e[3]-1)*e[2]/u.sqrt(e[3])):u.abs(c.studentt.inv(e[1]/2,e[2].length-1)*c.stdev(e[2],!0)/u.sqrt(e[2].length));return t[0]=e[0]-n,t[1]=e[0]+n,t},significant:function(e,t){return e<t}}),c.extend(c.fn,{normalci:function(e,t){return c.normalci(e,t,this.toArray())},tci:function(e,t){return c.tci(e,t,this.toArray())}}),c.extend(c.fn,{oneSidedDifferenceOfProportions:function(e,t,n,o){e=r(e,t,n,o);return c.ztest(e,1)},twoSidedDifferenceOfProportions:function(e,t,n,o){e=r(e,t,n,o);return c.ztest(e,2)}}),p.models={ols:function(e,t){var n,o,r,i,l,s,a,e=f(e,t),t=(r=(o=e).exog,i=r[0].length,t=p.arange(i).map(function(t){var e=p.arange(i).filter(function(e){return e!==t});return f(p.col(r,t).map(function(e){return e[0]}),p.col(r,e))}),l=Math.sqrt(o.SSR/o.df_resid),s=t.map(function(e){var t=e.SST,e=e.R2;return l/Math.sqrt(t*(1-e))}),t=o.coef.map(function(e,t){return+e/s[t]}),c=t.map(function(e){e=p.studentt.cdf(e,o.df_resid);return 2*(.5<e?1-e:e)}),a=p.studentt.inv(.975,o.df_resid),u=o.coef.map(function(e,t){t=a*s[t];return[e-t,e+t]}),{se:s,t:t,p:c,sigmaHat:l,interval95:u}),c={F_statistic:c=e.R2/e.df_model/((1-e.R2)/e.df_resid),pvalue:1-(u=e.df_model,n=e.df_resid,p.beta.cdf(c/(n/u+c),u/2,n/2))},u=1-(1-e.R2)*((e.nobs-1)/e.df_resid);return e.t=t,e.f=c,e.adjust_R2=u,e}},p.extend({buildxmatrix:function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;t++)e[t]=[1].concat(arguments[t]);return p(e)},builddxmatrix:function(){for(var e=new Array(arguments[0].length),t=0;t<arguments[0].length;t++)e[t]=[1].concat(arguments[0][t]);return p(e)},buildjxmatrix:function(e){for(var t=new Array(e.length),n=0;n<e.length;n++)t[n]=e[n];return p.builddxmatrix(t)},buildymatrix:function(e){return p(e).transpose()},buildjymatrix:function(e){return e.transpose()},matrixmult:function(e,t){var n,o,r,i,l;if(e.cols()==t.rows()){if(1<t.rows())for(i=[],n=0;n<e.rows();n++)for(i[n]=[],o=0;o<t.cols();o++){for(r=l=0;r<e.cols();r++)l+=e.toArray()[n][r]*t.toArray()[r][o];i[n][o]=l}else for(i=[],n=0;n<e.rows();n++)for(i[n]=[],o=0;o<t.cols();o++){for(r=l=0;r<e.cols();r++)l+=e.toArray()[n][r]*t.toArray()[o];i[n][o]=l}return p(i)}},regress:function(e,t){var n=p.xtranspxinv(e),e=e.transpose(),n=p.matrixmult(p(n),e);return p.matrixmult(n,t)},regresst:function(e,t,n){var o=p.regress(e,t),r={anova:{}},i=p.jMatYBar(e,o),l=(r.yBar=i,t.mean());r.anova.residuals=p.residuals(t,i),r.anova.ssr=p.ssr(i,l),r.anova.msr=r.anova.ssr/(e[0].length-1),r.anova.sse=p.sse(t,i),r.anova.mse=r.anova.sse/(t.length-(e[0].length-1)-1),r.anova.sst=p.sst(t,l),r.anova.mst=r.anova.sst/(t.length-1),r.anova.r2=1-r.anova.sse/r.anova.sst,r.anova.r2<0&&(r.anova.r2=0),r.anova.fratio=r.anova.msr/r.anova.mse,r.anova.pvalue=p.anovaftest(r.anova.fratio,e[0].length-1,t.length-(e[0].length-1)-1),r.anova.rmse=Math.sqrt(r.anova.mse),r.anova.r2adj=1-r.anova.mse/r.anova.mst,r.anova.r2adj<0&&(r.anova.r2adj=0),r.stats=new Array(e[0].length);for(var s,a,c,u=p.xtranspxinv(e),d=0;d<o.length;d++)s=Math.sqrt(r.anova.mse*Math.abs(u[d][d])),a=Math.abs(o[d]/s),c=p.ttest(a,t.length-e[0].length-1,n),r.stats[d]=[o[d],s,a,c];return r.regress=o,r},xtranspx:function(e){return p.matrixmult(e.transpose(),e)},xtranspxinv:function(e){e=p.matrixmult(e.transpose(),e);return p.inv(e)},jMatYBar:function(e,t){e=p.matrixmult(e,t);return new p(e)},residuals:function(e,t){return p.matrixsubtract(e,t)},ssr:function(e,t){for(var n=0,o=0;o<e.length;o++)n+=Math.pow(e[o]-t,2);return n},sse:function(e,t){for(var n=0,o=0;o<e.length;o++)n+=Math.pow(e[o]-t[o],2);return n},sst:function(e,t){for(var n=0,o=0;o<e.length;o++)n+=Math.pow(e[o]-t,2);return n},matrixsubtract:function(e,t){for(var n=new Array(e.length),o=0;o<e.length;o++){n[o]=new Array(e[o].length);for(var r=0;r<e[o].length;r++)n[o][r]=e[o][r]-t[o][r]}return p(n)}}),p.jStat=p)},960:function(e,t,n){const l=n(592);e.exports=function(r){function i(e,t){let n=e;for(const e of t.split(".")){if(null==n)return;n=n[e]}return n}for(let e=0;e<Object.keys(l).length;e++){let t,n=Object.keys(l)[e],o=[];if("object"==typeof l[n]){o=Object.keys(l[n]),t=Object.values(l[n]);for(let e=0;e<t.length;e++)if("object"==typeof t[e]){let t=o[e];l[n][t]&&(o=[...o,...Object.keys(l[n][t]).map(e=>t+"."+e)]).splice(o.indexOf(t),1)}}if(o.length<1)r[n]=l[n];else for(let e=0;e<o.length;e++)"function"==typeof i(l[n],o[e])&&(r[n]=i(l[n],o[e]))}function o(e){return e="number"==typeof e?parseInt(e):e}let u=null,d=null,p=null;r.TABLE=function(){return p},r.COLUMN=r.COL=function(){return p.tracking&&p.tracking.push(g.getColumnNameFromCoords(o(u),o(d))),o(u)+1},r.ROW=function(){return p.tracking&&p.tracking.push(g.getColumnNameFromCoords(o(u),o(d))),o(d)+1},r.CELL=function(){return g.getColumnNameFromCoords(u,d)},r.VALUE=function(e,t,n){return p.getValueFromCoords(o(e)-1,o(t)-1,n)},r.THISROWCELL=function(e){return p.getValueFromCoords(o(e)-1,o(d))};function f(t,n){for(let e=0;e<t.length;e++){var o=g.getTokensFromRange(t[e]);n=n.replace(t[e],"["+o.join(",")+"]")}return n}function h(e){return"string"==typeof e&&(e=e.trim()),!isNaN(e)&&null!==e&&""!==e}const g=function(e,r,t,n,o){p=o,u=t,d=n;let i="",l={};if(r)if(r.size){let n,o;r.forEach(function(e,t){-1!==(n=t.replace(/!/g,".")).indexOf(".")&&(n=n.split("."),l[n[0]]=!0)}),n=Object.keys(l);for(let e=0;e<n.length;e++)i+="var "+n[e]+" = {};";r.forEach(function(e,t){n=t.replace(/!/g,"."),null===e||h(e)||(o=e.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&o.length&&(e=updateRanges(o,e)),0<n.indexOf(".")?i+=n+" = "+r.get(t)+";\n":i+="var "+n+" = "+e+";\n"})}else{var s,a=Object.keys(r);if(a.length){let t,n={};for(let e=0;e<a.length;e++)if(0<(t=a[e].replace(/\!/g,".")).indexOf(".")){let e=e.split(".");n[e[0]]={}}t=Object.keys(n);for(let e=0;e<t.length;e++)i+="var "+t[e]+" = {};";for(let e=0;e<a.length;e++)t=a[e].replace(/!/g,"."),null===r[a[e]]||h(r[a[e]])||(s=r[a[e]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&s.length&&(r[a[e]]=f(s,r[a[e]])),0<t.indexOf(".")?i+=t+" = "+r[a[e]]+";\n":i+="var "+t+" = "+r[a[e]]+";\n"}}o=(e=function(t){let n="",o=0,r=["=","!",">","<"];for(let e=0;e<t.length;e++)1===(o='"'===t[e]?0===o?1:0:o)?n+=t[e]:(n+=t[e].toUpperCase(),0<e&&"="===t[e]&&-1===r.indexOf(t[e-1])&&-1===r.indexOf(t[e+1])&&(n+="="));return n=(n=(n=(n=n.replace(/\^/g,"**")).replace(/<>/g,"!=")).replace(/&/g,"+")).replace(/\$/g,"")}(e=(e=e.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);o&&o.length&&(e=f(o,e));let c=new Function(i+"; return "+e)();return c=null===c?0:c};return g.getColumnNameFromCoords=function(e,t){return n="",701<(e=parseInt(e))?n=(n+=String.fromCharCode(64+parseInt(e/676)))+String.fromCharCode(64+parseInt(e%676/26)):25<e&&(n+=String.fromCharCode(64+parseInt(e/26))),n+String.fromCharCode(65+e%26)+(parseInt(t)+1);var n},g.getCoordsFromColumnName=function(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var n=0,o=0;o<t[0].length;o++)n+=parseInt(t[0].charCodeAt(o)-64)*Math.pow(26,t[0].length-1-o);--n<0&&(n=0);e=parseInt(/[0-9]+$/.exec(e))||null;return 0<e&&e--,[n,e]}},g.getRangeFromTokens=function(e){e=e.filter(function(e){return"#REF!"!=e});for(var t="",n="",o=0;o<e.length;o++)0<=e[o].indexOf(".")?t=".":0<=e[o].indexOf("!")&&(t="!"),t&&(n=e[o].split(t),e[o]=n[1],n=n[0]+t);return e.sort(function(e,t){e=Helpers.getCoordsFromColumnName(e),t=Helpers.getCoordsFromColumnName(t);return e[1]>t[1]?1:e[1]<t[1]?-1:e[0]>t[0]?1:e[0]<t[0]?-1:0}),e.length?n+(e[0]+":")+e[e.length-1]:"#REF!"},g.getTokensFromRange=function(e){var t,n=0<e.indexOf(".")?(e=(n=e.split("."))[1],n[0]+"."):0<e.indexOf("!")?(e=(n=e.split("!"))[1],n[0]+"!"):"",o=(e=e.split(":"),g.getCoordsFromColumnName(e[0])),r=g.getCoordsFromColumnName(e[1]),i=(o[0]<=r[0]?(t=o[0],r):(t=r[0],o))[0];if(null===o[1]&&null==r[1])for(var l=null,s=null,a=Object.keys(vars),c=0;c<a.length;c++){var u=g.getCoordsFromColumnName(a[c]);u[0]===o[0]&&(null===l||u[1]<l)&&(l=u[1]),u[0]===r[0]&&(null===s||u[1]>s)&&(s=u[1])}else s=(o[1]<=r[1]?(l=o[1],r):(l=r[1],o))[1];for(var d=[],p=l;p<=s;p++){for(var f=[],c=t;c<=i;c++)f.push(n+g.getColumnNameFromCoords(c,p));d.push(f)}return d},g.setFormula=function(t){var n=Object.keys(t);for(let e=0;e<n.length;e++)"function"==typeof t[n[e]]&&(r[n[e]]=t[n[e]])},g.basic=!0,g}("undefined"==typeof window?n.g:window)},592:function(F,e,H){"use strict";var c=H(162),B=H(765);const P=new Error("#NULL!"),s=new Error("#DIV/0!"),f=new Error("#VALUE!"),V=new Error("#REF!"),_=new Error("#NAME?"),u=new Error("#NUM!"),h=new Error("#N/A"),q=new Error("#ERROR!"),Y=new Error("#GETTING_DATA");H=Object.freeze({__proto__:null,data:Y,div0:s,error:q,na:h,name:_,nil:P,num:u,ref:V,value:f});function U(e){const t=[];return l(e,e=>{t.push(e)}),t}function l(e,t){let n=-1;for(var o=e.length;++n<o&&!1!==t(e[n],n,e););}function z(e){let t,n=e.length;for(;n--;){var o;"number"!=typeof(t=e[n])&&(!0!==t?!1!==t?"string"==typeof t&&(o=j(t),e[n]=o instanceof Error?0:o):e[n]=0:e[n]=1)}return e}function W(o,t){if(!o)return f;(o=o.every(e=>Array.isArray(e))&&0!==o.length?o:[[...o]]).map((e,n)=>{e.map((e,t)=>{e||(o[n][t]=0)})});const e=o.reduce((e,t,n)=>t.length>o[e].length?n:e,0),n=o[e].length;return o.map(e=>[...e,...Array(n-e.length).fill(t||0)])}function d(){let e;var t;for(e=1===arguments.length?null!=(t=arguments[0])&&"number"==typeof t.length&&"string"!=typeof t?U.apply(null,arguments):[t]:Array.from(arguments);!function(t){if(!t)return;for(let e=0;e<t.length;++e)if(Array.isArray(t[e]))return;return 1}(e);)e=X(e);return e}function X(e){return e&&e.reduce?e.reduce((e,t)=>{var n=Array.isArray(e),o=Array.isArray(t);return n&&o?e.concat(t):n?(e.push(t),e):o?[e].concat(t):[e,t]}):[e]}function a(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(t):e}function G(n){return n?n[0].map((e,t)=>n.map(e=>e[t])):f}function p(e,n){let o=null;return l(e,(e,t)=>{if(e[0]===n)return o=t,!1}),null==o?f:o}function g(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function m(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return 1}function $(e){return Math.round(1e14*e)/1e14}function K(){return d.apply(null,arguments).filter(e=>"number"==typeof e)}function J(e){if("boolean"==typeof e)return e;if(e instanceof Error)return e;if("number"==typeof e)return 0!==e;if("string"==typeof e){var t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}return e instanceof Date&&!isNaN(e)||f}function b(n){if(isNaN(n))return"string"!=typeof n||(n=/(\d{4})-(\d\d?)-(\d\d?)$/.test(n)?new Date(n+"T00:00:00.000"):new Date(n),isNaN(n))?f:n;if(n instanceof Date)return new Date(n);n=parseFloat(n);if(n<0||2958466<=n)return u;{n<60&&(n+=1);var o=Math.floor(n-25569),o=new Date(86400*o*1e3),r=n-Math.floor(n)+1e-7,i=(r=Math.floor(86400*r))%60,l=(r-=i,Math.floor(r/3600)),r=Math.floor(r/60)%60;let e=o.getUTCDate(),t=o.getUTCMonth();return 60<=n&&n<61&&(e=29,t=1),new Date(o.getUTCFullYear(),t,e,l,r,i)}}function Z(e){let t,n=e.length;for(;n--;){if((t=b(e[n]))===f)return t;e[n]=t}return e}function j(e){return e instanceof Error?e:null==e?0:("boolean"==typeof e&&(e=+e),isNaN(e)||""===e?f:parseFloat(e))}function v(e){let t,n;if(!e||0===(t=e.length))return f;for(;t--;){if(e[t]instanceof Error)return e[t];if((n=j(e[t]))instanceof Error)return n;e[t]=n}return e}function i(e){return e instanceof Error?e:null==e?"":e.toString()}function Q(){let e=arguments.length;for(;e--;)if("string"==typeof arguments[e])return 1}function ee(e){return null!=e}const te=[">",">=","<","<=","=","<>"],ne="operator",oe="literal",re=[ne,oe],ie=ne,y=oe;function x(e,t){if(-1===re.indexOf(t))throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function w(e){{var n=function(e){const t=e.length,n=[];let o=0,r="",i="";for(;o<t;){const t=e.charAt(o);switch(t){case">":case"<":case"=":i+=t,0<r.length&&(n.push(r),r="");break;default:0<i.length&&(n.push(i),i=""),r+=t}o++}return 0<r.length&&n.push(r),0<i.length&&n.push(i),n}(e);let t="";var o=[];for(let e=0;e<n.length;e++){var r=n[e];0===e&&0<=te.indexOf(r)?o.push(x(r,ie)):t+=r}return 0<t.length&&o.push(x(e="string"==typeof(e=t)&&/^\d+(\.\d+)?$/.test(e)?-1===e.indexOf(".")?parseInt(e,10):parseFloat(e):e,y)),0<o.length&&o[0].type!==ie&&o.unshift(x("=",ie)),o}}function C(t){var n=[];let o;for(let e=0;e<t.length;e++){var r=t[e];switch(r.type){case ie:o=r.value;break;case y:n.push(r.value)}}{var i=n;let e=!1;switch(o){case">":e=i[1]<i[0];break;case">=":e=i[1]<=i[0];break;case"<":e=i[0]<i[1];break;case"<=":e=i[0]<=i[1];break;case"=":e=i[0]==i[1];break;case"<>":e=i[0]!=i[1]}return e}}const le={};function se(e){return 0<=[f,V,s,u,_,P].indexOf(e)||"number"==typeof e&&(isNaN(e)||!isFinite(e))}function ae(e){return se(e)||e===h}function ce(e){return!0===e||!1===e}function ue(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}function de(e){return"string"==typeof e}function pe(){var n=[];for(let e=0;e<arguments.length;++e){let t=!1;var o=arguments[e];for(let e=0;e<n.length&&!(t=n[e]===o);++e);t||n.push(o)}return n}function fe(t,n,o,r){if(!n||!o)return h;r=!(0===r||!1===r);let i=h;var l="number"==typeof t;let s=!1;for(let e=0;e<n.length;e++){var a=n[e];if(a[0]===t){i=o<a.length+1?a[o-1]:V;break}!s&&(l&&r&&a[0]<=t||r&&"string"==typeof a[0]&&a[0].localeCompare(t)<0)&&(i=o<a.length+1?a[o-1]:V),l&&a[0]>t&&(s=!0)}return i}function he(){var e=d(arguments).filter(ee);if(0===e.length)return s;var t=g.apply(void 0,e);if(t)return t;var n=K(e),o=n.length;let r,i=0,l=0;for(let e=0;e<o;e++)i+=n[e],l+=1;return r=i/l,r=isNaN(r)?u:r}function ge(){var e=d(arguments).filter(ee);if(0===e.length)return s;const t=g.apply(void 0,e);if(t)return t;var n=e,o=n.length;let r,i=0,l=0;for(let e=0;e<o;e++){const t=n[e];"number"==typeof t&&(i+=t),!0===t&&i++,null!==t&&l++}return r=i/l,r=isNaN(r)?u:r}le.TYPE=e=>{switch(e){case P:return 1;case s:return 2;case f:return 3;case V:return 4;case _:return 5;case u:return 6;case h:return 7;case Y:return 8}return h};var me={DIST:function(e,t,n,o,r,i){return arguments.length<4||(r=void 0===r?0:r,i=void 0===i?1:i,m(e=j(e),t=j(t),n=j(n),r=j(r),i=j(i)))?f:(e=(e-r)/(i-r),o?c.beta.cdf(e,t,n):c.beta.pdf(e,t,n))},INV:(e,t,n,o,r)=>(o=void 0===o?0:o,r=void 0===r?1:r,m(e=j(e),t=j(t),n=j(n),o=j(o),r=j(r))?f:c.beta.inv(e,t,n)*(r-o)+o)},be={DIST:(e,t,n,o)=>m(e=j(e),t=j(t),n=j(n),o=j(o))?f:o?c.binomial.cdf(e,t,n):c.binomial.pdf(e,t,n)},t=(be.DIST.RANGE=(t,n,o,r)=>{if(r=void 0===r?o:r,m(t=j(t),n=j(n),o=j(o),r=j(r)))return f;let i=0;for(let e=o;e<=r;e++)i+=Xe(t,e)*Math.pow(n,e)*Math.pow(1-n,t-e);return i},be.INV=(e,t,n)=>{if(m(e=j(e),t=j(t),n=j(n)))return f;let o=0;for(;o<=e;){if(c.binomial.cdf(o,e,t)>=n)return o;o++}},{DIST:(e,t,n)=>m(e=j(e),t=j(t))?f:n?c.chisquare.cdf(e,t):c.chisquare.pdf(e,t)}),je=(t.DIST.RT=(e,t)=>!e|!t?h:e<1||t>Math.pow(10,10)?u:"number"!=typeof e||"number"!=typeof t?f:1-c.chisquare.cdf(e,t),t.INV=(e,t)=>m(e=j(e),t=j(t))?f:c.chisquare.inv(e,t),t.INV.RT=(e,t)=>!e|!t?h:e<0||1<e||t<1||t>Math.pow(10,10)?u:"number"!=typeof e||"number"!=typeof t?f:c.chisquare.inv(1-e,t),t.TEST=function(e,t){if(2!==arguments.length)return h;if(!(e instanceof Array&&t instanceof Array))return f;if(e.length!==t.length)return f;if(e[0]&&t[0]&&e[0].length!==t[0].length)return f;var n=e.length;let o,r,i;for(r=0;r<n;r++)e[r]instanceof Array||(o=e[r],e[r]=[],e[r].push(o)),t[r]instanceof Array||(o=t[r],t[r]=[],t[r].push(o));var l=e[0].length,s=1===l?n-1:(n-1)*(l-1);let a=0;const c=Math.PI;for(r=0;r<n;r++)for(i=0;i<l;i++)a+=Math.pow(e[r][i]-t[r][i],2)/t[r][i];return Math.round(1e6*function(e,t){let n=Math.exp(-.5*e),o=(t%2==1&&(n*=Math.sqrt(2*e/c)),t);for(;2<=o;)n=n*e/o,o-=2;let r=n,i=t;for(;r>1e-10*n;)i+=2,r=r*e/i,n+=r;return 1-n}(a,s))/1e6},{});function ve(){return K(d(arguments)).length}function ye(){var e=d(arguments);return e.length-xe(e)}function xe(){var t=d(arguments);let n,o=0;for(let e=0;e<t.length;e++)null!=(n=t[e])&&""!==n||o++;return o}je.NORM=(e,t,n)=>m(e=j(e),t=j(t),n=j(n))?f:c.normalci(1,e,t,n)[1]-1,je.T=(e,t,n)=>m(e=j(e),t=j(t),n=j(n))?f:c.tci(1,e,t,n)[1]-1;var we={P:(t,n)=>{if(m(t=v(d(t)),n=v(d(n))))return f;var o=c.mean(t),r=c.mean(n);let i=0;var l=t.length;for(let e=0;e<l;e++)i+=(t[e]-o)*(n[e]-r);return i/l},S:(e,t)=>m(e=v(d(e)),t=v(d(t)))?f:c.covariance(e,t)},Ce={DIST:(e,t,n)=>m(e=j(e),t=j(t))?f:n?c.exponential.cdf(e,t):c.exponential.pdf(e,t)},n={};function Ee(e,t,n){if(m(e=j(e),t=v(d(t)),n=v(d(n))))return f;var o=c.mean(n),r=c.mean(t),i=n.length;let l=0,s=0;for(let e=0;e<i;e++)l+=(n[e]-o)*(t[e]-r),s+=Math.pow(n[e]-o,2);var a=l/s;return r-a*o+a*e}function Ae(e){return(e=j(e))instanceof Error?e:0===e||parseInt(e,10)===e&&e<0?u:c.gammafn(e)}function Le(e){return(e=j(e))instanceof Error?e:c.gammaln(e)}n.DIST=(e,t,n,o)=>m(e=j(e),t=j(t),n=j(n))?f:o?c.centralF.cdf(e,t,n):c.centralF.pdf(e,t,n),n.DIST.RT=function(e,t,n){return 3!==arguments.length?h:e<0||t<1||n<1?u:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?f:1-c.centralF.cdf(e,t,n)},n.INV=(e,t,n)=>m(e=j(e),t=j(t),n=j(n))?f:e<=0||1<e?u:c.centralF.inv(e,t,n),n.INV.RT=function(e,t,n){return 3!==arguments.length?h:e<0||1<e||t<1||t>Math.pow(10,10)||n<1||n>Math.pow(10,10)?u:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?f:c.centralF.inv(1-e,t,n)},n.TEST=(e,t)=>{var n,o,r;return e&&t&&e instanceof Array&&t instanceof Array?e.length<2||t.length<2?s:(n=(t,n)=>{let o=0;for(let e=0;e<t.length;e++)o+=Math.pow(t[e]-n,2);return o},o=Qe(e)/e.length,r=Qe(t)/t.length,n(e,o)/(e.length-1)/(n(t,r)/(t.length-1))):h},Ae.DIST=function(e,t,n,o){return 4!==arguments.length?h:e<0||t<=0||n<=0||"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?f:o?c.gamma.cdf(e,t,n,!0):c.gamma.pdf(e,t,n,!1)},Ae.INV=function(e,t,n){return 3!==arguments.length?h:e<0||1<e||t<=0||n<=0?u:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?f:c.gamma.inv(e,t,n)},Le.PRECISE=function(e){return 1!==arguments.length?h:e<=0?u:"number"!=typeof e?f:c.gammaln(e)};var Me={};function Ie(e,t){return m(e=v(d(e)),t=j(t))?e:t<0||e.length<t?f:e.sort((e,t)=>t-e)[t-1]}function Ne(t,n){if(m(t=v(d(t)),n=v(d(n))))return f;var o=c.mean(t),r=c.mean(n),i=n.length;let l=0,s=0;for(let e=0;e<i;e++)l+=(n[e]-r)*(t[e]-o),s+=Math.pow(n[e]-r,2);var e=l/s;return[e,o-e*r]}Me.DIST=(e,t,n,o,r)=>{return m(e=j(e),t=j(t),n=j(n),o=j(o))?f:(r?function(t,n,o,r){let i=0;for(let e=0;e<=t;e++)i+=l(e,n,o,r);return i}:l)(e,t,n,o);function l(e,t,n,o){return Xe(n,e)*Xe(o-n,t-e)/Xe(o,t)}};var Te={};function De(){var e=d(arguments),t=g.apply(void 0,e);return t||(0===(t=K(e)).length?0:Math.max.apply(Math,t))}function Se(){var e=d(arguments),t=g.apply(void 0,e);if(t)return t;t=z(e);let n=c.median(t);return n=isNaN(n)?u:n}function Oe(){var e=d(arguments),t=g.apply(void 0,e);return t||(0===(t=K(e)).length?0:Math.min.apply(Math,t))}Te.DIST=(e,t,n,o)=>m(e=j(e),t=j(t),n=j(n))?f:o?c.lognormal.cdf(e,t,n):c.lognormal.pdf(e,t,n),Te.INV=(e,t,n)=>m(e=j(e),t=j(t),n=j(n))?f:c.lognormal.inv(e,t,n);const ke={MULT:function(){var t=v(d(arguments));if(t instanceof Error)return t;var n=t.length,o={};let r,i=[],l=0;for(let e=0;e<n;e++)o[r=t[e]]=o[r]?o[r]+1:1,o[r]>l&&(l=o[r],i=[]),o[r]===l&&(i[i.length]=r);return i},SNGL:function(){var e=v(d(arguments));return e instanceof Error?e:ke.MULT(e).sort((e,t)=>e-t)[0]}},Re={DIST:(e,t,n,o)=>m(e=j(e),t=j(t),n=j(n))?f:o?c.negbin.cdf(e,t,n):c.negbin.pdf(e,t,n)},r={};function Fe(t,n){if(m(n=v(d(n)),t=v(d(t))))return f;var o=c.mean(t),r=c.mean(n),i=t.length;let l=0,s=0,a=0;for(let e=0;e<i;e++)l+=(t[e]-o)*(n[e]-r),s+=Math.pow(t[e]-o,2),a+=Math.pow(n[e]-r,2);return l/Math.sqrt(s*a)}r.DIST=(e,t,n,o)=>m(e=j(e),t=j(t),n=j(n))?f:n<=0?u:o?c.normal.cdf(e,t,n):c.normal.pdf(e,t,n),r.INV=(e,t,n)=>m(e=j(e),t=j(t),n=j(n))?f:c.normal.inv(e,t,n),r.S={},r.S.DIST=(e,t)=>(e=j(e))instanceof Error?f:t?c.normal.cdf(e,0,1):c.normal.pdf(e,0,1),r.S.INV=e=>(e=j(e))instanceof Error?f:c.normal.inv(e,0,1);const E={EXC:(e,t)=>{var n;return m(e=v(d(e)),t=j(t))?f:t<1/((n=(e=e.sort((e,t)=>e-t)).length)+1)||1-1/(n+1)<t?u:$((t=t*(n+1)-1)===(n=Math.floor(t))?e[t]:e[n]+(t-n)*(e[n+1]-e[n]))},INC:(e,t)=>{var n;return m(e=v(d(e)),t=j(t))?f:$((t=t*((e=e.sort((e,t)=>e-t)).length-1))===(n=Math.floor(t))?e[t]:e[n]+(t-n)*(e[n+1]-e[n]))}},He={EXC:(e,t,n)=>{if(n=void 0===n?3:n,m(e=v(d(e)),t=j(t),n=j(n)))return f;e=e.sort((e,t)=>e-t);var o=pe.apply(null,e),r=e.length,i=o.length,n=Math.pow(10,n);let l=0,s=!1,a=0;for(;!s&&a<i;)t===o[a]?(l=(e.indexOf(o[a])+1)/(r+1),s=!0):t>=o[a]&&(t<o[a+1]||a===i-1)&&(l=(e.indexOf(o[a])+1+(t-o[a])/(o[a+1]-o[a]))/(r+1),s=!0),a++;return Math.floor(l*n)/n},INC:(e,t,n)=>{if(n=void 0===n?3:n,m(e=v(d(e)),t=j(t),n=j(n)))return f;e=e.sort((e,t)=>e-t);var o=pe.apply(null,e),r=e.length,i=o.length,n=Math.pow(10,n);let l=0,s=!1,a=0;for(;!s&&a<i;)t===o[a]?(l=e.indexOf(o[a])/(r-1),s=!0):t>=o[a]&&(t<o[a+1]||a===i-1)&&(l=(e.indexOf(o[a])+(t-o[a])/(o[a+1]-o[a]))/(r-1),s=!0),a++;return Math.floor(l*n)/n}},Be={DIST:(e,t,n)=>m(e=j(e),t=j(t))?f:n?c.poisson.cdf(e,t):c.poisson.pdf(e,t)},Pe={EXC:(e,t)=>{if(m(e=v(d(e)),t=j(t)))return f;switch(t){case 1:return E.EXC(e,.25);case 2:return E.EXC(e,.5);case 3:return E.EXC(e,.75);default:return u}},INC:(e,t)=>{if(m(e=v(d(e)),t=j(t)))return f;switch(t){case 1:return E.INC(e,.25);case 2:return E.INC(e,.5);case 3:return E.INC(e,.75);default:return u}}},Ve={};function _e(){var t=v(d(arguments));if(t instanceof Error)return t;var n=c.mean(t),o=t.length;let r=0;for(let e=0;e<o;e++)r+=Math.pow(t[e]-n,3);return o*r/((o-1)*(o-2)*Math.pow(c.stdev(t,!0),3))}function qe(e,t){return m(e=v(d(e)),t=j(t))?e:e.sort((e,t)=>e-t)[t-1]}Ve.AVG=(t,n,e)=>{if(m(t=j(t),n=v(d(n))))return f;var e=(e=e||!1)?(e,t)=>e-t:(e,t)=>t-e,o=(n=(n=d(n)).sort(e)).length;let r=0;for(let e=0;e<o;e++)n[e]===t&&r++;return 1<r?(2*n.indexOf(t)+r+1)/2:n.indexOf(t)+1},Ve.EQ=(e,t,n)=>{return m(e=j(e),t=v(d(t)))?f:(n=(n=n||!1)?(e,t)=>e-t:(e,t)=>t-e,(t=t.sort(n)).indexOf(e)+1)},_e.P=function(){var t=v(d(arguments));if(t instanceof Error)return t;var n=c.mean(t),o=t.length;let r=0,i=0;for(let e=0;e<o;e++)i+=Math.pow(t[e]-n,3),r+=Math.pow(t[e]-n,2);return i/=o,r/=o,i/Math.pow(r,1.5)};const A={P:function(){var e=M.P.apply(this,arguments);let t=Math.sqrt(e);return t=isNaN(t)?u:t},S:function(){var e=M.S.apply(this,arguments);return Math.sqrt(e)}},L={DIST:(e,t,n)=>1!==n&&2!==n?u:1===n?L.DIST.RT(e,t):L.DIST["2T"](e,t)},M=(L.DIST["2T"]=function(e,t){return 2!==arguments.length?h:e<0||t<1?u:"number"!=typeof e||"number"!=typeof t?f:2*(1-c.studentt.cdf(e,t))},L.DIST.RT=function(e,t){return 2!==arguments.length?h:e<0||t<1?u:"number"!=typeof e||"number"!=typeof t?f:1-c.studentt.cdf(e,t)},L.INV=(e,t)=>m(e=j(e),t=j(t))?f:c.studentt.inv(e,t),L.INV["2T"]=(e,t)=>(e=j(e),t=j(t),e<=0||1<e||t<1?u:m(e,t)?f:Math.abs(c.studentt.inv(e/2,t))),L.TEST=(e,t)=>{if(m(e=v(d(e)),t=v(d(t))))return f;var n=c.mean(e),o=c.mean(t);let r,i=0,l=0;for(r=0;r<e.length;r++)i+=Math.pow(e[r]-n,2);for(r=0;r<t.length;r++)l+=Math.pow(t[r]-o,2);i/=e.length-1,l/=t.length-1;var s=Math.abs(n-o)/Math.sqrt(i/e.length+l/t.length);return L.DIST["2T"](s,e.length+t.length-2)},{});function Ye(){const t=d(arguments),n=t.length;let o=0,r=0;var i=ge(t);for(let e=0;e<n;e++){const n=t[e];o+="number"==typeof n?Math.pow(n-i,2):!0===n?Math.pow(1-i,2):Math.pow(0-i,2),null!==n&&r++}return o/(r-1)}function Ue(){const t=d(arguments),n=t.length;let o=0,r=0;var i=ge(t);let e;for(let e=0;e<n;e++){const n=t[e];o+="number"==typeof n?Math.pow(n-i,2):!0===n?Math.pow(1-i,2):Math.pow(0-i,2),null!==n&&r++}return e=o/r,e=isNaN(e)?u:e}M.P=function(){var t=K(d(arguments)),n=t.length;let o=0;var r=he(t);let e;for(let e=0;e<n;e++)o+=Math.pow(t[e]-r,2);return e=o/n,e=isNaN(e)?u:e},M.S=function(){var t=K(d(arguments)),n=t.length;let o=0;var r=he(t);for(let e=0;e<n;e++)o+=Math.pow(t[e]-r,2);return o/(n-1)};var ze={DIST:(e,t,n,o)=>m(e=j(e),t=j(t),n=j(n))?f:o?1-Math.exp(-Math.pow(e/n,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/n,t))*t/Math.pow(n,t)},We={};function o(e,t,n){var o=g(e=j(e),t=j(t),n=j(n));if(o)return o;if(0===t)return 0;t=Math.abs(t);o=-Math.floor(Math.log(t)/Math.log(10));return 0<=e?N(Math.ceil(e/t)*t,o):0===n?-N(Math.floor(Math.abs(e)/t)*t,o):-N(Math.ceil(Math.abs(e)/t)*t,o)}function Xe(e,t){return g(e=j(e),t=j(t))||(e<t?u:I(e)/(I(t)*I(e-t)))}We.TEST=(e,t,n)=>{if(m(e=v(d(e)),t=j(t)))return f;n=n||A.S(e);var o=e.length;return 1-r.S.DIST((he(e)-t)/(n/Math.sqrt(o)),!0)},(o.MATH=o).PRECISE=o;const Ge=[];function I(e){return(e=j(e))instanceof Error?e:0===(e=Math.floor(e))||1===e?1:(0<Ge[e]||(Ge[e]=I(e-1)*e),Ge[e])}function $e(e,t){var n=g(e=j(e),t=j(t));if(n)return n;if(0===t)return 0;if(!(0<=e&&0<t||e<=0&&t<0))return u;t=Math.abs(t);n=-Math.floor(Math.log(t)/Math.log(10));return 0<=e?N(Math.floor(e/t)*t,n):-N(Math.ceil(Math.abs(e)/t),n)}$e.PRECISE=$e.MATH=(e,t,n)=>{if(t instanceof Error)return t;t=void 0===t?0:t;var o=g(e=j(e),t=j(t),n=j(n));if(o)return o;if(0===t)return 0;t=t?Math.abs(t):1;o=-Math.floor(Math.log(t)/Math.log(10));return 0<=e?N(Math.floor(e/t)*t,o):0===n||void 0===n?-N(Math.ceil(Math.abs(e)/t)*t,o):-N(Math.floor(Math.abs(e)/t)*t,o)};var Ke={CEILING:o};function Je(e,t){var n=g(e=j(e),t=j(t));return n||(0===e&&0===t||(n=Math.pow(e,t),isNaN(n))?u:n)}function Ze(){var e=d(arguments).filter(e=>null!=e);if(0===e.length)return 0;var t=v(e);if(t instanceof Error)return t;let n=1;for(let e=0;e<t.length;e++)n*=t[e];return n}function N(e,t){return g(e=j(e),t=j(t))||Number(Math.round(Number(e+"e"+t))+"e"+-1*t)}function Qe(){let n=0;return l(U(arguments),e=>{if(n instanceof Error)return!1;var t;e instanceof Error?n=e:"number"==typeof e?n+=e:"string"==typeof e?(t=parseFloat(e),isNaN(t)||(n+=t)):Array.isArray(e)&&((t=Qe.apply(null,e))instanceof Error?n=t:n+=t)}),n}var et=Object.freeze({__proto__:null,ADD:function(e,t){return 2!==arguments.length?h:g(e=j(e),t=j(t))||e+t},DIVIDE:function(e,t){return 2!==arguments.length?h:g(e=j(e),t=j(t))||(0===t?s:e/t)},EQ:function(e,t){return 2!==arguments.length?h:e instanceof Error?e:t instanceof Error?t:(e=null===e?void 0:e)===(t=null===t?void 0:t)},GT:function(e,t){return 2!==arguments.length?h:e instanceof Error?e:t instanceof Error?t:(t=(Q(e,t)?(e=i(e),i):(e=j(e),j))(t),g(e,t)||t<e)},GTE:function(e,t){return 2!==arguments.length?h:(t=(Q(e,t)?(e=i(e),i):(e=j(e),j))(t),g(e,t)||t<=e)},LT:function(e,t){return 2!==arguments.length?h:(t=(Q(e,t)?(e=i(e),i):(e=j(e),j))(t),g(e,t)||e<t)},LTE:function(e,t){return 2!==arguments.length?h:(t=(Q(e,t)?(e=i(e),i):(e=j(e),j))(t),g(e,t)||e<=t)},MINUS:function(e,t){return 2!==arguments.length?h:g(e=j(e),t=j(t))||e-t},MULTIPLY:function(e,t){return 2!==arguments.length?h:g(e=j(e),t=j(t))||e*t},NE:function(e,t){return 2!==arguments.length?h:e instanceof Error?e:t instanceof Error?t:(e=null===e?void 0:e)!==(t=null===t?void 0:t)},POW:function(e,t){return 2!==arguments.length?h:Je(e,t)}});const tt=new Date(Date.UTC(1900,0,1)),nt=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],ot=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],rt=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function it(e,t,n){n=n.toUpperCase(),e=b(e),t=b(t);var o=e.getFullYear(),r=e.getMonth(),i=e.getDate(),l=t.getFullYear(),s=t.getMonth(),a=t.getDate();let c;switch(n){case"Y":c=Math.floor(ft(e,t));break;case"D":c=st(t,e);break;case"M":c=s-r+12*(l-o),a<i&&c--;break;case"MD":c=i<=a?a-i:(0===s?(e.setFullYear(l-1),e.setMonth(12)):(e.setFullYear(l),e.setMonth(s-1)),st(t,e));break;case"YM":c=s-r+12*(l-o),a<i&&c--,c%=12;break;case"YD":r<s||s===r&&a<i?e.setFullYear(l):e.setFullYear(l-1),c=st(t,e)}return c}function lt(e){e=new Date(e);return e.setHours(0,0,0,0),e}function st(e,t){return e=b(e),t=b(t),e instanceof Error?e:t instanceof Error?t:ht(lt(e))-ht(lt(t))}function T(e,t,n){if(n=J(n||"false"),e=b(e),t=b(t),e instanceof Error)return e;if(t instanceof Error)return t;if(n instanceof Error)return n;var o=e.getMonth();let r,i,l=t.getMonth();if(n)r=31===e.getDate()?30:e.getDate(),i=31===t.getDate()?30:t.getDate();else{const n=new Date(e.getFullYear(),o+1,0).getDate(),s=new Date(t.getFullYear(),l+1,0).getDate();r=e.getDate()===n?30:e.getDate(),i=t.getDate()===s?r<30?(l++,1):30:t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(l-o)+(i-r)}function at(e){if((e=b(e))instanceof Error)return e;(e=lt(e)).setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}function ct(e,t,n){return ct.INTL(e,t,1,n)}function ut(e,t,n){return ut.INTL(e,t,1,n)}function dt(e){return 1===new Date(e,1,29).getMonth()}function pt(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function ft(t,n,o){if((t=b(t))instanceof Error)return t;if((n=b(n))instanceof Error)return n;o=o||0;let r=t.getDate();var i=t.getMonth()+1,l=t.getFullYear();let s=n.getDate();var a,c=n.getMonth()+1,u=n.getFullYear();switch(o){case 0:return 31===r&&31===s?(r=30,s=30):31===r?r=30:30===r&&31===s&&(s=30),(s+30*c+360*u-(r+30*i+360*l))/360;case 1:{const o=(e,t)=>{var n=e.getFullYear(),o=new Date(n,2,1);return!!(dt(n)&&e<o&&o<=t)||(n=t.getFullYear(),o=new Date(n,2,1),dt(n)&&o<=t&&e<o)};let e=365;return l===u||l+1===u&&(c<i||i===c&&r>=s)?((l===u&&dt(l)||o(t,n)||1===c&&29===s)&&(e=366),pt(t,n)/e):(a=u-l+1,a=(new Date(u+1,0,1)-new Date(l,0,1))/1e3/60/60/24/a,pt(t,n)/a)}case 2:return pt(t,n)/360;case 3:return pt(t,n)/365;case 4:return(s+30*c+360*u-(r+30*i+360*l))/360}}function ht(e){var t=-22038912e5<e?2:1;return Math.ceil((e-tt)/864e5)+t}function gt(e){return 0===(e=j(e))?f:e instanceof Error?e:String.fromCharCode(e)}function mt(e){if(m(e))return e;let t=(e=e||"").charCodeAt(0);return t=isNaN(t)?f:t}function bt(){var e=d(arguments),t=g.apply(void 0,e);if(t)return t;for(var n;-1<(n=e.indexOf(!0));)e[n]="TRUE";for(var o;-1<(o=e.indexOf(!1));)e[o]="FALSE";return e.join("")}ct.INTL=(n,t,o,r)=>{if((n=b(n))instanceof Error)return n;if((t=b(t))instanceof Error)return t;let i=!1;var l=[],s=[1,2,3,4,5,6,0],e=new RegExp("^[0|1]{7}$");if(void 0===o)o=rt[1];else if("string"==typeof o&&e.test(o)){i=!0,o=o.split("");for(let e=0;e<o.length;e++)"1"===o[e]&&l.push(s[e])}else o=rt[o];if(!(o instanceof Array))return f;void 0===r?r=[]:r instanceof Array||(r=[r]);for(let e=0;e<r.length;e++){const t=b(r[e]);if(t instanceof Error)return t;r[e]=t}var a=Math.round((t-n)/864e5)+1;let c=a;var u=n;for(let e=0;e<a;e++){const n=0<(new Date).getTimezoneOffset()?u.getUTCDay():u.getDay();let t=i?l.includes(n):n===o[0]||n===o[1];for(let e=0;e<r.length;e++){const o=r[e];if(o.getDate()===u.getDate()&&o.getMonth()===u.getMonth()&&o.getFullYear()===u.getFullYear()){t=!0;break}}t&&c--,u.setDate(u.getDate()+1)}return c},ut.INTL=(n,o,r,i)=>{if(!((n=b(n))instanceof Error)){if((o=j(o))instanceof Error)return o;if(o<0)return u;if(!((r=void 0===r?rt[1]:rt[r])instanceof Array))return f;void 0===i?i=[]:i instanceof Array||(i=[i]);for(let e=0;e<i.length;e++){const o=b(i[e]);if(o instanceof Error)return o;i[e]=o}let t=0;for(;t<o;){n.setDate(n.getDate()+1);const o=n.getDay();if(o!==r[0]&&o!==r[1]){for(let e=0;e<i.length;e++){const r=i[e];if(r.getDate()===n.getDate()&&r.getMonth()===n.getMonth()&&r.getFullYear()===n.getFullYear()){t--;break}}t++}}}return n};var jt=bt;function vt(e,t=2,n=!1){if(e=j(e),isNaN(e))return f;if(t=j(t),isNaN(t))return f;if(t<0){const n=Math.pow(10,-t);e=Math.round(e/n)*n}else e=e.toFixed(t);if(n)e=e.toString().replace(/,/g,"");else{const t=e.toString().split(".");t[0]=t[0].replace(/\B(?=(\d{3})+$)/g,","),e=t.join(".")}return e}function D(e,t){return g(e,t)||(e=i(e),(t=j(t))instanceof Error?t:new Array(t+1).join(e))}var yt=gt,xt=mt;function wt(e){return/^[01]{1,10}$/.test(e)}function S(e,t,n){var o;return m(e=j(e),t=j(t))?e:"i"!==(n=void 0===n?"i":n)&&"j"!==n?f:0===e&&0===t?0:0===e?1===t?n:t.toString()+n:0===t?e.toString():(o=0<t?"+":"",e.toString()+o+(1===t?n:t.toString()+n))}function Ct(e,t){return t=void 0===t?0:t,m(e=j(e),t=j(t))?f:c.erf(e)}function Et(e){return isNaN(e)?f:c.erfc(e)}function At(e){var t=k(e),e=O(e);return m(t,e)?f:Math.sqrt(Math.pow(t,2)+Math.pow(e,2))}function O(e){if(void 0===e||!0===e||!1===e)return f;if(0===e||"0"===e)return 0;if(0<=["i","j"].indexOf(e))return 1;let t=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));var o=e.substring(e.length-1,e.length),o="i"===o||"j"===o;return 0<=t||0<=n?o?0<=t?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?u:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?u:-Number(e.substring(n+1,e.length-1)):u:o?isNaN(e.substring(0,e.length-1))?u:e.substring(0,e.length-1):isNaN(e)?u:0}function Lt(e){var t=k(e),e=O(e);return m(t,e)?f:0===t&&0===e?s:0===t&&0<e?Math.PI/2:0===t&&e<0?-Math.PI/2:0===e&&0<t?0:0===e&&t<0?-Math.PI:0<t?Math.atan(e/t):t<0&&0<=e?Math.atan(e/t)+Math.PI:Math.atan(e/t)-Math.PI}function Mt(e){var t=k(e),n=O(e);return m(t,n)?f:(e="i"===(e=e.substring(e.length-1))||"j"===e?e:"i",S(Math.cos(t)*(Math.exp(n)+Math.exp(-n))/2,-Math.sin(t)*(Math.exp(n)-Math.exp(-n))/2,e))}function It(e){var t=k(e),n=O(e);return m(t,n)?f:(e="i"===(e=e.substring(e.length-1))||"j"===e?e:"i",S(Math.cos(n)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(n)*(Math.exp(t)-Math.exp(-t))/2,e))}function Nt(e,t){var n=k(e),o=O(e),r=k(t),i=O(t);if(m(n,o,r,i))return f;var e=e.substring(e.length-1),t=t.substring(t.length-1);let l="i";return"j"!==e&&"j"!==t||(l="j"),0===r&&0===i?u:S((n*r+o*i)/(e=r*r+i*i),(o*r-n*i)/e,l)}function k(e){if(void 0===e||!0===e||!1===e)return f;if(0===e||"0"===e)return 0;if(0<=["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e))return 0;let t=(e+="").indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));var o=e.substring(e.length-1,e.length),o="i"===o||"j"===o;return 0<=t||0<=n?o?0<=t?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?u:Number(e.substring(0,t)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?u:Number(e.substring(0,n)):u:o?isNaN(e.substring(0,e.length-1))?u:0:isNaN(e)?u:e}function Tt(e){var t=k(e),n=O(e);return m(t,n)?f:(e="i"===(e=e.substring(e.length-1))||"j"===e?e:"i",S(Math.sin(t)*(Math.exp(n)+Math.exp(-n))/2,Math.cos(t)*(Math.exp(n)-Math.exp(-n))/2,e))}function Dt(e){var t=k(e),n=O(e);return m(t,n)?f:(e="i"===(e=e.substring(e.length-1))||"j"===e?e:"i",S(Math.cos(n)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(n)*(Math.exp(t)+Math.exp(-t))/2,e))}Ct.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")};var St=me.DIST,Ot=me.INV,kt=be.DIST,Rt=o.MATH,Ft=o.PRECISE,Ht=t.DIST,Bt=t.DIST.RT,Pt=t.INV,Vt=t.INV.RT,_t=t.TEST,qt=we.P,Yt=we.P,Ut=we.S,zt=be.INV,Wt=Et.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")},Xt=Ct.PRECISE,Gt=Ce.DIST,$t=n.DIST,Kt=n.DIST.RT,Jt=n.INV,Zt=n.INV.RT,Qt=$e.MATH,en=$e.PRECISE,tn=n.TEST,nn=Ae.DIST,on=Ae.INV,rn=Le.PRECISE,ln=Me.DIST,sn=Te.INV,an=Te.DIST,cn=Te.INV,un=ke.MULT,dn=ke.SNGL,pn=Re.DIST,fn=ct.INTL,hn=r.DIST,gn=r.INV,mn=r.S.DIST,bn=r.S.INV,jn=E.EXC,vn=E.INC,yn=He.EXC,xn=He.INC,wn=Be.DIST,Cn=Pe.EXC,En=Pe.INC,An=Ve.AVG,Ln=Ve.EQ,Mn=_e.P,In=A.P,Nn=A.S,Tn=L.DIST,Dn=L.DIST.RT,Sn=L.INV,On=L.TEST,kn=M.P,Rn=M.S,Fn=ze.DIST,Hn=ut.INTL,Bn=We.TEST;function Pn(e){const t=[];return l(e,e=>{e&&t.push(e)}),t}function R(i,l){const s={};for(let e=1;e<i[0].length;++e)s[e]=!0;let a=l[0].length;for(let e=1;e<l.length;++e)l[e].length>a&&(a=l[e].length);for(let r=1;r<i.length;++r)for(let o=1;o<i[r].length;++o){let t=!1,n=!1;for(let e=0;e<l.length;++e){var c=l[e];if(!(c.length<a)){var u=c[0];if(i[r][0]===u){n=!0;for(let e=1;e<c.length;++e)if(!t)if(void 0===c[e]||"*"===c[e])t=!0;else{const s=w(c[e]+""),a=[x(i[r][o],y)].concat(s);t=C(a)}}}}n&&(s[o]=s[o]&&t)}var t=[];for(let e=0;e<i[0].length;++e)s[e]&&t.push(e-1);return t}function Vn(e){return e&&e.getTime&&!isNaN(e.getTime())}function _n(e){return e instanceof Date?e:new Date(e)}function qn(e,t,n,o,r){if(o=o||0,r=r||0,m(e=j(e),t=j(t),n=j(n),o=j(o),r=j(r)))return f;let i;return-(i=0===e?o+n*t:(t=Math.pow(1+e,t),1===r?o*t+n*(1+e)*(t-1)/e:o*t+n*(t-1)/e))}function Yn(e,t,n,o,r,i){return r=r||0,i=i||0,m(e=j(e),t=j(t),n=j(n),o=j(o),r=j(r),i=j(i))?f:(n=zn(e,n,o,r,i),(1===t?1===i?0:-o:1===i?qn(e,t-2,n,o,1)-n:qn(e,t-1,n,o,0))*e)}function Un(){var t=v(d(arguments));if(t instanceof Error)return t;var n=t[0];let o=0;for(let e=1;e<t.length;e++)o+=t[e]/Math.pow(1+n,e);return o}function zn(e,t,n,o,r){if(o=o||0,r=r||0,m(e=j(e),t=j(t),n=j(n),o=j(o),r=j(r)))return f;let i;return-(i=0===e?(n+o)/t:(t=Math.pow(1+e,t),1===r?(o*e/(t-1)+n*e/(1-1/t))/(1+e):o*e/(t-1)+n*e/(1-1/t)))}H={errors:H,symbols:et};e.ABS=function(e){return(e=j(e))instanceof Error?e:Math.abs(e)},e.ACCRINT=function(e,t,n,o,r,i,l){return e=_n(e),t=_n(t),n=_n(n),Vn(e)&&Vn(t)&&Vn(n)?o<=0||r<=0||-1===[1,2,4].indexOf(i)||-1===[0,1,2,3,4].indexOf(l)||n<=e?u:(r=r||0)*o*ft(e,n,l=l||0):f},e.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},e.ACOS=function(e){if((e=j(e))instanceof Error)return e;let t=Math.acos(e);return t=isNaN(t)?u:t},e.ACOSH=function(e){if((e=j(e))instanceof Error)return e;let t=Math.log(e+Math.sqrt(e*e-1));return t=isNaN(t)?u:t},e.ACOT=function(e){return(e=j(e))instanceof Error?e:Math.atan(1/e)},e.ACOTH=function(e){if((e=j(e))instanceof Error)return e;let t=.5*Math.log((e+1)/(e-1));return t=isNaN(t)?u:t},e.AGGREGATE=function(e,t,n,o){if(m(e=j(e),j(e)))return f;switch(e){case 1:return he(n);case 2:return ve(n);case 3:return ye(n);case 4:return De(n);case 5:return Oe(n);case 6:return Ze(n);case 7:return A.S(n);case 8:return A.P(n);case 9:return Qe(n);case 10:return M.S(n);case 11:return M.P(n);case 12:return Se(n);case 13:return ke.SNGL(n);case 14:return Ie(n,o);case 15:return qe(n,o);case 16:return E.INC(n,o);case 17:return Pe.INC(n,o);case 18:return E.EXC(n,o);case 19:return Pe.EXC(n,o)}},e.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},e.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},e.AND=function(){var t=d(arguments);let n=f;for(let e=0;e<t.length;e++){if(t[e]instanceof Error)return t[e];void 0!==t[e]&&null!==t[e]&&"string"!=typeof t[e]&&(n===f&&(n=!0),t[e]||(n=!1))}return n},e.ARABIC=function(e){if(null==e)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return f;let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,e=>{t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]}),t},e.ASC=function(){throw new Error("ASC is not implemented")},e.ASIN=function(e){if((e=j(e))instanceof Error)return e;let t=Math.asin(e);return t=isNaN(t)?u:t},e.ASINH=function(e){return(e=j(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},e.ATAN=function(e){return(e=j(e))instanceof Error?e:Math.atan(e)},e.ATAN2=function(e,t){return g(e=j(e),t=j(t))||Math.atan2(e,t)},e.ATANH=function(e){if((e=j(e))instanceof Error)return e;let t=Math.log((1+e)/(1-e))/2;return t=isNaN(t)?u:t},e.AVEDEV=function(){var e=d(arguments).filter(ee);return 0===e.length?u:(e=v(e))instanceof Error?e:c.sum(c(e).subtract(c.mean(e)).abs()[0])/e.length},e.AVERAGE=he,e.AVERAGEA=ge,e.AVERAGEIF=function(t,e,n){if(arguments.length<=1)return h;if(n=v(d(n=n||t).filter(ee)),t=d(t),n instanceof Error)return n;let o=0,r=0;var i=void 0===e||"*"===e,l=i?null:w(e+"");for(let e=0;e<t.length;e++){var s=t[e];if(i)r+=n[e],o++;else{const t=[x(s,y)].concat(l);C(t)&&(r+=n[e],o++)}}return r/o},e.AVERAGEIFS=function(){const r=U(arguments),i=(r.length-1)/2,l=d(r[0]);let s=0,e=0;for(let o=0;o<l.length;o++){let n=!1;for(let t=0;t<i;t++){const i=r[2*t+1][o],s=r[2*t+2];let e=!1;if(void 0===s||"*"===s)e=!0;else{const r=w(s+""),l=[x(i,y)].concat(r);e=C(l)}if(!e){n=!1;break}n=!0}n&&(e+=l[o],s++)}var t=e/s;return isNaN(t)?0:t},e.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},e.BASE=function(e,t,n){var o=g(e=j(e),t=j(t),n=j(n));return o||(0===t?u:(o=e.toString(t),new Array(Math.max(n+1-o.length,0)).join("0")+o))},e.BESSELI=function(e,t){return m(e=j(e),t=j(t))?f:B.besseli(e,t)},e.BESSELJ=function(e,t){return m(e=j(e),t=j(t))?f:B.besselj(e,t)},e.BESSELK=function(e,t){return m(e=j(e),t=j(t))?f:B.besselk(e,t)},e.BESSELY=function(e,t){return m(e=j(e),t=j(t))?f:B.bessely(e,t)},e.BETA=me,e.BETADIST=St,e.BETAINV=Ot,e.BIN2DEC=function(e){var t;return wt(e)?(t=parseInt(e,2),10===(e=e.toString()).length&&"1"===e.substring(0,1)?parseInt(e.substring(1),2)-512:t):u},e.BIN2HEX=function(e,t){var n;return wt(e)?10===(n=e.toString()).length&&"1"===n.substring(0,1)?(0xfffffffe00+parseInt(n.substring(1),2)).toString(16):(n=parseInt(e,2).toString(16),void 0===t?n:isNaN(t)?f:!(t<0)&&(t=Math.floor(t))>=n.length?D("0",t-n.length)+n:u):u},e.BIN2OCT=function(e,t){var n;return wt(e)?10===(n=e.toString()).length&&"1"===n.substring(0,1)?(1073741312+parseInt(n.substring(1),2)).toString(8):(n=parseInt(e,2).toString(8),void 0===t?n:isNaN(t)?f:!(t<0)&&(t=Math.floor(t))>=n.length?D("0",t-n.length)+n:u):u},e.BINOM=be,e.BINOMDIST=kt,e.BITAND=function(e,t){return m(e=j(e),t=j(t))?f:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||0xffffffffffff<e||0xffffffffffff<t?u:e&t},e.BITLSHIFT=function(e,t){return m(e=j(e),t=j(t))?f:e<0||Math.floor(e)!==e||0xffffffffffff<e||53<Math.abs(t)?u:0<=t?e<<t:e>>-t},e.BITOR=function(e,t){return m(e=j(e),t=j(t))?f:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||0xffffffffffff<e||0xffffffffffff<t?u:e|t},e.BITRSHIFT=function(e,t){return m(e=j(e),t=j(t))?f:e<0||Math.floor(e)!==e||0xffffffffffff<e||53<Math.abs(t)?u:0<=t?e>>t:e<<-t},e.BITXOR=function(e,t){return m(e=j(e),t=j(t))?f:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||0xffffffffffff<e||0xffffffffffff<t?u:e^t},e.CEILING=o,e.CEILINGMATH=Rt,e.CEILINGPRECISE=Ft,e.CELL=function(){throw new Error("CELL is not implemented")},e.CHAR=gt,e.CHIDIST=Ht,e.CHIDISTRT=Bt,e.CHIINV=Pt,e.CHIINVRT=Vt,e.CHISQ=t,e.CHITEST=_t,e.CHOOSE=function(){var e;return arguments.length<2?h:(e=arguments[0])<1||254<e||arguments.length<e+1?f:arguments[e]},e.CLEAN=function(e){return m(e)?e:(e=e||"").replace(/[\0-\x1F]/g,"")},e.CODE=mt,e.COLUMN=function(e,t){return 2!==arguments.length?h:t<0?u:e instanceof Array&&"number"==typeof t?0!==e.length?c.col(e,t):void 0:f},e.COLUMNS=function(e){return 1!==arguments.length?h:e instanceof Array?0===e.length?0:c.cols(e):f},e.COMBIN=Xe,e.COMBINA=function(e,t){return g(e=j(e),t=j(t))||(e<t?u:0===e&&0===t?1:Xe(e+t-1,e-1))},e.COMPLEX=S,e.CONCAT=jt,e.CONCATENATE=bt,e.CONFIDENCE=je,e.CONVERT=function(t,n,o){if((t=j(t))instanceof Error)return t;var r=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],i={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},l={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let s,a=null,c=null,u=n,d=o,p=1,f=1;for(let e=0;e<r.length;e++)s=null===r[e][2]?[]:r[e][2],(r[e][1]===u||0<=s.indexOf(u))&&(a=r[e]),(r[e][1]===d||0<=s.indexOf(d))&&(c=r[e]);if(null===a){const t=i[n.substring(0,2)];let e=l[n.substring(0,1)];"da"===n.substring(0,2)&&(e=["dekao",10,"da"]),t?(p=t[2],u=n.substring(2)):e&&(p=e[1],u=n.substring(e[2].length));for(let e=0;e<r.length;e++)s=null===r[e][2]?[]:r[e][2],(r[e][1]===u||0<=s.indexOf(u))&&(a=r[e])}if(null===c){const t=i[o.substring(0,2)];let e=l[o.substring(0,1)];"da"===o.substring(0,2)&&(e=["dekao",10,"da"]),t?(f=t[2],d=o.substring(2)):e&&(f=e[1],d=o.substring(e[2].length));for(let e=0;e<r.length;e++)s=null===r[e][2]?[]:r[e][2],(r[e][1]===d||0<=s.indexOf(d))&&(c=r[e])}return null===a||null===c||a[3]!==c[3]?h:t*a[6]*p/(c[6]*f)},e.CORREL=function(e,t){return m(e=v(d(e)),t=v(d(t)))?f:c.corrcoeff(e,t)},e.COS=function(e){return(e=j(e))instanceof Error?e:Math.cos(e)},e.COSH=function(e){return(e=j(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},e.COT=function(e){return(e=j(e))instanceof Error?e:0===e?s:1/Math.tan(e)},e.COTH=function(e){return(e=j(e))instanceof Error?e:0===e?s:((e=Math.exp(2*e))+1)/(e-1)},e.COUNT=ve,e.COUNTA=ye,e.COUNTBLANK=xe,e.COUNTIF=function(t,e){if(t=d(t),void 0===e||"*"===e)return t.length;let n=0;var o=w(e+"");for(let e=0;e<t.length;e++){var r=[x(t[e],y)].concat(o);C(r)&&n++}return n},e.COUNTIFS=function(){const t=U(arguments),n=new Array(d(t[0]).length);for(let e=0;e<n.length;e++)n[e]=!0;for(let e=0;e<t.length;e+=2){var o=d(t[e]),r=t[e+1];if(void 0!==r&&"*"!==r){const t=w(r+"");for(let e=0;e<o.length;e++){var i=[x(o[e],y)].concat(t);n[e]=n[e]&&C(i)}}}let l=0;for(let e=0;e<n.length;e++)n[e]&&l++;return l},e.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},e.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},e.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},e.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},e.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},e.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},e.COVAR=qt,e.COVARIANCE=we,e.COVARIANCEP=Yt,e.COVARIANCES=Ut,e.CRITBINOM=zt,e.CSC=function(e){return(e=j(e))instanceof Error?e:0===e?s:1/Math.sin(e)},e.CSCH=function(e){return(e=j(e))instanceof Error?e:0===e?s:2/(Math.exp(e)-Math.exp(-e))},e.CUMIPMT=function(t,e,n,o,r,i){if(m(t=j(t),e=j(e),n=j(n)))return f;if(t<=0||e<=0||n<=0)return u;if(o<1||r<1||r<o)return u;if(0!==i&&1!==i)return u;var l=zn(t,e,n,0,i);let s=0;1===o&&(0===i&&(s=-n),o++);for(let e=o;e<=r;e++)s+=1===i?qn(t,e-2,l,n,1)-l:qn(t,e-1,l,n,0);return s*=t},e.CUMPRINC=function(t,e,n,o,r,i){if(m(t=j(t),e=j(e),n=j(n)))return f;if(t<=0||e<=0||n<=0)return u;if(o<1||r<1||r<o)return u;if(0!==i&&1!==i)return u;var l=zn(t,e,n,0,i);let s=0;1===o&&(s=0===i?l+n*t:l,o++);for(let e=o;e<=r;e++)s+=0<i?l-(qn(t,e-2,l,n,1)-l)*t:l-qn(t,e-1,l,n,0)*t;return s},e.DATE=function(e,t,n){let o;return m(e=j(e),t=j(t),n=j(n))?o=f:(o=new Date(e,t-1,n)).getFullYear()<0&&(o=u),o},e.DATEDIF=it,e.DATEVALUE=function(e){var t;return"string"!=typeof e||(t=Date.parse(e),isNaN(t))?f:new Date(e)},e.DAVERAGE=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return f;n=R(e,n);let o=[];if("string"==typeof t){const n=p(e,t);o=a(e[n])}else o=a(e[t]);let r=0;return l(n,e=>{r+=o[e]}),0===n.length?s:r/n.length},e.DAY=function(e){e=b(e);return e instanceof Error?e:e.getDate()},e.DAYS=st,e.DAYS360=T,e.DB=function(t,e,n,o,r){if(r=void 0===r?12:r,m(t=j(t),e=j(e),n=j(n),o=j(o),r=j(r)))return f;if(t<0||e<0||n<0||o<0)return u;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(r))return u;if(n<o)return u;if(t<=e)return 0;var i=(1-Math.pow(e/t,1/n)).toFixed(3),e=t*i*r/12;let l=e,s=0;var a=o===n?n-1:o;for(let e=2;e<=a;e++)s=(t-l)*i,l+=s;return 1===o?e:o===n?(t-l)*i:s},e.DBCS=function(){throw new Error("DBCS is not implemented")},e.DCOUNT=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return f;n=R(e,n);let o=[];if("string"==typeof t){const n=p(e,t);o=a(e[n])}else o=a(e[t]);const r=[];return l(n,e=>{r.push(o[e])}),ve(r)},e.DCOUNTA=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return f;n=R(e,n);let o=[];if("string"==typeof t){const n=p(e,t);o=a(e[n])}else o=a(e[t]);const r=[];return l(n,e=>{r.push(o[e])}),ye(r)},e.DDB=function(t,n,o,r,i){if(i=void 0===i?2:i,m(t=j(t),n=j(n),o=j(o),r=j(r),i=j(i)))return f;if(t<0||n<0||o<0||r<0||i<=0)return u;if(o<r)return u;if(t<=n)return 0;let l=0,s=0;for(let e=1;e<=r;e++)s=Math.min(i/o*(t-l),t-n-l),l+=s;return s},e.DEC2BIN=function(e,t){return(e=j(e))instanceof Error?e:!/^-?[0-9]{1,3}$/.test(e)||e<-512||511<e?u:e<0?"1"+D("0",9-(512+e).toString(2).length)+(512+e).toString(2):(e=parseInt(e,10).toString(2),void 0===t?e:isNaN(t)?f:!(t<0)&&(t=Math.floor(t))>=e.length?D("0",t-e.length)+e:u)},e.DEC2HEX=function(e,t){return(e=j(e))instanceof Error?e:!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||549755813887<e?u:e<0?(1099511627776+e).toString(16):(e=parseInt(e,10).toString(16),void 0===t?e:isNaN(t)?f:!(t<0)&&(t=Math.floor(t))>=e.length?D("0",t-e.length)+e:u)},e.DEC2OCT=function(e,t){return(e=j(e))instanceof Error?e:!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||536870911<e?u:e<0?(1073741824+e).toString(8):(e=parseInt(e,10).toString(8),void 0===t?e:isNaN(t)?f:!(t<0)&&(t=Math.floor(t))>=e.length?D("0",t-e.length)+e:u)},e.DECIMAL=function(e,t){return arguments.length<1?f:g(e=j(e),t=j(t))||(0===t?u:parseInt(e,t))},e.DEGREES=function(e){return(e=j(e))instanceof Error?e:180*e/Math.PI},e.DELTA=function(e,t){return t=void 0===t?0:t,m(e=j(e),t=j(t))?f:e===t?1:0},e.DEVSQ=function(){var t=v(d(arguments));if(t instanceof Error)return t;var n=c.mean(t);let o=0;for(let e=0;e<t.length;e++)o+=Math.pow(t[e]-n,2);return o},e.DGET=function(e,t,n){var o;return isNaN(t)&&"string"!=typeof t||(n=R(e,n),o=[],o=a("string"==typeof t?e[p(e,t)]:e[t]),0===n.length)?f:1<n.length?u:o[n[0]]},e.DISC=function(e,t,n,o,r){if(m(e=b(e),t=b(t),n=j(n),o=j(o),r=j(r)||0))return f;if(n<=0||o<=0)return u;if(t<=e)return f;let i,l;switch(r){case 0:i=360,l=T(e,t,!1);break;case 1:case 3:i=365,l=it(e,t,"D");break;case 2:i=360,l=it(e,t,"D");break;case 4:i=360,l=T(e,t,!0);break;default:return u}return(o-n)/o*i/l},e.DMAX=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return f;n=R(e,n);let o=[];if("string"==typeof t){const n=p(e,t);o=a(e[n])}else o=a(e[t]);let r=o[n[0]];return l(n,e=>{r<o[e]&&(r=o[e])}),r},e.DMIN=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return f;n=R(e,n);let o=[];if("string"==typeof t){const n=p(e,t);o=a(e[n])}else o=a(e[t]);let r=o[n[0]];return l(n,e=>{r>o[e]&&(r=o[e])}),r},e.DOLLAR=function(e,t=2){var n;return e=j(e),isNaN(e)?f:(n={style:"currency",currency:"USD",minimumFractionDigits:0<=t?t:0,maximumFractionDigits:0<=t?t:0},t=(e=N(e,t)).toLocaleString("en-US",n),e<0?"$("+t.slice(2)+")":t)},e.DOLLARDE=function(e,t){if(m(e=j(e),t=j(t)))return f;if(t<0)return u;if(0<=t&&t<1)return s;t=parseInt(t,10);var n=parseInt(e,10),e=(n+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t,Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1));return Math.round(n*e)/e},e.DOLLARFR=function(e,t){if(m(e=j(e),t=j(t)))return f;if(t<0)return u;if(0<=t&&t<1)return s;t=parseInt(t,10);var n=parseInt(e,10);return n+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t},e.DPRODUCT=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return f;n=R(e,n);let o=[];if("string"==typeof t){const n=p(e,t);o=a(e[n])}else o=a(e[t]);let r=[],i=(l(n,e=>{r.push(o[e])}),r=Pn(r),1);return l(r,e=>{i*=e}),i},e.DSTDEV=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return f;n=R(e,n);let o=[];if("string"==typeof t){const n=p(e,t);o=a(e[n])}else o=a(e[t]);let r=[];return l(n,e=>{r.push(o[e])}),r=Pn(r),A.S(r)},e.DSTDEVP=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return f;n=R(e,n);let o=[];if("string"==typeof t){const n=p(e,t);o=a(e[n])}else o=a(e[t]);let r=[];return l(n,e=>{r.push(o[e])}),r=Pn(r),A.P(r)},e.DSUM=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return f;n=R(e,n);let o=[];if("string"==typeof t){const n=p(e,t);o=a(e[n])}else o=a(e[t]);const r=[];return l(n,e=>{r.push(o[e])}),Qe(r)},e.DURATION=function(){throw new Error("DURATION is not implemented")},e.DVAR=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return f;n=R(e,n);let o=[];if("string"==typeof t){const n=p(e,t);o=a(e[n])}else o=a(e[t]);const r=[];return l(n,e=>{r.push(o[e])}),M.S(r)},e.DVARP=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return f;n=R(e,n);let o=[];if("string"==typeof t){const n=p(e,t);o=a(e[n])}else o=a(e[t]);const r=[];return l(n,e=>{r.push(o[e])}),M.P(r)},e.EDATE=function(e,t){return(e=b(e))instanceof Error?e:isNaN(t)?f:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),e)},e.EFFECT=function(e,t){return m(e=j(e),t=j(t))?f:e<=0||t<1?u:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},e.EOMONTH=function(e,t){return(e=b(e))instanceof Error?e:isNaN(t)?f:(t=parseInt(t,10),new Date(e.getFullYear(),e.getMonth()+t+1,0))},e.ERF=Ct,e.ERFC=Et,e.ERFCPRECISE=Wt,e.ERFPRECISE=Xt,e.ERROR=le,e.EVEN=function(e){return(e=j(e))instanceof Error?e:o(e,-2,-1)},e.EXACT=function(e,t){return 2!==arguments.length?h:g(e,t)||(e=i(e))===i(t)},e.EXP=function(e){return arguments.length<1?h:1<arguments.length?q:(e=j(e))instanceof Error?e:Math.exp(e)},e.EXPON=Ce,e.EXPONDIST=Gt,e.F=n,e.FACT=I,e.FACTDOUBLE=function e(t){return(t=j(t))instanceof Error?t:(t=Math.floor(t))<=0?1:t*e(t-2)},e.FALSE=function(){return!1},e.FDIST=$t,e.FDISTRT=Kt,e.FIND=function(e,t,n){if(arguments.length<2)return h;e=i(e),n=void 0===n?0:n;t=(t=i(t)).indexOf(e,n-1);return-1===t?f:t+1},e.FINV=Jt,e.FINVRT=Zt,e.FISHER=function(e){return(e=j(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},e.FISHERINV=function(e){return(e=j(e))instanceof Error?e:((e=Math.exp(2*e))-1)/(e+1)},e.FIXED=vt,e.FLOOR=$e,e.FLOORMATH=Qt,e.FLOORPRECISE=en,e.FORECAST=Ee,e.FREQUENCY=function(n,o){if(m(n=v(d(n)),o=v(d(o))))return f;var r=n.length,i=o.length,l=[];for(let t=0;t<=i;t++)for(let e=l[t]=0;e<r;e++)0===t?n[e]<=o[0]&&(l[0]+=1):t<i?n[e]>o[t-1]&&n[e]<=o[t]&&(l[t]+=1):t===i&&n[e]>o[i-1]&&(l[i]+=1);return l},e.FTEST=tn,e.FV=qn,e.FVSCHEDULE=function(e,t){if(m(e=j(e),t=v(d(t))))return f;var n=t.length;let o=e;for(let e=0;e<n;e++)o*=1+t[e];return o},e.GAMMA=Ae,e.GAMMADIST=nn,e.GAMMAINV=on,e.GAMMALN=Le,e.GAMMALNPRECISE=rn,e.GAUSS=function(e){return(e=j(e))instanceof Error?e:c.normal.cdf(e,0,1)-.5},e.GCD=function(){var n=v(d(arguments));if(n instanceof Error)return n;const o=n.length,e=n[0];let r=e<0?-e:e;for(let t=1;t<o;t++){const o=n[t];let e=o<0?-o:o;for(;r&&e;)r>e?r%=e:e%=r;r+=e}return r},e.GEOMEAN=function(){var e=v(d(arguments));return e instanceof Error?e:c.geomean(e)},e.GESTEP=function(e,t){return m(t=t||0,e=j(e))?e:t<=e?1:0},e.GROWTH=function(e,t,n,o){if((e=v(e))instanceof Error)return e;let r;if(void 0===t)for(t=[],r=1;r<=e.length;r++)t.push(r);if(void 0===n)for(n=[],r=1;r<=e.length;r++)n.push(r);if(m(t=v(t),n=v(n)))return f;void 0===o&&(o=!0);var i=e.length;let l,s,a=0,c=0,u=0,d=0;for(r=0;r<i;r++){const n=t[r],o=Math.log(e[r]);a+=n,c+=o,u+=n*o,d+=n*n}a/=i,c/=i,u/=i,d/=i,s=o?(l=(u-a*c)/(d-a*a),c-l*a):(l=u/d,0);var p=[];for(r=0;r<n.length;r++)p.push(Math.exp(s+l*n[r]));return p},e.HARMEAN=function(){var t=v(d(arguments));if(t instanceof Error)return t;var n=t.length;let o=0;for(let e=0;e<n;e++)o+=1/t[e];return n/o},e.HEX2BIN=function(e,t){var n;return!/^[0-9A-Fa-f]{1,10}$/.test(e)||(e=(n=!(10!==e.length||"f"!==e.substring(0,1).toLowerCase()))?parseInt(e,16)-1099511627776:parseInt(e,16))<-512||511<e?u:n?"1"+D("0",9-(512+e).toString(2).length)+(512+e).toString(2):(n=e.toString(2),void 0===t?n:isNaN(t)?f:!(t<0)&&(t=Math.floor(t))>=n.length?D("0",t-n.length)+n:u)},e.HEX2DEC=function(e){return/^[0-9A-Fa-f]{1,10}$/.test(e)?549755813888<=(e=parseInt(e,16))?e-1099511627776:e:u},e.HEX2OCT=function(e,t){return!/^[0-9A-Fa-f]{1,10}$/.test(e)||536870911<(e=parseInt(e,16))&&e<0xffe0000000?u:0xffe0000000<=e?(e-0xffc0000000).toString(8):(e=e.toString(8),void 0===t?e:isNaN(t)?f:!(t<0)&&(t=Math.floor(t))>=e.length?D("0",t-e.length)+e:u)},e.HLOOKUP=function(e,t,n,o){return fe(e,G(t),n,o)},e.HOUR=function(e){return(e=b(e))instanceof Error?e:e.getHours()},e.HYPGEOM=Me,e.HYPGEOMDIST=ln,e.IF=function(e,t,n){return e instanceof Error?e:(null==(t=!(2<=arguments.length)||t)&&(t=0),null==(n=3===arguments.length&&n)&&(n=0),e?t:n)},e.IFERROR=function(e,t){return ae(e)?t:e},e.IFNA=function(e,t){return e===h?t:e},e.IFS=function(){for(let e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return h},e.IMABS=At,e.IMAGINARY=O,e.IMARGUMENT=Lt,e.IMCONJUGATE=function(e){var t,n=k(e),o=O(e);return m(n,o)?f:(t="i"===(t=e.substring(e.length-1))||"j"===t?t:"i",0!==o?S(n,-o,t):e)},e.IMCOS=Mt,e.IMCOSH=It,e.IMCOT=function(e){return m(k(e),O(e))?f:Nt(Mt(e),Tt(e))},e.IMCSC=function(e){return!0===e||!1===e?f:m(k(e),O(e))?u:Nt("1",Tt(e))},e.IMCSCH=function(e){return!0===e||!1===e?f:m(k(e),O(e))?u:Nt("1",Dt(e))},e.IMDIV=Nt,e.IMEXP=function(e){var t=k(e),n=O(e);return m(t,n)?f:(e="i"===(e=e.substring(e.length-1))||"j"===e?e:"i",S((t=Math.exp(t))*Math.cos(n),t*Math.sin(n),e))},e.IMLN=function(e){var t=k(e),n=O(e);return m(t,n)?f:(e="i"===(e=e.substring(e.length-1))||"j"===e?e:"i",S(Math.log(Math.sqrt(t*t+n*n)),Math.atan(n/t),e))},e.IMLOG10=function(e){var t=k(e),n=O(e);return m(t,n)?f:(e="i"===(e=e.substring(e.length-1))||"j"===e?e:"i",S(Math.log(Math.sqrt(t*t+n*n))/Math.log(10),Math.atan(n/t)/Math.log(10),e))},e.IMLOG2=function(e){var t=k(e),n=O(e);return m(t,n)?f:(e="i"===(e=e.substring(e.length-1))||"j"===e?e:"i",S(Math.log(Math.sqrt(t*t+n*n))/Math.log(2),Math.atan(n/t)/Math.log(2),e))},e.IMPOWER=function(e,t){var n,o;return m(t=j(t),k(e),O(e))?f:(n="i"===(n=e.substring(e.length-1))||"j"===n?n:"i",o=Math.pow(At(e),t),e=Lt(e),S(o*Math.cos(t*e),o*Math.sin(t*e),n))},e.IMPRODUCT=function(){let t=arguments[0];if(!arguments.length)return f;for(let e=1;e<arguments.length;e++){var n=k(t),o=O(t),r=k(arguments[e]),i=O(arguments[e]);if(m(n,o,r,i))return f;t=S(n*r-o*i,n*i+o*r)}return t},e.IMREAL=k,e.IMSEC=function(e){return!0===e||!1===e||m(k(e),O(e))?f:Nt("1",Mt(e))},e.IMSECH=function(e){return m(k(e),O(e))?f:Nt("1",It(e))},e.IMSIN=Tt,e.IMSINH=Dt,e.IMSQRT=function(e){var t,n;return m(k(e),O(e))?f:(t="i"===(t=e.substring(e.length-1))||"j"===t?t:"i",n=Math.sqrt(At(e)),e=Lt(e),S(n*Math.cos(e/2),n*Math.sin(e/2),t))},e.IMSUB=function(e,t){var n=k(e),o=O(e),r=k(t),i=O(t);if(m(n,o,r,i))return f;e=e.substring(e.length-1),t=t.substring(t.length-1);let l="j"!==e&&"j"!==t?"i":"j";return S(n-r,o-i,l)},e.IMSUM=function(){if(!arguments.length)return f;var t=d(arguments);let n=t[0];for(let e=1;e<t.length;e++){var o=k(n),r=O(n),i=k(t[e]),l=O(t[e]);if(m(o,r,i,l))return f;n=S(o+i,r+l)}return n},e.IMTAN=function(e){return!0===e||!1===e||m(k(e),O(e))?f:Nt(Tt(e),Mt(e))},e.INDEX=function(e,t,n){var o=g(e,t,n);return o||(!Array.isArray(e)||(t=(o=0<e.length&&!Array.isArray(e[0]))&&!n?(n=t,1):(n=n||1,t||1),n<0)||t<0?f:o&&1===t&&n<=e.length?e[n-1]:t<=e.length&&n<=e[t-1].length?e[t-1][n-1]:V)},e.INFO=function(){throw new Error("INFO is not implemented")},e.INT=function(e){return(e=j(e))instanceof Error?e:Math.floor(e)},e.INTERCEPT=function(e,t){return m(e=v(e),t=v(t))?f:e.length!==t.length?h:Ee(0,e,t)},e.INTRATE=function(){throw new Error("INTRATE is not implemented")},e.IPMT=Yn,e.IRR=function(t,e){if(e=e||0,m(t=v(d(t)),e=j(e)))return f;var n=[];let o=!1,r=!1;for(let e=0;e<t.length;e++)n[e]=0===e?0:n[e-1]+365,0<t[e]&&(o=!0),t[e]<0&&(r=!0);if(!o||!r)return u;let i,l,s,a=e=void 0===e?.1:e;for(;s=((t,n,e)=>{var o=e+1;let r=t[0];for(let e=1;e<t.length;e++)r+=t[e]/Math.pow(o,(n[e]-n[0])/365);return r})(t,n,a),i=a-s/((t,n,e)=>{var o=e+1;let r=0;for(let e=1;e<t.length;e++){var i=(n[e]-n[0])/365;r-=i*t[e]/Math.pow(o,1+i)}return r})(t,n,a),l=Math.abs(i-a),a=i,1e-10<l&&1e-10<Math.abs(s););return a},e.ISBLANK=function(e){return null===e},e.ISERR=se,e.ISERROR=ae,e.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},e.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},e.ISLOGICAL=ce,e.ISNA=function(e){return e===h},e.ISNONTEXT=function(e){return"string"!=typeof e},e.ISNUMBER=ue,e.ISO=Ke,e.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},e.ISOWEEKNUM=at,e.ISPMT=function(e,t,n,o){return m(e=j(e),t=j(t),n=j(n),o=j(o))?f:o*e*(t/n-1)},e.ISREF=function(){throw new Error("ISREF is not implemented")},e.ISTEXT=de,e.KURT=function(){var t=v(d(arguments));if(t instanceof Error)return t;var n=c.mean(t),o=t.length;let r=0;for(let e=0;e<o;e++)r+=Math.pow(t[e]-n,4);return o*(o+1)/((o-1)*(o-2)*(o-3))*(r/=Math.pow(c.stdev(t,!0),4))-3*(o-1)*(o-1)/((o-2)*(o-3))},e.LARGE=Ie,e.LCM=function(){var e=v(d(arguments));if(e instanceof Error)return e;for(var t,n,o,r,i=1;void 0!==(o=e.pop());){if(0===o)return 0;for(;1<o;){if(o%2){for(t=3,n=Math.floor(Math.sqrt(o));t<=n&&o%t;t+=2);r=t<=n?t:o}else r=2;for(o/=r,i*=r,t=e.length;t;e[--t]%r==0&&1==(e[t]/=r)&&e.splice(t,1));}}return i},e.LEFT=function(e,t){return g(e,t)||(e=i(e),(t=j(t=void 0===t?1:t))instanceof Error||"string"!=typeof e?f:e.substring(0,t))},e.LEN=function(e){return 0===arguments.length?q:e instanceof Error?e:Array.isArray(e)?f:i(e).length},e.LINEST=Ne,e.LN=function(e){return(e=j(e))instanceof Error?e:0===e?u:Math.log(e)},e.LOG=function(e,t){return g(e=j(e),t=j(t))||(0===e||0===t?u:Math.log(e)/Math.log(t))},e.LOG10=function(e){return(e=j(e))instanceof Error?e:0===e?u:Math.log(e)/Math.log(10)},e.LOGEST=function(t,e){if(m(t=v(d(t)),e=v(d(e))))return f;if(t.length!==e.length)return f;for(let e=0;e<t.length;e++)t[e]=Math.log(t[e]);e=Ne(t,e);return e[0]=Math.round(1e6*Math.exp(e[0]))/1e6,e[1]=Math.round(1e6*Math.exp(e[1]))/1e6,e},e.LOGINV=sn,e.LOGNORM=Te,e.LOGNORMDIST=an,e.LOGNORMINV=cn,e.LOOKUP=function(t,n,o){n=d(n),o=o?d(o):n;var r="number"==typeof t;let i=h;for(let e=0;e<n.length;e++){if(n[e]===t)return o[e];if(r&&n[e]<=t||"string"==typeof n[e]&&n[e].localeCompare(t)<0)i=o[e];else if(r&&n[e]>t)return i}return i},e.LOWER=function(e){return 1!==arguments.length?f:m(e=i(e))?e:e.toLowerCase()},e.MATCH=function(t,n,o){if(!t||!n)return h;if(2===arguments.length&&(o=1),!((n=d(n))instanceof Array))return h;if(-1!==o&&0!==o&&1!==o)return h;let r,i;for(let e=0;e<n.length;e++)if(1===o){if(n[e]===t)return e+1;n[e]<t&&(!i||n[e]>i)&&(r=e+1,i=n[e])}else if(0===o){if("string"==typeof t&&"string"==typeof n[e]){const o=t.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+o+"$").test(n[e].toLowerCase()))return e+1}else if(n[e]===t)return e+1}else if(-1===o){if(n[e]===t)return e+1;n[e]>t&&(!i||n[e]<i)&&(r=e+1,i=n[e])}return r||h},e.MAX=De,e.MAXA=function(){var e=d(arguments),t=g.apply(void 0,e);if(t)return t;let n=z(e);return 0===(n=n.map(e=>null==e?0:e)).length?0:Math.max.apply(Math,n)},e.MDURATION=function(){throw new Error("MDURATION is not implemented")},e.MEDIAN=Se,e.MID=function(e,t,n){return null==t?f:m(t=j(t),n=j(n))||"string"!=typeof e?n:e.substring(e=t-1,e+n)},e.MIN=Oe,e.MINA=function(){var e=d(arguments),t=g.apply(void 0,e);if(t)return t;let n=z(e);return 0===(n=n.map(e=>null==e?0:e)).length?0:Math.min.apply(Math,n)},e.MINUTE=function(e){return(e=b(e))instanceof Error?e:e.getMinutes()},e.MIRR=function(t,e,n){if(m(t=v(d(t)),e=j(e),n=j(n)))return f;var o=t.length,r=[],i=[];for(let e=0;e<o;e++)(t[e]<0?r:i).push(t[e]);n=-Un(n,i)*Math.pow(1+n,o-1),e=Un(e,r)*(1+e);return Math.pow(n/e,1/(o-1))-1},e.MMULT=function(n,r){return!Array.isArray(n)||!Array.isArray(r)||n.some(e=>!e.length)||r.some(e=>!e.length)||X(n).some(e=>"number"!=typeof e)||X(r).some(e=>"number"!=typeof e)||n[0].length!==r.length?f:Array(n.length).fill(0).map(()=>Array(r[0].length).fill(0)).map((e,t)=>e.map((e,o)=>n[t].reduce((e,t,n)=>e+t*r[n][o],0)))},e.MOD=function(e,t){var n=g(e=j(e),t=j(t));return n||(0===t?s:(n=Math.abs(e%t),n=e<0?t-n:n,0<t?n:-n))},e.MODE=ke,e.MODEMULT=un,e.MODESNGL=dn,e.MONTH=function(e){return(e=b(e))instanceof Error?e:e.getMonth()+1},e.MROUND=function(e,t){return g(e=j(e),t=j(t))||(e*t==0?0:e*t<0?u:Math.round(e/t)*t)},e.MULTINOMIAL=function(){var t=v(d(arguments));if(t instanceof Error)return t;let n=0,o=1;for(let e=0;e<t.length;e++)n+=t[e],o*=I(t[e]);return I(n)/o},e.MUNIT=function(e){return 1<arguments.length?h:!(e=parseInt(e))||e<=0?f:Array(e).fill(0).map(()=>Array(e).fill(0)).map((e,t)=>(e[t]=1,e))},e.N=function(e){return ue(e)?e:e instanceof Date?e.getTime():!0===e?1:!1!==e&&ae(e)?e:0},e.NA=function(){return h},e.NEGBINOM=Re,e.NEGBINOMDIST=pn,e.NETWORKDAYS=ct,e.NETWORKDAYSINTL=fn,e.NOMINAL=function(e,t){return m(e=j(e),t=j(t))?f:e<=0||t<1?u:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},e.NORM=r,e.NORMDIST=hn,e.NORMINV=gn,e.NORMSDIST=mn,e.NORMSINV=bn,e.NOT=function(e){return"string"==typeof e?f:e instanceof Error?e:!e},e.NOW=function(){return new Date},e.NPER=function(e,t,n,o,r){return r=void 0===r?0:r,o=void 0===o?0:o,m(e=j(e),t=j(t),n=j(n),o=j(o),r=j(r))?f:0===e?-(n+o)/t:Math.log((t*(1+e*r)-o*e)/(n*e+t*(1+e*r)))/Math.log(1+e)},e.NPV=Un,e.NUMBERVALUE=function(e,t,n){return"number"==typeof(e=ee(e)?e:"")?e:"string"!=typeof e?h:(t=void 0===t?".":t,n=void 0===n?",":n,Number(e.replace(t,".").replace(n,"")))},e.OCT2BIN=function(e,t){var n;return!/^[0-7]{1,10}$/.test(e)||(e=(n=!(10!==e.length||"7"!==e.substring(0,1)))?parseInt(e,8)-1073741824:parseInt(e,8))<-512||511<e?u:n?"1"+D("0",9-(512+e).toString(2).length)+(512+e).toString(2):(n=e.toString(2),void 0===t?n:isNaN(t)?f:!(t<0)&&(t=Math.floor(t))>=n.length?D("0",t-n.length)+n:u)},e.OCT2DEC=function(e){return/^[0-7]{1,10}$/.test(e)?536870912<=(e=parseInt(e,8))?e-1073741824:e:u},e.OCT2HEX=function(e,t){return/^[0-7]{1,10}$/.test(e)?536870912<=(e=parseInt(e,8))?"ff"+(e+3221225472).toString(16):(e=e.toString(16),void 0===t?e:isNaN(t)?f:!(t<0)&&(t=Math.floor(t))>=e.length?D("0",t-e.length)+e:u):u},e.ODD=function(e){var t;return(e=j(e))instanceof Error?e:(t=1&(t=Math.ceil(Math.abs(e)))?t:t+1,0<=e?t:-t)},e.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},e.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},e.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},e.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},e.OR=function(){var t=d(arguments);let n=f;for(let e=0;e<t.length;e++){if(t[e]instanceof Error)return t[e];void 0!==t[e]&&null!==t[e]&&"string"!=typeof t[e]&&(n===f&&(n=!1),t[e])&&(n=!0)}return n},e.PDURATION=function(e,t,n){return m(e=j(e),t=j(t),n=j(n))?f:e<=0?u:(Math.log(n)-Math.log(t))/Math.log(1+e)},e.PEARSON=Fe,e.PERCENTILE=E,e.PERCENTILEEXC=jn,e.PERCENTILEINC=vn,e.PERCENTRANK=He,e.PERCENTRANKEXC=yn,e.PERCENTRANKINC=xn,e.PERMUT=function(e,t){return m(e=j(e),t=j(t))?f:I(e)/I(e-t)},e.PERMUTATIONA=function(e,t){return m(e=j(e),t=j(t))?f:Math.pow(e,t)},e.PHI=function(e){return(e=j(e))instanceof Error?f:Math.exp(-.5*e*e)/2.5066282746310002},e.PI=function(){return Math.PI},e.PMT=zn,e.POISSON=Be,e.POISSONDIST=wn,e.POWER=Je,e.PPMT=function(e,t,n,o,r,i){return r=r||0,i=i||0,m(e=j(e),n=j(n),o=j(o),r=j(r),i=j(i))?f:zn(e,n,o,r,i)-Yn(e,t,n,o,r,i)},e.PRICE=function(){throw new Error("PRICE is not implemented")},e.PRICEDISC=function(e,t,n,o,r){if(m(e=b(e),t=b(t),n=j(n),o=j(o),r=j(r)||0))return f;if(n<=0||o<=0)return u;if(t<=e)return f;let i,l;switch(r){case 0:i=360,l=T(e,t,!1);break;case 1:case 3:i=365,l=it(e,t,"D");break;case 2:i=360,l=it(e,t,"D");break;case 4:i=360,l=T(e,t,!0);break;default:return u}return o-n*o*l/i},e.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},e.PROB=function(t,n,o,r){if(void 0===o)return 0;if(r=void 0===r?o:r,m(t=v(d(t)),n=v(d(n)),o=j(o),r=j(r)))return f;if(o===r)return 0<=t.indexOf(o)?n[t.indexOf(o)]:0;var i=t.sort((e,t)=>e-t),l=i.length;let s=0;for(let e=0;e<l;e++)i[e]>=o&&i[e]<=r&&(s+=n[t.indexOf(i[e])]);return s},e.PRODUCT=Ze,e.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},e.PROPER=function(e){return m(e)?e:isNaN(e)&&"number"==typeof e?f:(e=i(e)).replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())},e.PV=function(e,t,n,o,r){return o=o||0,r=r||0,m(e=j(e),t=j(t),n=j(n),o=j(o),r=j(r))?f:0===e?-n*t-o:((1-Math.pow(1+e,t))/e*n*(1+e*r)-o)/Math.pow(1+e,t)},e.QUARTILE=Pe,e.QUARTILEEXC=Cn,e.QUARTILEINC=En,e.QUOTIENT=function(e,t){return g(e=j(e),t=j(t))||parseInt(e/t,10)},e.RADIANS=function(e){return(e=j(e))instanceof Error?e:e*Math.PI/180},e.RAND=function(){return Math.random()},e.RANDBETWEEN=function(e,t){return g(e=j(e),t=j(t))||e+Math.ceil((t-e+1)*Math.random())-1},e.RANK=Ve,e.RANKAVG=An,e.RANKEQ=Ln,e.RATE=function(o,r,i,l,s,e){if(e=void 0===e?.01:e,l=void 0===l?0:l,s=void 0===s?0:s,m(o=j(o),r=j(r),i=j(i),l=j(l),s=j(s),e=j(e)))return f;let a=e;s=s?1:0;for(let e=0;e<20;e++){if(a<=-1)return u;let e,t,n;if(e=Math.abs(a)<1e-10?i*(1+o*a)+r*(1+a*s)*o+l:i*(t=Math.pow(1+a,o))+r*(1/a+s)*(t-1)+l,Math.abs(e)<1e-10)return a;if(Math.abs(a)<1e-10)n=i*o+r*s*o;else{t=Math.pow(1+a,o);const l=o*Math.pow(1+a,o-1);n=i*l+r*(1/a+s)*l+r*(-1/(a*a))*(t-1)}a-=e/n}return a},e.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},e.REPLACE=function(e,t,n,o){return m(t=j(t),n=j(n))||"string"!=typeof e||"string"!=typeof o?f:e.substr(0,t-1)+o+e.substr(t-1+n)},e.REPT=D,e.RIGHT=function(e,t){return g(e,t)||(e=i(e),(t=j(t=void 0===t?1:t))instanceof Error?t:e.substring(e.length-t))},e.ROMAN=function(e){if((e=j(e))instanceof Error)return e;var t=String(e).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let o="",r=3;for(;r--;)o=(n[+t.pop()+10*r]||"")+o;return new Array(+t.join("")+1).join("M")+o},e.ROUND=N,e.ROUNDDOWN=function(e,t){return g(e=j(e),t=j(t))||(0<e?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},e.ROUNDUP=function(e,t){return g(e=j(e),t=j(t))||(0<e?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},e.ROW=function(e,t){return 2!==arguments.length?h:t<0?u:e instanceof Array&&"number"==typeof t?0!==e.length?c.row(e,t):void 0:f},e.ROWS=function(e){return 1!==arguments.length?h:e instanceof Array?0===e.length?0:c.rows(e):f},e.RRI=function(e,t,n){return m(e=j(e),t=j(t),n=j(n))?f:0===e||0===t?u:Math.pow(n/t,1/e)-1},e.RSQ=function(e,t){return m(e=v(d(e)),t=v(d(t)))?f:Math.pow(Fe(e,t),2)},e.SEARCH=function(e,t,n){return"string"!=typeof e||"string"!=typeof t||(n=void 0===n?0:n,0===(t=t.toLowerCase().indexOf(e.toLowerCase(),n-1)+1))?f:t},e.SEC=function(e){return(e=j(e))instanceof Error?e:1/Math.cos(e)},e.SECH=function(e){return(e=j(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},e.SECOND=function(e){return(e=b(e))instanceof Error?e:e.getSeconds()},e.SERIESSUM=function(t,n,o,r){if(m(t=j(t),n=j(n),o=j(o),r=v(r)))return f;let i=r[0]*Math.pow(t,n);for(let e=1;e<r.length;e++)i+=r[e]*Math.pow(t,n+e*o);return i},e.SHEET=function(){throw new Error("SHEET is not implemented")},e.SHEETS=function(){throw new Error("SHEETS is not implemented")},e.SIGN=function(e){return(e=j(e))instanceof Error?e:e<0?-1:0===e?0:1},e.SIN=function(e){return(e=j(e))instanceof Error?e:Math.sin(e)},e.SINH=function(e){return(e=j(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},e.SKEW=_e,e.SKEWP=Mn,e.SLN=function(e,t,n){return m(e=j(e),t=j(t),n=j(n))?f:0===n?u:(e-t)/n},e.SLOPE=function(t,n){if(m(t=v(d(t)),n=v(d(n))))return f;var o=c.mean(n),r=c.mean(t),i=n.length;let l=0,s=0;for(let e=0;e<i;e++)l+=(n[e]-o)*(t[e]-r),s+=Math.pow(n[e]-o,2);return l/s},e.SMALL=qe,e.SORT=function(e,n=1,o=1,t=!1){var r;return e&&Array.isArray(e)?0===e.length?0:!(n=j(n))||n<1||1!==(o=j(o))&&-1!==o?f:"boolean"!=typeof(t=J(t))?_:(r=e=>e.sort((e,t)=>(e=i(e[n-1]),t=i(t[n-1]),1===o?e<t?-1*o:o:t<e?o:-1*o)),e=W(e),e=t?G(e):e,1<=n&&n<=e[0].length?t?G(r(e)):r(e):f):h},e.SQRT=function(e){return(e=j(e))instanceof Error?e:e<0?u:Math.sqrt(e)},e.SQRTPI=function(e){return(e=j(e))instanceof Error?e:Math.sqrt(e*Math.PI)},e.STANDARDIZE=function(e,t,n){return m(e=j(e),t=j(t),n=j(n))?f:(e-t)/n},e.STDEV=A,e.STDEVA=function(){var e=Ye.apply(this,arguments);return Math.sqrt(e)},e.STDEVP=In,e.STDEVPA=function(){var e=Ue.apply(this,arguments);let t=Math.sqrt(e);return t=isNaN(t)?u:t},e.STDEVS=Nn,e.STEYX=function(t,n){if(m(t=v(d(t)),n=v(d(n))))return f;var o=c.mean(n),r=c.mean(t),i=n.length;let l=0,s=0,a=0;for(let e=0;e<i;e++)l+=Math.pow(t[e]-r,2),s+=(n[e]-o)*(t[e]-r),a+=Math.pow(n[e]-o,2);return Math.sqrt((l-s*s/a)/(i-2))},e.SUBSTITUTE=function(n,o,r,i){if(arguments.length<3)return h;if(n&&o){if(void 0===i)return n.split(o).join(r);{if(i=Math.floor(Number(i)),Number.isNaN(i)||i<=0)return f;let e=0,t=0;for(;-1<e&&-1<n.indexOf(o,e);)if(e=n.indexOf(o,e+1),t++,-1<e&&t===i)return n.substring(0,e)+r+n.substring(e+o.length)}}return n},e.SUBTOTAL=function(e,t){if((e=j(e))instanceof Error)return e;switch(e){case 1:case 101:return he(t);case 2:case 102:return ve(t);case 3:case 103:return ye(t);case 4:case 104:return De(t);case 5:case 105:return Oe(t);case 6:case 106:return Ze(t);case 7:case 107:return A.S(t);case 8:case 108:return A.P(t);case 9:case 109:return Qe(t);case 10:case 110:return M.S(t);case 11:case 111:return M.P(t)}},e.SUM=Qe,e.SUMIF=function(t,e,n){if(t=d(t),n=n?d(n):t,t instanceof Error)return t;if(null==e||e instanceof Error)return 0;let o=0;var r="*"===e,i=r?null:w(e+"");for(let e=0;e<t.length;e++){var l=t[e],s=n[e];if(r)o+=l;else{const t=[x(l,y)].concat(i);o+=C(t)?s:0}}return o},e.SUMIFS=function(){const r=U(arguments),i=v(d(r.shift()));if(i instanceof Error)return i;const l=r,s=l.length/2;for(let e=0;e<s;e++)l[2*e]=d(l[2*e]);let a=0;for(let o=0;o<i.length;o++){let n=!1;for(let t=0;t<s;t++){const s=l[2*t][o],a=l[2*t+1];let e=!1;if(void 0===a||"*"===a)e=!0;else{const r=w(a+""),i=[x(s,y)].concat(r);e=C(i)}if(!e){n=!1;break}n=!0}n&&(a+=i[o])}return a},e.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return f;const n=arguments.length+1;let o,r,e,i,l=0;for(let t=0;t<arguments[0].length;t++)if(arguments[0][t]instanceof Array)for(let e=0;e<arguments[0][t].length;e++){for(o=1,r=1;r<n;r++){const n=arguments[r-1][t][e];if(n instanceof Error)return n;if((i=j(n))instanceof Error)return i;o*=i}l+=o}else{for(o=1,r=1;r<n;r++){const n=arguments[r-1][t];if(n instanceof Error)return n;if((e=j(n))instanceof Error)return e;o*=e}l+=o}return l},e.SUMSQ=function(){var t=v(d(arguments));if(t instanceof Error)return t;let n=0;var o=t.length;for(let e=0;e<o;e++)n+=ue(t[e])?t[e]*t[e]:0;return n},e.SUMX2MY2=function(t,n){if(m(t=v(d(t)),n=v(d(n))))return f;let o=0;for(let e=0;e<t.length;e++)o+=t[e]*t[e]-n[e]*n[e];return o},e.SUMX2PY2=function(t,n){if(m(t=v(d(t)),n=v(d(n))))return f;let o=0;t=v(d(t)),n=v(d(n));for(let e=0;e<t.length;e++)o+=t[e]*t[e]+n[e]*n[e];return o},e.SUMXMY2=function(t,n){if(m(t=v(d(t)),n=v(d(n))))return f;let o=0;t=d(t),n=d(n);for(let e=0;e<t.length;e++)o+=Math.pow(t[e]-n[e],2);return o},e.SWITCH=function(){let n;if(0<arguments.length){var o=arguments[0],e=arguments.length-1,r=Math.floor(e/2);let t=!1;var i=e%2!=0,e=e%2==0?null:arguments[arguments.length-1];if(r)for(let e=0;e<r;e++)if(o===arguments[2*e+1]){n=arguments[2*e+2],t=!0;break}t||(n=i?e:h)}else n=f;return n},e.SYD=function(e,t,n,o){return m(e=j(e),t=j(t),n=j(n),o=j(o))?f:0===n||o<1||n<o?u:(e-t)*(n-(o=parseInt(o,10))+1)*2/(n*(n+1))},e.T=function(e){return e instanceof Error||"string"==typeof e?e:""},e.TAN=function(e){return(e=j(e))instanceof Error?e:Math.tan(e)},e.TANH=function(e){return(e=j(e))instanceof Error?e:((e=Math.exp(2*e))-1)/(e+1)},e.TBILLEQ=function(e,t,n){return m(e=b(e),t=b(t),n=j(n))?f:n<=0||t<e||31536e6<t-e?u:365*n/(360-n*T(e,t,!1))},e.TBILLPRICE=function(e,t,n){return m(e=b(e),t=b(t),n=j(n))?f:n<=0||t<e||31536e6<t-e?u:100*(1-n*T(e,t,!1)/360)},e.TBILLYIELD=function(e,t,n){return m(e=b(e),t=b(t),n=j(n))?f:n<=0||t<e||31536e6<t-e?u:360*(100-n)/(n*T(e,t,!1))},e.TDIST=Tn,e.TDISTRT=Dn,e.TEXT=function(e,t){var n,o;return void 0===e||e instanceof Error||t instanceof Error?h:null==t?"":"number"==typeof t?String(t):"string"!=typeof t?f:(n=t.startsWith("$")?"$":"",(o=t.endsWith("%"))&&(e*=100),e=(e=vt(e,(t=t.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!t.includes(","))).startsWith("-")?"-"+n+e.replace("-",""):n+e,o&&(e+="%"),e)},e.TEXTJOIN=function(o,e,...t){if("boolean"!=typeof e&&(e=J(e)),arguments.length<3)return h;o=null!=o?o:"";let n=d(t),r=e?n.filter(e=>e):n;if(Array.isArray(o)){o=d(o);let t=r.map(e=>[e]),n=0;for(let e=0;e<t.length-1;e++)t[e].push(o[n]),++n===o.length&&(n=0);return(r=d(t)).join("")}return r.join(o)},e.TIME=function(e,t,n){return m(e=j(e),t=j(t),n=j(n))?f:e<0||t<0||n<0?u:(3600*e+60*t+n)/86400},e.TIMEVALUE=function(e){return(e=b(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},e.TINV=Sn,e.TODAY=function(){return lt(new Date)},e.TRANSPOSE=function(e){return e?G(W(e)):h},e.TREND=function(e,t,n){if(m(e=v(d(e)),t=v(d(t)),n=v(d(n))))return f;const o=Ne(e,t),r=o[0],i=o[1],l=[];return n.forEach(e=>{l.push(r*e+i)}),l},e.TRIM=function(e){return(e=i(e))instanceof Error?e:e.replace(/\s+/g," ").trim()},e.TRIMMEAN=function(e,t){var n;return m(e=v(d(e)),t=j(t))?f:(t=$e(e.length*t,2)/2,c.mean((n=t||1,(e=a(e.sort((e,t)=>e-t),t))&&"function"==typeof e.slice?e.slice(0,e.length-n):e)))},e.TRUE=function(){return!0},e.TRUNC=function(e,t){return g(e=j(e),t=j(t))||(0<e?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},e.TTEST=On,e.TYPE=function(e){return ue(e)?1:de(e)?2:ce(e)?4:ae(e)?16:Array.isArray(e)?64:void 0},e.UNICHAR=yt,e.UNICODE=xt,e.UNIQUE=pe,e.UPPER=function(e){return(e=i(e))instanceof Error?e:e.toUpperCase()},e.VALUE=function(e){var t=g(e);if(t)return t;if("number"==typeof e)return e;if("string"!=typeof(e=ee(e)?e:""))return f;t=/(%)$/.test(e)||/^(%)/.test(e);if(""===(e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,"")))return 0;let n=Number(e);return isNaN(n)?f:(n=n||0,t&&(n*=.01),n)},e.VAR=M,e.VARA=Ye,e.VARP=kn,e.VARPA=Ue,e.VARS=Rn,e.VDB=function(){throw new Error("VDB is not implemented")},e.VLOOKUP=fe,e.WEEKDAY=function(e,t){if((e=b(e))instanceof Error)return e;void 0===t&&(t=1);e=e.getDay();return ot[t][e]},e.WEEKNUM=function(e,t){if((e=b(e))instanceof Error)return e;if(21===(t=void 0===t?1:t))return at(e);t=nt[t];let n=new Date(e.getFullYear(),0,1);var o=n.getDay()<t?1:0;return n-=24*Math.abs(n.getDay()-t)*60*60*1e3,Math.floor((e-n)/864e5/7+1)+o},e.WEIBULL=ze,e.WEIBULLDIST=Fn,e.WORKDAY=ut,e.WORKDAYINTL=Hn,e.XIRR=function(t,e,n){if(m(t=v(d(t)),e=Z(d(e)),n=j(n)))return f;let o=!1,r=!1;for(let e=0;e<t.length;e++)0<t[e]&&(o=!0),t[e]<0&&(r=!0);if(!o||!r)return u;let i,l,s,a=n=n||.1;for(;s=((t,n,e)=>{var o=e+1;let r=t[0];for(let e=1;e<t.length;e++)r+=t[e]/Math.pow(o,st(n[e],n[0])/365);return r})(t,e,a),i=a-s/((t,n,e)=>{var o=e+1;let r=0;for(let e=1;e<t.length;e++){var i=st(n[e],n[0])/365;r-=i*t[e]/Math.pow(o,1+i)}return r})(t,e,a),l=Math.abs(i-a),a=i,1e-10<l&&1e-10<Math.abs(s););return a},e.XNPV=function(t,n,o){if(m(t=j(t),n=v(d(n)),o=Z(d(o))))return f;let r=0;for(let e=0;e<n.length;e++)r+=n[e]/Math.pow(1+t,st(o[e],o[0])/365);return r},e.XOR=function(){var t=d(arguments);let n=f;for(let e=0;e<t.length;e++){if(t[e]instanceof Error)return t[e];void 0!==t[e]&&null!==t[e]&&"string"!=typeof t[e]&&(n===f&&(n=0),t[e])&&n++}return n===f?n:!!(1&Math.floor(Math.abs(n)))},e.YEAR=function(e){return(e=b(e))instanceof Error?e:e.getFullYear()},e.YEARFRAC=ft,e.YIELD=function(){throw new Error("YIELD is not implemented")},e.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},e.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},e.Z=We,e.ZTEST=Bn,e.utils=H}},o={},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r(960))},138:function(module,__unused_webpack_exports,__webpack_require__){var formula,formula=formula||__webpack_require__(243),factory,factory=function(){"use strict";var Version=(info={title:"Jspreadsheet",version:"4.13.2",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join("\r\n")}},function(){return info}),info,isFormula=function(e){e=(""+e)[0];return"="==e||"#"==e},getMask=function(e){var t;return e.format||e.mask||e.locale?(t={},e.mask?t.mask=e.mask:e.format?t.mask=e.format:(t.locale=e.locale,t.options=e.options),e.decimal&&(t.options||(t.options={}),t.options={decimal:e.decimal}),t):null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if("TABLE"==el.tagName){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0},property;for(property in defaults)if(options&&options.hasOwnProperty(property))if("text"===property)for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,1==obj.options.lazyLoading&&0==obj.options.tableOverflow&&0==obj.options.fullscreen&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(e){null==e&&(e=!obj.options.fullscreen),obj.options.fullscreen!=e&&(1==(obj.options.fullscreen=e)?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(e){var t,n;return obj.ignoreEvents||("function"==typeof obj.options.onevent&&(t=obj.options.onevent.apply(this,arguments)),"function"==typeof obj.options[e]&&(t=obj.options[e].apply(this,Array.prototype.slice.call(arguments,1)))),"onafterchanges"==e&&obj.options.persistance&&(e=1==obj.options.persistance?obj.options.url:obj.options.persistance,n=obj.prepareJson(arguments[2]),obj.save(e,n)),t},obj.prepareTable=function(){var e,t=obj.options.columns.length;obj.options.data&&void 0!==obj.options.data[0]&&(e=Object.keys(obj.options.data[0])).length>t&&(t=e.length),obj.options.minDimensions[0]>t&&(t=obj.options.minDimensions[0]);for(var n=[],o=0;o<t;o++)obj.options.colHeaders[o]||(obj.options.colHeaders[o]=""),obj.options.colWidths[o]||(obj.options.colWidths[o]=obj.options.defaultColWidth),obj.options.colAlignments[o]||(obj.options.colAlignments[o]=obj.options.defaultColAlign),obj.options.columns[o]?obj.options.columns[o].type||(obj.options.columns[o].type="text"):obj.options.columns[o]={type:"text"},obj.options.columns[o].name||(obj.options.columns[o].name=e&&e[o]?e[o]:o),obj.options.columns[o].source||(obj.options.columns[o].source=[]),obj.options.columns[o].options||(obj.options.columns[o].options=[]),obj.options.columns[o].editor||(obj.options.columns[o].editor=null),obj.options.columns[o].allowEmpty||(obj.options.columns[o].allowEmpty=!1),obj.options.columns[o].title||(obj.options.columns[o].title=obj.options.colHeaders[o]||""),obj.options.columns[o].width||(obj.options.columns[o].width=obj.options.colWidths[o]||obj.options.defaultColWidth),obj.options.columns[o].align||(obj.options.columns[o].align=obj.options.colAlignments[o]||"center"),"autocomplete"==obj.options.columns[o].type||"dropdown"==obj.options.columns[o].type?obj.options.columns[o].url&&n.push({url:obj.options.columns[o].url,index:o,method:"GET",dataType:"json",success:function(e){for(var t=0;t<e.length;t++)obj.options.columns[this.index].source.push(e[t])}}):"calendar"!=obj.options.columns[o].type||obj.options.columns[o].options.format||(obj.options.columns[o].options.format="DD/MM/YYYY");n.length?jSuites.ajax(n,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(e){obj.scrollControls(e)},obj.content.onwheel=function(e){obj.wheelControls(e)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var e=document.createElement("div"),t=document.createTextNode(obj.options.text.search+": "),t=(obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),e.appendChild(t),e.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()},document.createElement("div"));if(0<obj.options.pagination&&obj.options.paginationOptions&&0<obj.options.paginationOptions.length){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var n=0;n<obj.options.paginationOptions.length;n++){var o=document.createElement("option");o.value=obj.options.paginationOptions[n],o.innerHTML=obj.options.paginationOptions[n],obj.paginationDropdown.appendChild(o)}obj.paginationDropdown.value=obj.options.pagination,t.appendChild(document.createTextNode(obj.options.text.show)),t.appendChild(obj.paginationDropdown),t.appendChild(document.createTextNode(obj.options.text.entries))}var r=document.createElement("div");if(r.classList.add("jexcel_filter"),r.appendChild(t),r.appendChild(e),obj.colgroupContainer=document.createElement("colgroup"),(t=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(t),obj.options.nestedHeaders&&0<obj.options.nestedHeaders.length)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var i=0;i<obj.options.nestedHeaders.length;i++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[i]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(t=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(t),n=0;n<obj.options.columns.length;n++)obj.createCellHeader(n),obj.headerContainer.appendChild(obj.headers[n]),obj.colgroupContainer.appendChild(obj.colgroup[n]);if(obj.thead.appendChild(obj.headerContainer),1==obj.options.filters){obj.filter=document.createElement("tr");var l=document.createElement("td");for(obj.filter.appendChild(l),n=0;n<obj.options.columns.length;n++)(l=document.createElement("td")).innerHTML="&nbsp;",l.setAttribute("data-x",n),l.className="jexcel_column_filter","hidden"==obj.options.columns[n].type&&(l.style.display="none"),obj.filter.appendChild(l);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),0==obj.options.selectionCopy&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});t=document.createElement("a");t.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";try{"undefined"==typeof sessionStorage||sessionStorage.getItem("jexcel")||(sessionStorage.setItem("jexcel",!0),(s=document.createElement("img")).src="//bossanova.uk/jspreadsheet/logo.png",t.appendChild(s))}catch(e){}var s=document.createElement("span"),s=(s.innerHTML="Jspreadsheet CE",t.appendChild(s),obj.ads.appendChild(t),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination"),document.createElement("div")),t=document.createElement("div");if(obj.pagination.appendChild(s),obj.pagination.appendChild(t),obj.options.pagination||(obj.pagination.style.display="none"),1==obj.options.search&&el.appendChild(r),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),1==obj.options.fullscreen?el.classList.add("fullscreen"):1==obj.options.tableOverflow&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth)&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth),1!=obj.options.tableOverflow&&obj.options.toolbar&&el.classList.add("with-toolbar"),1==obj.options.columnDrag&&obj.thead.classList.add("draggable"),1==obj.options.columnResize&&obj.thead.classList.add("resizable"),1==obj.options.rowDrag&&obj.tbody.classList.add("draggable"),1==obj.options.rowResize&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes)for(var a=Object.keys(obj.options.classes),n=0;n<a.length;n++){var c=jexcel.getIdFromColumnName(a[n],!0);obj.records[c[1]][c[0]].classList.add(obj.options.classes[a[n]])}},obj.refresh=function(){obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data||e,obj.setData(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(e){if(e&&("string"==typeof e&&(e=JSON.parse(e)),obj.options.data=e),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){e=[];for(var t=0;t<obj.options.data.length;t++){for(var n=[],o=0;o<obj.options.columns.length;o++)n[o]=obj.options.data[t][obj.options.columns[o].name];e.push(n)}obj.options.data=e}for(var r,i,l=obj.options.columns.length,s=obj.options.data.length,a=obj.options.minDimensions[o=t=0],c=obj.options.minDimensions[1],u=l<a?a:l,d=s<c?c:s,t=0;t<d;t++)for(o=0;o<u;o++)null==obj.options.data[t]&&(obj.options.data[t]=[]),null==obj.options.data[t][o]&&(obj.options.data[t][o]="");for(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",1==obj.options.lazyLoading?(r=0,i=obj.options.data.length<100?obj.options.data.length:100,obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))):obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,r=obj.options.pagination*obj.pageNumber,i=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<i&&(i=obj.options.data.length)):(r=0,i=obj.options.data.length),t=0;t<obj.options.data.length;t++){var p=obj.createRow(t,obj.options.data[t]);r<=t&&t<i&&obj.tbody.appendChild(p)}if(1!=obj.options.lazyLoading&&obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells)for(var f=Object.keys(obj.options.mergeCells),o=0;o<f.length;o++){var h=obj.options.mergeCells[f[o]];obj.setMerge(f[o],h[0],h[1],1)}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(e,t){for(var n=[],o=0,r=0,i=1==t||0==obj.options.copyCompatibility,l=obj.options.columns.length,s=obj.options.data.length,a=0;a<s;a++){for(var o=0,c=0;c<l;c++)e&&!obj.records[a][c].classList.contains("highlight")||(n[r]||(n[r]=[]),n[r][o]=i?obj.options.data[a][c]:obj.records[a][c].innerHTML,o++);0<o&&r++}return n},obj.getJsonRow=function(e){for(var t=obj.options.data[e],n=obj.options.columns.length,o={},r=0;r<n;r++)obj.options.columns[r].name||(obj.options.columns[r].name=r),o[obj.options.columns[r].name]=t[r];return o},obj.getJson=function(e){for(var t=[],n=obj.options.columns.length,o=obj.options.data.length,r=0;r<o;r++){for(var i=null,l=0;l<n;l++)e&&!obj.records[r][l].classList.contains("highlight")||(null==i&&(i={}),obj.options.columns[l].name||(obj.options.columns[l].name=l),i[obj.options.columns[l].name]=obj.options.data[r][l]);null!=i&&t.push(i)}return t},obj.prepareJson=function(e){for(var t=[],n=0;n<e.length;n++){var o=e[n].x,r=e[n].y,o=obj.options.columns[o].name||o;t[r]||(t[r]={row:r,data:{}}),t[r].data[o]=e[n].newValue}return t.filter(function(e){return null!=e})},obj.save=function(e,t){var n=obj.dispatch("onbeforesave",el,obj,t);if(n)t=n;else if(!1===n)return!1;jSuites.ajax({url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(t)},success:function(e){obj.dispatch("onsave",el,obj,t)}})},obj.getRowData=function(e){return obj.options.data[e]},obj.setRowData=function(e,t){for(var n=0;n<obj.headers.length;n++){var o=jexcel.getColumnNameFromId([n,e]);null!=t[n]&&obj.setValue(o,t[n])}},obj.getColumnData=function(e){for(var t=[],n=0;n<obj.options.data.length;n++)t.push(obj.options.data[n][e]);return t},obj.setColumnData=function(e,t){for(var n=0;n<obj.rows.length;n++){var o=jexcel.getColumnNameFromId([e,n]);null!=t[n]&&obj.setValue(o,t[n])}},obj.createRow=function(e,t){obj.records[e]||(obj.records[e]=[]),t=t||obj.options.data[e],obj.rows[e]=document.createElement("tr"),obj.rows[e].setAttribute("data-y",e);var n=null,o=(obj.options.defaultRowHeight&&(obj.rows[e].style.height=obj.options.defaultRowHeight+"px"),n=(n=obj.options.rows[e]&&(obj.options.rows[e].height&&(obj.rows[e].style.height=obj.options.rows[e].height),obj.options.rows[e].title)?obj.options.rows[e].title:n)||parseInt(e+1),document.createElement("td"));o.innerHTML=n,o.setAttribute("data-y",e),o.className="jexcel_row",obj.rows[e].appendChild(o);for(var r=0;r<obj.options.columns.length;r++)obj.records[e][r]=obj.createCell(r,e,t[r]),obj.rows[e].appendChild(obj.records[e][r]);return obj.rows[e]},obj.parseValue=function(e,t,n,o){"="==(""+n).substr(0,1)&&1==obj.options.parseFormulas&&(n=obj.executeFormula(n,e,t));var t=obj.options.columns[e];return n=t&&!isFormula(n)&&(e=null,e=getMask(t))&&(n&&n==Number(n)&&(n=Number(n)),t=jSuites.mask.render(n,e,!0),t=o&&e.mask&&(e=e.mask.split(";"))[1]&&(e[1].match(new RegExp("\\[Red\\]","gi"))&&(n<0?o.classList.add("red"):o.classList.remove("red")),e[1].match(new RegExp("\\(","gi")))&&n<0?"("+t+")":t)?t:n};var validDate=function(e){return"-"==(e=""+e).substr(4,1)&&"-"==e.substr(7,1)||4==(e=e.split("-"))[0].length&&e[0]==Number(e[0])&&2==e[1].length&&e[1]==Number(e[1])},stripScript=(obj.createCell=function(e,t,n){var o,r=document.createElement("td"),i=(r.setAttribute("data-x",e),r.setAttribute("data-y",t),"="==(""+n).substr(0,1)&&1==obj.options.secureFormulas&&(o=secureFormula(n))!=n&&(n=o),obj.options.columns[e].editor?(!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?r.innerHTML=n:r.textContent=n,"function"==typeof obj.options.columns[e].editor.createCell&&(r=obj.options.columns[e].editor.createCell(r))):"hidden"==obj.options.columns[e].type?(r.style.display="none",r.textContent=n):"checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type?((o=document.createElement("input")).type=obj.options.columns[e].type,o.name="c"+e,o.checked=1==n||"true"==n,o.onclick=function(){obj.setValue(r,this.checked)},1!=obj.options.columns[e].readOnly&&0!=obj.options.editable||o.setAttribute("disabled","disabled"),r.appendChild(o),obj.options.data[t][e]=o.checked):"calendar"==obj.options.columns[e].type?(o=null,validDate(n)||(i=jSuites.calendar.extractDateFromString(n,obj.options.columns[e].options.format))&&(o=i),r.textContent=jSuites.calendar.getDateString(o||n,obj.options.columns[e].options.format)):"dropdown"==obj.options.columns[e].type||"autocomplete"==obj.options.columns[e].type?(r.classList.add("jexcel_dropdown"),r.textContent=obj.getDropDownValue(e,n)):"color"==obj.options.columns[e].type?"square"==obj.options.columns[e].render?((i=document.createElement("div")).className="color",i.style.backgroundColor=n,r.appendChild(i)):(r.style.color=n,r.textContent=n):"image"==obj.options.columns[e].type?n&&"data:image"==n.substr(0,10)&&((o=document.createElement("img")).src=n,r.appendChild(o)):"html"==obj.options.columns[e].type||!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?r.innerHTML=stripScript(obj.parseValue(e,t,n,r)):r.textContent=obj.parseValue(e,t,n,r),1==obj.options.columns[e].readOnly&&(r.className="readonly"),obj.options.columns[e].align||"center");return r.style.textAlign=i,0!=obj.options.columns[e].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[e].wordWrap||200<r.innerHTML.length)&&(r.style.whiteSpace="pre-wrap"),0<e&&1==this.options.textOverflow&&(n||r.innerHTML?obj.records[t][e-1].style.overflow="hidden":e==obj.options.columns.length-1&&(r.style.overflow="hidden")),r},obj.createCellHeader=function(e){var t=obj.options.columns[e].width||obj.options.defaultColWidth,n=obj.options.columns[e].align||obj.options.defaultColAlign;obj.headers[e]=document.createElement("td"),obj.options.stripHTML?obj.headers[e].textContent=obj.options.columns[e].title||jexcel.getColumnName(e):obj.headers[e].innerHTML=obj.options.columns[e].title||jexcel.getColumnName(e),obj.headers[e].setAttribute("data-x",e),obj.headers[e].style.textAlign=n,obj.options.columns[e].title&&obj.headers[e].setAttribute("title",obj.headers[e].innerText),obj.options.columns[e].id&&obj.headers[e].setAttribute("id",obj.options.columns[e].id),obj.colgroup[e]=document.createElement("col"),obj.colgroup[e].setAttribute("width",t),"hidden"==obj.options.columns[e].type&&(obj.headers[e].style.display="none",obj.colgroup[e].style.display="none")},obj.updateNestedHeader=function(e,t,n){obj.options.nestedHeaders[t][e].title&&(obj.options.nestedHeaders[t][e].title=n,obj.options.nestedHeaders[t].element.children[e+1].textContent=n)},obj.createNestedHeader=function(e){var t=document.createElement("tr"),n=(t.classList.add("jexcel_nested"),document.createElement("td"));t.appendChild(n),e.element=t;for(var o=0,r=0;r<e.length;r++){e[r].colspan||(e[r].colspan=1),e[r].align||(e[r].align="center"),e[r].title||(e[r].title=""),e[r].id||(e[r].id="");for(var i=e[r].colspan,l=[],s=0;s<i;s++)obj.options.columns[o]&&"hidden"==obj.options.columns[o].type&&i++,l.push(o),o++;(n=document.createElement("td")).setAttribute("data-column",l.join(",")),n.setAttribute("colspan",e[r].colspan),n.setAttribute("align",e[r].align),n.setAttribute("id",e[r].id),n.textContent=e[r].title,t.appendChild(n)}return t},obj.createToolbar=function(t){t?obj.options.toolbar=t:t=obj.options.toolbar;for(var e,n=0;n<t.length;n++)if("i"==t[n].type)(e=document.createElement("i")).classList.add("jexcel_toolbar_item"),e.classList.add("material-icons"),e.setAttribute("data-k",t[n].k),e.setAttribute("data-v",t[n].v),e.setAttribute("id",t[n].id),t[n].tooltip&&e.setAttribute("title",t[n].tooltip),t[n].onclick&&(t[n].onclick,1)?e.onclick=function(){var e=n;return function(){t[e].onclick(el,obj,this)}}():e.onclick=function(){var e=this.getAttribute("data-k"),t=this.getAttribute("data-v");obj.setStyle(obj.highlighted,e,t)},e.textContent=t[n].content,obj.toolbar.appendChild(e);else if("select"==t[n].type){var o=!1;(e=document.createElement("select")).classList.add("jexcel_toolbar_item"),e.setAttribute("data-k",t[n].k),t[n].tooltip&&e.setAttribute("title",t[n].tooltip),t[n].onchange&&(t[n].onchange,1)?(e.onchange=t[n].onchange,o=!0):e.onchange=function(){var e=this.getAttribute("data-k");obj.setStyle(obj.highlighted,e,this.value)};for(var r=0;r<t[n].v.length;r++){var i=document.createElement("option");i.value=t[n].v[r],i.textContent=t[n].v[r],t[n].selectedValue&&i.value===t[n].selectedValue&&(i.selected=!0),e.appendChild(i)}o&&e.dispatchEvent(new Event("change")),obj.toolbar.appendChild(e)}else"color"==t[n].type&&((e=document.createElement("i")).classList.add("jexcel_toolbar_item"),e.classList.add("material-icons"),e.setAttribute("data-k",t[n].k),e.setAttribute("data-v",""),t[n].tooltip&&e.setAttribute("title",t[n].tooltip),obj.toolbar.appendChild(e),e.textContent=t[n].content,jSuites.color(e,{onchange:function(e,t){e=e.getAttribute("data-k");obj.setStyle(obj.highlighted,e,t)}}))},obj.setMerge=function(e,t,n,o){var r=!1;if(!e){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var i=parseInt(obj.highlighted[0].getAttribute("data-x")),l=parseInt(obj.highlighted[0].getAttribute("data-y")),s=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),a=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));e=jexcel.getColumnNameFromId([i,l]),t=s-i+1,n=a-l+1}var c=jexcel.getIdFromColumnName(e,!0);if(obj.options.mergeCells[e])obj.records[c[1]][c[0]].getAttribute("data-merged")&&(r=obj.options.text.cellAlreadyMerged);else if((!t||t<2)&&(!n||n<2))r=obj.options.text.invalidMergeProperties;else for(var u=c[1];u<c[1]+n;u++)for(var d=c[0];d<c[0]+t;d++)jexcel.getColumnNameFromId([d,u]),obj.records[u][d].getAttribute("data-merged")&&(r=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(r)alert(r);else{1<t?obj.records[c[1]][c[0]].setAttribute("colspan",t):t=1,1<n?obj.records[c[1]][c[0]].setAttribute("rowspan",n):n=1,obj.options.mergeCells[e]=[t,n,[]],obj.records[c[1]][c[0]].setAttribute("data-merged","true"),obj.records[c[1]][c[0]].style.overflow="hidden";for(var p=[],f=c[1];f<c[1]+n;f++)for(var h=c[0];h<c[0]+t;h++)c[0]==h&&c[1]==f||(p.push(obj.options.data[f][h]),obj.updateCell(h,f,"",!0),obj.options.mergeCells[e][2].push(obj.records[f][h]),obj.records[f][h].style.display="none",obj.records[f][h]=obj.records[c[1]][c[0]]);obj.updateSelection(obj.records[c[1]][c[0]]),o||(obj.setHistory({action:"setMerge",column:e,colspan:t,rowspan:n,data:p}),obj.dispatch("onmerge",el,e,t,n))}},obj.getMerge=function(e){var t={};if(e)t=obj.options.mergeCells[e]?[obj.options.mergeCells[e][0],obj.options.mergeCells[e][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var n=Object.keys(obj.options.mergeCells),o=0;o<n.length;o++)t[n[o]]=[obj.options.mergeCells[n[o]][0],obj.options.mergeCells[n[o]][1]]}return t},obj.removeMerge=function(e,t,n){if(obj.options.mergeCells[e]){var o=jexcel.getIdFromColumnName(e,!0);obj.records[o[1]][o[0]].removeAttribute("colspan"),obj.records[o[1]][o[0]].removeAttribute("rowspan"),obj.records[o[1]][o[0]].removeAttribute("data-merged");for(var r=obj.options.mergeCells[e],i=0,l=0;l<r[1];l++)for(var s=0;s<r[0];s++)(0<l||0<s)&&(obj.records[o[1]+l][o[0]+s]=r[2][i],obj.records[o[1]+l][o[0]+s].style.display="",t&&t[i]&&obj.updateCell(o[0]+s,o[1]+l,t[i]),i++);obj.updateSelection(obj.records[o[1]][o[0]],obj.records[o[1]+l-1][o[0]+s-1]),n||delete obj.options.mergeCells[e]}},obj.destroyMerged=function(e){if(obj.options.mergeCells){obj.options.mergeCells;for(var t=Object.keys(obj.options.mergeCells),n=0;n<t.length;n++)obj.removeMerge(t[n],null,e)}},obj.isColMerged=function(e,t){var n=[];if(obj.options.mergeCells)for(var o=Object.keys(obj.options.mergeCells),r=0;r<o.length;r++){var i=jexcel.getIdFromColumnName(o[r],!0),l=obj.options.mergeCells[o[r]][0],s=i[0],i=i[0]+(1<l?l-1:0);null==t?s<=e&&e<=i&&n.push(o[r]):t?s<e&&e<=i&&n.push(o[r]):s<=e&&e<i&&n.push(o[r])}return n},obj.isRowMerged=function(e,t){var n=[];if(obj.options.mergeCells)for(var o=Object.keys(obj.options.mergeCells),r=0;r<o.length;r++){var i=jexcel.getIdFromColumnName(o[r],!0),l=obj.options.mergeCells[o[r]][1],s=i[1],i=i[1]+(1<l?l-1:0);null==t?s<=e&&e<=i&&n.push(o[r]):t?s<e&&e<=i&&n.push(o[r]):s<=e&&e<i&&n.push(o[r])}return n},obj.openFilter=function(t){if(obj.options.filters){t=parseInt(t),obj.resetSelection();var e=[];if("checkbox"==obj.options.columns[t].type)e.push({id:"true",name:"True"}),e.push({id:"false",name:"False"});else{for(var n=[],o=!1,r=0;r<obj.options.data.length;r++){var i=obj.options.data[r][t],l=obj.records[r][t].innerHTML;i&&l?n[i]=l:o=!0}for(var s=Object.keys(n),e=[],r=0;r<s.length;r++)e.push({id:s[r],name:n[s[r]]});o&&e.push({value:"",id:"",name:"(Blanks)"})}var a=document.createElement("div"),c=(obj.filter.children[t+1].innerHTML="",obj.filter.children[t+1].appendChild(a),obj.filter.children[t+1].style.paddingLeft="0px",obj.filter.children[t+1].style.paddingRight="0px",obj.filter.children[t+1].style.overflow="initial",{data:e,multiple:!0,autocomplete:!0,opened:!0,value:void 0!==obj.filters[t]?obj.filters[t]:null,width:"100%",position:1==obj.options.tableOverflow||1==obj.options.fullscreen,onclose:function(e){obj.resetFilters(),obj.filters[t]=e.dropdown.getValue(!0),obj.filter.children[t+1].innerHTML=e.dropdown.getText(),obj.filter.children[t+1].style.paddingLeft="",obj.filter.children[t+1].style.paddingRight="",obj.filter.children[t+1].style.overflow="",obj.closeFilter(t),obj.refreshSelection()}});jSuites.dropdown(a,c)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var e=0;e<obj.filter.children.length;e++)obj.filter.children[e].innerHTML="&nbsp;",obj.filters[e]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(e){if(!e)for(var t=0;t<obj.filter.children.length;t++)obj.filters[t]&&(e=t);var n=obj.filters[e];obj.results=[];for(var o=0;o<obj.options.data.length;o++)!function(e,t,n){for(var o=0;o<e.length;o++){var r=""+obj.options.data[n][t],i=""+obj.records[n][t].innerHTML;if(e[o]==r||e[o]==i)return!0}return!1}(n,e,o)||obj.results.push(o);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(n,e,t){function o(e){var t=n.getBoundingClientRect();return(e=document.createElement(e)).style.width=t.width+"px",e.style.height=t.height-2+"px",e.style.minHeight=t.height-2+"px",n.classList.add("editor"),n.innerHTML="",n.appendChild(e),obj.dispatch("oncreateeditor",el,n,a,s,e),e}var r,i,l,s=n.getAttribute("data-y"),a=n.getAttribute("data-x");obj.dispatch("oneditionstart",el,n,a,s),0<a&&(obj.records[s][a-1].style.overflow="hidden");if(1!=n.classList.contains("readonly"))if(obj.edition=[obj.records[s][a],obj.records[s][a].innerHTML,a,s],obj.options.columns[a].editor)obj.options.columns[a].editor.openEditor(n,el,e,t);else if("hidden"!=obj.options.columns[a].type)if("checkbox"==obj.options.columns[a].type||"radio"==obj.options.columns[a].type){var c=!n.children[0].checked;obj.setValue(n,c),obj.edition=null}else if("dropdown"==obj.options.columns[a].type||"autocomplete"==obj.options.columns[a].type){c=obj.options.data[s][a];obj.options.columns[a].multiple&&!Array.isArray(c)&&(c=c.split(";"));for(var u="function"==typeof obj.options.columns[a].filter?obj.options.columns[a].filter(el,n,a,s,obj.options.columns[a].source):obj.options.columns[a].source,d=[],p=0;p<u.length;p++)d.push(u[p]);var f=o("div"),h={data:d,multiple:!!obj.options.columns[a].multiple,autocomplete:!(!obj.options.columns[a].autocomplete&&"autocomplete"!=obj.options.columns[a].type),opened:!0,value:c,width:"100%",height:f.style.minHeight,position:1==obj.options.tableOverflow||1==obj.options.fullscreen,onclose:function(){obj.closeEditor(n,!0)}};obj.options.columns[a].options&&obj.options.columns[a].options.type&&(h.type=obj.options.columns[a].options.type),jSuites.dropdown(f,h)}else"calendar"==obj.options.columns[a].type||"color"==obj.options.columns[a].type?(c=obj.options.data[s][a],(f=o("input")).value=c,1!=obj.options.tableOverflow&&1!=obj.options.fullscreen||(obj.options.columns[a].options.position=!0),obj.options.columns[a].options.value=obj.options.data[s][a],obj.options.columns[a].options.opened=!0,obj.options.columns[a].options.onclose=function(e,t){obj.closeEditor(n,!0)},"color"==obj.options.columns[a].type?jSuites.color(f,obj.options.columns[a].options):jSuites.calendar(f,obj.options.columns[a].options),f.focus()):"html"==obj.options.columns[a].type?(c=obj.options.data[s][a],(f=o("div")).style.position="relative",(i=document.createElement("div")).classList.add("jexcel_richtext"),f.appendChild(i),jSuites.editor(i,{focus:!0,value:c}),r=n.getBoundingClientRect(),l=i.getBoundingClientRect(),window.innerHeight<r.bottom+l.height?i.style.top=r.top-(l.height+2)+"px":i.style.top=r.top+"px"):"image"==obj.options.columns[a].type?(t=n.children[0],(f=o("div")).style.position="relative",(i=document.createElement("div")).classList.add("jclose"),t&&t.src&&i.appendChild(t),f.appendChild(i),jSuites.image(i,obj.options.imageOptions),r=n.getBoundingClientRect(),l=i.getBoundingClientRect(),window.innerHeight<r.bottom+l.height?i.style.top=r.top-(l.height+2)+"px":i.style.top=r.top+"px"):(c=1==e?"":obj.options.data[s][a],(f=0==obj.options.columns[a].wordWrap||1!=obj.options.wordWrap&&1!=obj.options.columns[a].wordWrap?o("input"):o("textarea")).focus(),f.value=c,h=obj.options.columns[a],t=null,!isFormula(c)&&(t=getMask(h))&&(h.disabledMaskOnEdition||(h.mask?(l=h.mask.split(";"),f.setAttribute("data-mask",l[0])):h.locale&&f.setAttribute("data-locale",h.locale)),(t.input=f).mask=t,jSuites.mask.render(c,t,!1)),f.onblur=function(){obj.closeEditor(n,!0)},f.scrollLeft=f.scrollWidth)},obj.closeEditor=function(e,t){var n,o,r=parseInt(e.getAttribute("data-x")),i=parseInt(e.getAttribute("data-y"));1==t?(obj.options.columns[r].editor?n=obj.options.columns[r].editor.closeEditor(e,t):"checkbox"!=obj.options.columns[r].type&&"radio"!=obj.options.columns[r].type&&"hidden"!=obj.options.columns[r].type&&("dropdown"==obj.options.columns[r].type||"autocomplete"==obj.options.columns[r].type?n=e.children[0].dropdown.close(!0):"calendar"==obj.options.columns[r].type?n=e.children[0].calendar.close(!0):"color"==obj.options.columns[r].type?n=e.children[0].color.close(!0):"html"==obj.options.columns[r].type?n=e.children[0].children[0].editor.getData():"image"==obj.options.columns[r].type?n=(o=e.children[0].children[0].children[0])&&"IMG"==o.tagName?o.src:"":"numeric"==obj.options.columns[r].type?("="!=(""+(n=e.children[0].value)).substr(0,1)&&""==n&&(n=obj.options.columns[r].allowEmpty?"":0),e.children[0].onblur=null):(n=e.children[0].value,e.children[0].onblur=null,o=obj.options.columns[r],(o=getMask(o))&&""!==n&&!isFormula(n)&&"number"!=typeof n&&(o=jSuites.mask.extract(n,o,!0))&&""!==o.value&&(n=o.value))),obj.options.data[i][r]==n?e.innerHTML=obj.edition[1]:obj.setValue(e,n)):(obj.options.columns[r].editor?obj.options.columns[r].editor.closeEditor(e,t):"dropdown"==obj.options.columns[r].type||"autocomplete"==obj.options.columns[r].type?e.children[0].dropdown.close(!0):"calendar"==obj.options.columns[r].type?e.children[0].calendar.close(!0):"color"==obj.options.columns[r].type?e.children[0].color.close(!0):e.children[0].onblur=null,e.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:""),obj.dispatch("oneditionend",el,e,r,i,n,t),e.classList.remove("editor"),obj.edition=null},obj.getCell=function(e){var t=(e=jexcel.getIdFromColumnName(e,!0))[0],e=e[1];return obj.records[e][t]},obj.getColumnOptions=function(e,t){return obj.options.columns[e]||{type:"text"}},obj.getCellFromCoords=function(e,t){return obj.records[t][e]},obj.getLabel=function(e){var t=(e=jexcel.getIdFromColumnName(e,!0))[0],e=e[1];return obj.records[e][t].innerHTML},obj.getLabelFromCoords=function(e,t){return obj.records[t][e].innerHTML},obj.getValue=function(e,t){var n,e="object"==typeof e?(n=e.getAttribute("data-x"),e.getAttribute("data-y")):(n=(e=jexcel.getIdFromColumnName(e,!0))[0],e[1]),o=null;return null!=n&&null!=e&&(obj.records[e]&&obj.records[e][n]&&(t||1==obj.options.copyCompatibility)?o=obj.records[e][n].innerHTML:obj.options.data[e]&&"undefined"!=obj.options.data[e][n]&&(o=obj.options.data[e][n])),o},obj.getValueFromCoords=function(e,t,n){var o=null;return null!=e&&null!=t&&(obj.records[t]&&obj.records[t][e]&&n||1==obj.options.copyCompatibility?o=obj.records[t][e].innerHTML:obj.options.data[t]&&"undefined"!=obj.options.data[t][e]&&(o=obj.options.data[t][e])),o},obj.setValue=function(e,t,n){var o=[];if("string"==typeof e){var r=(l=jexcel.getIdFromColumnName(e,!0))[0],i=l[1];o.push(obj.updateCell(r,i,t,n)),obj.updateFormulaChain(r,i,o)}else if(i=r=null,e&&e.getAttribute&&(r=e.getAttribute("data-x"),i=e.getAttribute("data-y")),null!=r&&null!=i)o.push(obj.updateCell(r,i,t,n)),obj.updateFormulaChain(r,i,o);else{var l,s=Object.keys(e);if(0<s.length)for(var a=0;a<s.length;a++)"string"==typeof e[a]?(r=(l=jexcel.getIdFromColumnName(e[a],!0))[0],i=l[1]):null!=e[a].x&&null!=e[a].y?(r=e[a].x,i=e[a].y,null!=e[a].newValue?t=e[a].newValue:null!=e[a].value&&(t=e[a].value)):(r=e[a].getAttribute("data-x"),i=e[a].getAttribute("data-y")),null!=r&&null!=i&&(o.push(obj.updateCell(r,i,t,n)),obj.updateFormulaChain(r,i,o))}obj.setHistory({action:"setValue",records:o,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,o)},obj.setValueFromCoords=function(e,t,n,o){var r=[];r.push(obj.updateCell(e,t,n,o)),obj.updateFormulaChain(e,t,r),obj.setHistory({action:"setValue",records:r,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,r)},obj.setCheckRadioValue=function(){for(var e=[],t=Object.keys(obj.highlighted),n=0;n<t.length;n++){var o=obj.highlighted[n].getAttribute("data-x"),r=obj.highlighted[n].getAttribute("data-y");"checkbox"!=obj.options.columns[o].type&&"radio"!=obj.options.columns[o].type||e.push(obj.updateCell(o,r,!obj.options.data[r][o]))}e.length&&(obj.setHistory({action:"setValue",records:e,selection:obj.selectedCell}),obj.onafterchanges(el,e))},function(e){var t=new Option,n=(t.innerHTML=e,null);for(e=t.getElementsByTagName("script");n=e[0];)n.parentNode.removeChild(n);return t.innerHTML}),chainLoopProtection=(obj.updateCell=function(e,t,n,o){if(1!=obj.records[t][e].classList.contains("readonly")||o){"="==(""+n).substr(0,1)&&1==obj.options.secureFormulas&&(l=secureFormula(n))!=n&&(n=l),null!=(l=obj.dispatch("onbeforechange",el,obj.records[t][e],e,t,n))&&(n=l),l={x:e,y:t,col:e,row:t,newValue:n=obj.options.columns[e].editor&&"function"==typeof obj.options.columns[e].editor.updateCell?obj.options.columns[e].editor.updateCell(obj.records[t][e],n,o):n,oldValue:obj.options.data[t][e]};var r,o=obj.options.columns[e].editor;if(o)obj.options.data[t][e]=n,"function"==typeof o.setValue&&o.setValue(obj.records[t][e],n);else if("checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type){if("radio"==obj.options.columns[e].type)for(var i=0;i<obj.options.data.length;i++)obj.options.data[i][e]=!1;obj.records[t][e].children[0].checked=1==n||"true"==n||"TRUE"==n,obj.options.data[t][e]=obj.records[t][e].children[0].checked}else"dropdown"==obj.options.columns[e].type||"autocomplete"==obj.options.columns[e].type?(obj.options.data[t][e]=n,obj.records[t][e].textContent=obj.getDropDownValue(e,n)):"calendar"==obj.options.columns[e].type?(o=null,validDate(n)||(r=jSuites.calendar.extractDateFromString(n,obj.options.columns[e].options.format))&&(o=r),obj.options.data[t][e]=n,obj.records[t][e].textContent=jSuites.calendar.getDateString(o||n,obj.options.columns[e].options.format)):"color"==obj.options.columns[e].type?(obj.options.data[t][e]=n,"square"==obj.options.columns[e].render?((r=document.createElement("div")).className="color",r.style.backgroundColor=n,obj.records[t][e].textContent="",obj.records[t][e].appendChild(r)):(obj.records[t][e].style.color=n,obj.records[t][e].textContent=n)):"image"==obj.options.columns[e].type?(obj.options.data[t][e]=n=""+n,obj.records[t][e].innerHTML="",n&&"data:image"==n.substr(0,10)&&((o=document.createElement("img")).src=n,obj.records[t][e].appendChild(o))):(obj.options.data[t][e]=n,"html"==obj.options.columns[e].type?obj.records[t][e].innerHTML=stripScript(obj.parseValue(e,t,n)):!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?obj.records[t][e].innerHTML=stripScript(obj.parseValue(e,t,n,obj.records[t][e])):obj.records[t][e].textContent=obj.parseValue(e,t,n,obj.records[t][e]),0!=obj.options.columns[e].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[e].wordWrap||200<obj.records[t][e].innerHTML.length)?obj.records[t][e].style.whiteSpace="pre-wrap":obj.records[t][e].style.whiteSpace="");0<e&&(obj.records[t][e-1].style.overflow=n?"hidden":""),obj.dispatch("onchange",el,obj.records[t]&&obj.records[t][e]?obj.records[t][e]:null,e,t,n,l.oldValue)}else var l={x:e,y:t,col:e,row:t};return l},obj.copyData=function(e,t){var n,o,r=obj.getData(!0,!0),i=obj.selectedContainer,l=parseInt(e.getAttribute("data-x")),e=parseInt(e.getAttribute("data-y")),s=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y")),c=[],u=!1;i[0]==l?(n=e<i[1]?e-i[1]:1,o=0):(o=l<i[0]?l-i[0]:1,n=0);for(var d=0,p=0,f=e;f<=a;f++)if(!obj.rows[f]||"none"!=obj.rows[f].style.display){null==r[p]&&(p=0),i[d=0]!=l&&(o=l<i[0]?l-i[0]:1);for(var h=l;h<=s;h++){if(obj.records[f][h]&&!obj.records[f][h].classList.contains("readonly")&&"none"!=obj.records[f][h].style.display&&0==u){if(!obj.selection.length&&""!=obj.options.data[f][h]){u=!0;continue}null!=r[p]&&null!=r[p][d]||(d=0);var g,m=r[p][d];if(m&&!r[1]&&1==obj.options.autoIncrement)if("text"==obj.options.columns[h].type||"number"==obj.options.columns[h].type)if("="==(""+m).substr(0,1)){var b=m.match(/([A-Z]+[0-9]+)/g);if(b){for(var j=[],v=0;v<b.length;v++){var y=jexcel.getIdFromColumnName(b[v],1),y=(y[0]+=o,y[1]+=n,y[1]<0&&(y[1]=0),jexcel.getColumnNameFromId([y[0],y[1]]));y!=b[v]&&(j[b[v]]=y)}j&&(m=obj.updateFormula(m,j))}}else m==Number(m)&&(m=Number(m)+n);else"calendar"==obj.options.columns[h].type&&((g=new Date(m)).setDate(g.getDate()+n),m=g.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(g.getMonth()+1))+"-"+jexcel.doubleDigitFormat(g.getDate())+" 00:00:00");c.push(obj.updateCell(h,f,m)),obj.updateFormulaChain(h,f,c)}d++,i[0]!=l&&o++}p++,n++}obj.setHistory({action:"setValue",records:c,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,c)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(e,t,n){if(1==e)obj.selectedCell&&(t>=obj.selectedCell[1]&&t<=obj.selectedCell[3]||n>=obj.selectedCell[1]&&n<=obj.selectedCell[3])&&obj.resetSelection();else if(obj.selectedCell&&(t>=obj.selectedCell[0]&&t<=obj.selectedCell[2]||n>=obj.selectedCell[0]&&n<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(e){if(obj.highlighted.length)for(var t=1,n=0;n<obj.highlighted.length;n++){obj.highlighted[n].classList.remove("highlight"),obj.highlighted[n].classList.remove("highlight-left"),obj.highlighted[n].classList.remove("highlight-right"),obj.highlighted[n].classList.remove("highlight-top"),obj.highlighted[n].classList.remove("highlight-bottom"),obj.highlighted[n].classList.remove("highlight-selected");for(var o,r,i=parseInt(obj.highlighted[n].getAttribute("data-x")),l=parseInt(obj.highlighted[n].getAttribute("data-y")),s=obj.highlighted[n].getAttribute("data-merged")?(r=0<(o=parseInt(obj.highlighted[n].getAttribute("colspan")))?i+(o-1):i,0<(o=parseInt(obj.highlighted[n].getAttribute("rowspan")))?l+(o-1):l):(r=i,l),a=i;a<=r;a++)obj.headers[a]&&obj.headers[a].classList.remove("selected");for(a=l;a<=s;a++)obj.rows[a]&&obj.rows[a].classList.remove("selected")}else var t=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",1==e&&1==t&&obj.dispatch("onblur",el),t},obj.updateSelection=function(e,t,n){var o,r=e.getAttribute("data-x"),e=e.getAttribute("data-y"),t=t?(o=t.getAttribute("data-x"),t.getAttribute("data-y")):(o=r,e);obj.updateSelectionFromCoords(r,e,o,t,n)},obj.updateSelectionFromCoords=function(e,t,n,o,r){var i,l,s=obj.resetSelection();if(null==t&&(t=0,o=obj.rows.length-1),null==n&&(n=e),null==o&&(o=t),e>=obj.headers.length&&(e=obj.headers.length-1),t>=obj.rows.length&&(t=obj.rows.length-1),n>=obj.headers.length&&(n=obj.headers.length-1),o>=obj.rows.length&&(o=obj.rows.length-1),obj.selectedCell=[e,t,n,o],null!=e){obj.records[t][e]&&obj.records[t][e].classList.add("highlight-selected");for(var a,c,u,d=parseInt(e)<parseInt(n)?(i=parseInt(e),parseInt(n)):(i=parseInt(n),parseInt(e)),p=parseInt(t)<parseInt(o)?(l=parseInt(t),parseInt(o)):(l=parseInt(o),parseInt(t)),f=i;f<=d;f++)for(var h=l;h<=p;h++)obj.records[h][f]&&obj.records[h][f].getAttribute("data-merged")&&(u=parseInt(obj.records[h][f].getAttribute("data-x")),a=parseInt(obj.records[h][f].getAttribute("data-y")),1<(c=parseInt(obj.records[h][f].getAttribute("colspan")))&&(u<i&&(i=u),d<u+c)&&(d=u+c-1),u=parseInt(obj.records[h][f].getAttribute("rowspan")))&&(a<l&&(l=a),p<a+u)&&(p=a+u-1);for(var g=null,m=null,b=null,j=null,h=l;h<=p;h++)"none"!=obj.rows[h].style.display&&(null==b&&(b=h),j=h);for(f=i;f<=d;f++){for(h=l;h<=p;h++)"none"!=obj.rows[h].style.display&&"none"!=obj.records[h][f].style.display&&(obj.records[h][f].classList.add("highlight"),obj.highlighted.push(obj.records[h][f]));"hidden"!=obj.options.columns[f].type&&(null==g&&(g=f),m=f)}for(m=m||0,f=g=g||0;f<=m;f++)"hidden"!=obj.options.columns[f].type&&(obj.records[b]&&obj.records[b][f]&&obj.records[b][f].classList.add("highlight-top"),obj.records[j]&&obj.records[j][f]&&obj.records[j][f].classList.add("highlight-bottom"),obj.headers[f].classList.add("selected"));for(h=b;h<=j;h++)obj.rows[h]&&"none"!=obj.rows[h].style.display&&(obj.records[h][g].classList.add("highlight-left"),obj.records[h][m].classList.add("highlight-right"),obj.rows[h].classList.add("selected"));obj.selectedContainer=[g,b,m,j]}0==s&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,g,b,m,j,r),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var e=0;e<obj.selection.length;e++)obj.selection[e].classList.remove("selection"),obj.selection[e].classList.remove("selection-left"),obj.selection[e].classList.remove("selection-right"),obj.selection[e].classList.remove("selection-top"),obj.selection[e].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(e,t){obj.removeCopySelection();var n=obj.selectedContainer[0],o=obj.selectedContainer[1],r=obj.selectedContainer[2],i=obj.selectedContainer[3];if(null!=e&&null!=t){var l,s,a=0<e-r?(l=parseInt(r)+1,parseInt(e)):(l=parseInt(e),parseInt(n)-1),c=0<t-i?(s=parseInt(i)+1,parseInt(t)):(s=parseInt(t),parseInt(o)-1);a-l<=c-s?(l=parseInt(n),a=parseInt(r)):(s=parseInt(o),c=parseInt(i));for(var u=s;u<=c;u++)for(var d=l;d<=a;d++)obj.records[u][d]&&"none"!=obj.rows[u].style.display&&"none"!=obj.records[u][d].style.display&&(obj.records[u][d].classList.add("selection"),obj.records[s][d].classList.add("selection-top"),obj.records[c][d].classList.add("selection-bottom"),obj.records[u][l].classList.add("selection-left"),obj.records[u][a].classList.add("selection-right"),obj.selection.push(obj.records[u][d]))}},obj.updateCornerPosition=function(){var e,t,n,o,r,i,l,s;obj.highlighted.length?(e=(r=obj.highlighted[obj.highlighted.length-1]).getAttribute("data-x"),t=(s=obj.content.getBoundingClientRect()).left,s=s.top,n=(r=r.getBoundingClientRect()).left,l=r.top,o=r.width,r=r.height,i=n-t+obj.content.scrollLeft+o-4,l=l-s+obj.content.scrollTop+r-4,obj.corner.style.top=l+"px",obj.corner.style.left=i+"px",obj.options.freezeColumns&&(s=obj.getFreezeWidth(),e>obj.options.freezeColumns-1)&&n-t+o<s?obj.corner.style.display="none":1==obj.options.selectionCopy&&(obj.corner.style.display="")):(obj.corner.style.top="-2000px",obj.corner.style.left="-2000px")},obj.updateScroll=function(e){var t,n=obj.content.getBoundingClientRect(),o=n.left,r=n.top,i=n.width,n=n.height,l=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),s=l.left,a=l.top,c=l.width,l=l.height,e=0==e||1==e?(t=s-o+obj.content.scrollLeft,a-r+obj.content.scrollTop-2):(t=s-o+obj.content.scrollLeft+c,a-r+obj.content.scrollTop+l),s=(e>obj.content.scrollTop+30&&e<obj.content.scrollTop+n||(e<obj.content.scrollTop+30?obj.content.scrollTop=e-l:obj.content.scrollTop=e-(n-2)),obj.getFreezeWidth());t>obj.content.scrollLeft+s&&t<obj.content.scrollLeft+i||(t<obj.content.scrollLeft+30?(obj.content.scrollLeft=t,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):t<obj.content.scrollLeft+s?obj.content.scrollLeft=t-s-1:obj.content.scrollLeft=t-(i-20))},obj.getWidth=function(e){if(void 0===e)for(var t=[],n=0;n<obj.headers.length;n++)t.push(obj.options.columns[n].width);else"object"==typeof e&&(e=$(e).getAttribute("data-x")),t=obj.colgroup[e].getAttribute("width");return t},obj.setWidth=function(e,t,n){if(t){if(Array.isArray(e)){n=n||[];for(var o=0;o<e.length;o++){n[o]||(n[o]=obj.colgroup[e[o]].getAttribute("width"));var r=Array.isArray(t)&&t[o]?t[o]:t;obj.colgroup[e[o]].setAttribute("width",r),obj.options.columns[e[o]].width=r}}else n=n||obj.colgroup[e].getAttribute("width"),obj.colgroup[e].setAttribute("width",t),obj.options.columns[e].width=t;obj.setHistory({action:"setWidth",column:e,oldValue:n,newValue:t}),obj.dispatch("onresizecolumn",el,e,t,n),obj.updateCornerPosition()}},obj.setHeight=function(e,t,n){0<t&&("object"==typeof e&&(e=e.getAttribute("data-y")),n=(n=n||obj.rows[e].getAttribute("height"))||obj.rows[e].getBoundingClientRect().height,t=parseInt(t),obj.rows[e].style.height=t+"px",obj.options.rows[e]||(obj.options.rows[e]={}),obj.options.rows[e].height=t,obj.setHistory({action:"setHeight",row:e,oldValue:n,newValue:t}),obj.dispatch("onresizerow",el,e,t,n),obj.updateCornerPosition())},obj.getHeight=function(e){if(void 0===e)for(var t=[],n=0;n<obj.rows.length;n++){var o=obj.rows[n].style.height;o&&(t[n]=o)}else"object"==typeof e&&(e=$(e).getAttribute("data-y")),t=obj.rows[e].style.height;return t},obj.setFooter=function(e){if(e&&(obj.options.footers=e),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var t,n,o=0;o<obj.options.footers.length;o++){obj.tfoot.children[o]?t=obj.tfoot.children[o]:(t=document.createElement("tr"),n=document.createElement("td"),t.appendChild(n),obj.tfoot.appendChild(t));for(var r,i=0;i<obj.headers.length;i++)obj.options.footers[o][i]||(obj.options.footers[o][i]=""),obj.tfoot.children[o].children[i+1]?n=obj.tfoot.children[o].children[i+1]:(n=document.createElement("td"),t.appendChild(n),r=obj.options.columns[i].align||"center",n.style.textAlign=r),n.textContent=obj.parseValue(+obj.records.length+i,o,obj.options.footers[o][i]),n.style.display=obj.colgroup[i].style.display}}},obj.getHeader=function(e){return obj.headers[e].textContent},obj.setHeader=function(e,t){var n;obj.headers[e]&&(n=obj.headers[e].textContent,(t=t||prompt(obj.options.text.columnName,n))&&(obj.headers[e].textContent=t,obj.headers[e].setAttribute("title",t),obj.options.columns[e].title=t),obj.setHistory({action:"setHeader",column:e,oldValue:n,newValue:t}),obj.dispatch("onchangeheader",el,e,n,t))},obj.getHeaders=function(e){for(var t=[],n=0;n<obj.headers.length;n++)t.push(obj.getHeader(n));return e?t:t.join(obj.options.csvDelimiter)},obj.getMeta=function(e,t){return e?t?obj.options.meta[e]&&obj.options.meta[e][t]?obj.options.meta[e][t]:null:obj.options.meta[e]||null:obj.options.meta},obj.setMeta=function(e,t,n){if(obj.options.meta||(obj.options.meta={}),t&&n)obj.options.meta[e]||(obj.options.meta[e]={}),obj.options.meta[e][t]=n;else for(var o=Object.keys(e),r=0;r<o.length;r++){obj.options.meta[o[r]]||(obj.options.meta[o[r]]={});for(var i=Object.keys(e[o[r]]),l=0;l<i.length;l++)obj.options.meta[o[r]][i[l]]=e[o[r]][i[l]]}obj.dispatch("onchangemeta",el,e,t,n)},obj.updateMeta=function(e){if(obj.options.meta){for(var t={},n=Object.keys(obj.options.meta),o=0;o<n.length;o++)e[n[o]]?t[e[n[o]]]=obj.options.meta[n[o]]:t[n[o]]=obj.options.meta[n[o]];obj.options.meta=t}},obj.getStyle=function(e,t){if(e)return e=jexcel.getIdFromColumnName(e,!0),t?obj.records[e[1]][e[0]].style[t]:obj.records[e[1]][e[0]].getAttribute("style");for(var n={},o=obj.options.data[0].length,r=obj.options.data.length,i=0;i<r;i++)for(var l=0;l<o;l++){var s=t?obj.records[i][l].style[t]:obj.records[i][l].getAttribute("style");s&&(n[jexcel.getColumnNameFromId([l,i])]=s)}return n},obj.resetStyle=function(e,t){for(var n=Object.keys(e),o=0;o<n.length;o++){var r=jexcel.getIdFromColumnName(n[o],!0);obj.records[r[1]]&&obj.records[r[1]][r[0]]&&obj.records[r[1]][r[0]].setAttribute("style","")}obj.setStyle(e,null,null,null,t)},obj.setStyle=function(e,t,n,i,o){function r(e,t,n){var o,r=jexcel.getIdFromColumnName(e,!0);obj.records[r[1]]&&obj.records[r[1]][r[0]]&&(0==obj.records[r[1]][r[0]].classList.contains("readonly")||i)&&((o=obj.records[r[1]][r[0]].style[t])!=n||i?obj.records[r[1]][r[0]].style[t]=n:obj.records[r[1]][r[0]].style[t]=n="",s[e]||(s[e]=[]),l[e]||(l[e]=[]),s[e].push([t+":"+o]),l[e].push([t+":"+n]))}var l={},s={};if(t&&n)if("string"==typeof e)r(e,t,n);else for(var a=[],c=0;c<e.length;c++){var u=e[c].getAttribute("data-x"),d=e[c].getAttribute("data-y"),u=jexcel.getColumnNameFromId([u,d]);a[u]||(r(u,t,n),a[u]=!0)}else for(var p=Object.keys(e),c=0;c<p.length;c++){var f=e[p[c]];"string"==typeof f&&(f=f.split(";"));for(var h=0;h<f.length;h++)"string"==typeof f[h]&&(f[h]=f[h].split(":")),f[h][0].trim()&&r(p[c],f[h][0].trim(),f[h][1])}for(p=Object.keys(s),c=0;c<p.length;c++)s[p[c]]=s[p[c]].join(";");for(p=Object.keys(l),c=0;c<p.length;c++)l[p[c]]=l[p[c]].join(";");o||obj.setHistory({action:"setStyle",oldValue:s,newValue:l}),obj.dispatch("onchangestyle",el,e,t,n)},obj.getComments=function(e,t){if(e)return"string"==typeof e&&(e=jexcel.getIdFromColumnName(e,!0)),t?[obj.records[e[1]][e[0]].getAttribute("title"),obj.records[e[1]][e[0]].getAttribute("author")]:obj.records[e[1]][e[0]].getAttribute("title")||"";for(var n={},o=0;o<obj.options.data.length;o++)for(var r=0;r<obj.options.columns.length;r++){var i=obj.records[o][r].getAttribute("title");i&&(n[e=jexcel.getColumnNameFromId([r,o])]=i)}return n},obj.setComments=function(e,t,n){var o="string"==typeof e?jexcel.getIdFromColumnName(e,!0):e,r=obj.records[o[1]][o[0]].getAttribute("title"),i=[r,n=obj.records[o[1]][o[0]].getAttribute("data-author")];obj.records[o[1]][o[0]].setAttribute("title",t||""),obj.records[o[1]][o[0]].setAttribute("data-author",n||""),t?obj.records[o[1]][o[0]].classList.add("jexcel_comments"):obj.records[o[1]][o[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:e,newValue:[t,n],oldValue:i}),obj.dispatch("oncomments",el,t,r,o,o[0],o[1])},obj.getConfig=function(){var e=obj.options;return e.style=obj.getStyle(),e.mergeCells=obj.getMerge(),e.comments=obj.getComments(),e},obj.orderBy=function(e,t){if(0<=e){if(0<Object.keys(obj.options.mergeCells).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}t=null==t?obj.headers[e].classList.contains("arrow-down")?1:0:t?1:0;var n=[];if("number"==obj.options.columns[e].type||"numeric"==obj.options.columns[e].type||"percentage"==obj.options.columns[e].type||"autonumber"==obj.options.columns[e].type||"color"==obj.options.columns[e].type)for(var o=0;o<obj.options.data.length;o++)n[o]=[o,Number(obj.options.data[o][e])];else if("calendar"==obj.options.columns[e].type||"checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type)for(o=0;o<obj.options.data.length;o++)n[o]=[o,obj.options.data[o][e]];else for(o=0;o<obj.options.data.length;o++)n[o]=[o,obj.records[o][e].textContent.toLowerCase()];"function"!=typeof obj.options.sorting&&(obj.options.sorting=function(n){return function(e,t){e=e[1],t=t[1];return n?""===e&&""!==t?1:""!==e&&""===t||t<e?-1:e<t?1:0:""===e&&""!==t?1:""!==e&&""===t?-1:t<e?1:e<t?-1:0}});for(var n=n.sort(obj.options.sorting(t)),r=[],o=0;o<n.length;o++)r[o]=n[o][0];return obj.setHistory({action:"orderBy",rows:r,column:e,order:t}),obj.updateOrderArrow(e,t),obj.updateOrder(r),obj.dispatch("onsort",el,e,t),!0}},obj.updateOrderArrow=function(e,t){for(var n=0;n<obj.headers.length;n++)obj.headers[n].classList.remove("arrow-up"),obj.headers[n].classList.remove("arrow-down");t?obj.headers[e].classList.add("arrow-up"):obj.headers[e].classList.add("arrow-down")},obj.updateOrder=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=obj.options.data[e[n]];for(obj.options.data=t,t=[],n=0;n<e.length;n++)t[n]=obj.records[e[n]];for(obj.records=t,t=[],n=0;n<e.length;n++)t[n]=obj.rows[e[n]];if(obj.rows=t,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,(obj.pageNumber=0)<obj.options.pagination)obj.page(0);else if(1==obj.options.lazyLoading)obj.loadPage(0);else for(n=0;n<obj.rows.length;n++)obj.tbody.appendChild(obj.rows[n])},obj.moveRow=function(e,t,n){if(0<Object.keys(obj.options.mergeCells).length){var o=t<e?1:0;if(obj.isRowMerged(e).length||obj.isRowMerged(t,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}n||(0<=Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])?t<e?obj.tbody.insertBefore(obj.rows[e],obj.rows[t]):obj.tbody.insertBefore(obj.rows[e],obj.rows[t].nextSibling):obj.tbody.removeChild(obj.rows[e])),obj.rows.splice(t,0,obj.rows.splice(e,1)[0]),obj.records.splice(t,0,obj.records.splice(e,1)[0]),obj.options.data.splice(t,0,obj.options.data.splice(e,1)[0]),0<obj.options.pagination&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,e,t)},obj.insertRow=function(e,t,n){if(1==obj.options.allowInsertRow){var o,r=[],e=(0<e?o=e:(o=1,e&&(r=e)),n=!!n,obj.options.data.length-1);if((null==t||t>=parseInt(e)||t<0)&&(t=e),!1===obj.dispatch("onbeforeinsertrow",el,t,o,n))return!1;if(0<Object.keys(obj.options.mergeCells).length&&obj.isRowMerged(t,n).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var i=n?t:t+1,e=obj.records.splice(i),l=obj.options.data.splice(i),s=obj.rows.splice(i),a=[],c=[],u=[],d=i;d<o+i;d++){obj.options.data[d]=[];for(var p=0;p<obj.options.columns.length;p++)obj.options.data[d][p]=r[p]||"";var f=obj.createRow(d,obj.options.data[d]);s[0]?0<=Array.prototype.indexOf.call(obj.tbody.children,s[0])&&obj.tbody.insertBefore(f,s[0]):0<=Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])&&obj.tbody.appendChild(f),a.push(obj.records[d]),c.push(obj.options.data[d]),u.push(f)}Array.prototype.push.apply(obj.records,e),Array.prototype.push.apply(obj.options.data,l),Array.prototype.push.apply(obj.rows,s),0<obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:t,numOfRows:o,insertBefore:n,rowRecords:a,rowData:c,rowNode:u}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,t,o,a,n)}},obj.deleteRow=function(e,t){if(1==obj.options.allowDeleteRow)if(1==obj.options.allowDeletingAllRows||1<obj.options.data.length){null==e&&(t=(n=obj.getSelectedRows())[0]?(e=parseInt(n[0].getAttribute("data-y")),n.length):(e=obj.options.data.length-1,1));var n=obj.options.data.length-1;if((e=null==e||n<e||e<0?n:e)+(t=t||1)>=obj.options.data.length&&(t=obj.options.data.length-e),!1===obj.dispatch("onbeforedeleterow",el,e,t))return!1;if(-1<parseInt(e)){var o=!1;if(0<Object.keys(obj.options.mergeCells).length)for(var r=e;r<e+t;r++)obj.isRowMerged(r,!1).length&&(o=!0);if(o){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(0==obj.options.allowDeletingAllRows&&1+n===t&&(t--,console.error("Jspreadsheet: It is not possible to delete the last row")),r=e;r<e+t;r++)0<=Array.prototype.indexOf.call(obj.tbody.children,obj.rows[r])&&(obj.rows[r].className="",obj.rows[r].parentNode.removeChild(obj.rows[r]));var n=obj.records.splice(e,t),i=obj.options.data.splice(e,t),l=obj.rows.splice(e,t);0<obj.options.pagination&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,e,e+t-1),obj.setHistory({action:"deleteRow",rowNumber:e,numOfRows:t,insertBefore:1,rowRecords:n,rowData:i,rowNode:l}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,e,t,n)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(e,t){if(0<Object.keys(obj.options.mergeCells).length){var n=t<e?1:0;if(obj.isColMerged(e).length||obj.isColMerged(t,n).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((e=parseInt(e))>(t=parseInt(t))){obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t]),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t]);for(var o=0;o<obj.rows.length;o++)obj.rows[o].insertBefore(obj.records[o][e],obj.records[o][t])}else for(obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t].nextSibling),o=0;o<obj.rows.length;o++)obj.rows[o].insertBefore(obj.records[o][e],obj.records[o][t].nextSibling);for(obj.options.columns.splice(t,0,obj.options.columns.splice(e,1)[0]),obj.headers.splice(t,0,obj.headers.splice(e,1)[0]),obj.colgroup.splice(t,0,obj.colgroup.splice(e,1)[0]),o=0;o<obj.rows.length;o++)obj.options.data[o].splice(t,0,obj.options.data[o].splice(e,1)[0]),obj.records[o].splice(t,0,obj.records[o].splice(e,1)[0]);if(obj.options.footers)for(o=0;o<obj.options.footers.length;o++)obj.options.footers[o].splice(t,0,obj.options.footers[o].splice(e,1)[0]);obj.setHistory({action:"moveColumn",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,e,t)},obj.insertColumn=function(e,t,n,o){if(1==obj.options.allowInsertColumn){var r,i=[],e=(0<e?r=e:(r=1,e&&(i=e)),n=!!n,obj.options.columns.length-1);if((null==t||t>=parseInt(e)||t<0)&&(t=e),!1===obj.dispatch("onbeforeinsertcolumn",el,t,r,n))return!1;if(0<Object.keys(obj.options.mergeCells).length&&obj.isColMerged(t,n).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}o=o||[];for(var l=0;l<r;l++)o[l]||(o[l]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var s=n?t:t+1;obj.options.columns=jexcel.injectArray(obj.options.columns,s,o);for(var e=obj.headers.splice(s),a=obj.colgroup.splice(s),c=[],u=[],d=[],p=[],f=[],h=s;h<r+s;h++)obj.createCellHeader(h),obj.headerContainer.insertBefore(obj.headers[h],obj.headerContainer.children[h+1]),obj.colgroupContainer.insertBefore(obj.colgroup[h],obj.colgroupContainer.children[h+1]),c.push(obj.headers[h]),u.push(obj.colgroup[h]);if(obj.options.footers)for(var g=0;g<obj.options.footers.length;g++){for(f[g]=[],l=0;l<r;l++)f[g].push("");obj.options.footers[g].splice(s,0,f[g])}for(var m=0;m<obj.options.data.length;m++){var b=obj.options.data[m].splice(s),j=obj.records[m].splice(s);for(p[m]=[],d[m]=[],h=s;h<r+s;h++){var v=i[m]||"",y=(obj.options.data[m][h]=v,obj.createCell(h,m,obj.options.data[m][h]));obj.records[m][h]=y,obj.rows[m]&&obj.rows[m].insertBefore(y,obj.rows[m].children[h+1]),p[m].push(v),d[m].push(y)}Array.prototype.push.apply(obj.options.data[m],b),Array.prototype.push.apply(obj.records[m],j)}if(Array.prototype.push.apply(obj.headers,e),Array.prototype.push.apply(obj.colgroup,a),obj.options.nestedHeaders&&0<obj.options.nestedHeaders.length)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(g=0;g<obj.options.nestedHeaders.length;g++){var x=parseInt(obj.options.nestedHeaders[g][obj.options.nestedHeaders[g].length-1].colspan)+r;obj.options.nestedHeaders[g][obj.options.nestedHeaders[g].length-1].colspan=x,obj.thead.children[g].children[obj.thead.children[g].children.length-1].setAttribute("colspan",x);for(var w=(w=obj.thead.children[g].children[obj.thead.children[g].children.length-1].getAttribute("data-column")).split(","),h=s;h<r+s;h++)w.push(h);obj.thead.children[g].children[obj.thead.children[g].children.length-1].setAttribute("data-column",w)}else x=parseInt(obj.options.nestedHeaders[0].colspan)+r,obj.options.nestedHeaders[0].colspan=x,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",x);obj.setHistory({action:"insertColumn",columnNumber:t,numOfColumns:r,insertBefore:n,columns:o,headers:c,colgroup:u,records:d,footers:f,data:p}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,t,r,d,n)}},obj.deleteColumn=function(e,t){if(1==obj.options.allowDeleteColumn)if(1<obj.headers.length){null==e&&(t=(n=obj.getSelectedColumns(!0)).length?(e=parseInt(n[0]),parseInt(n.length)):(e=obj.headers.length-1,1));var n=obj.options.data[0].length-1;if((t=t||1)>obj.options.data[0].length-(e=null==e||n<e||e<0?n:e)&&(t=obj.options.data[0].length-e),!1===obj.dispatch("onbeforedeletecolumn",el,e,t))return!1;if(-1<parseInt(e)){var o=!1;if(0<Object.keys(obj.options.mergeCells).length)for(var r=e;r<e+t;r++)obj.isColMerged(r,!1).length&&(o=!0);if(o){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}for(n=obj.options.columns.splice(e,t),r=e;r<e+t;r++)obj.colgroup[r].className="",obj.headers[r].className="",obj.colgroup[r].parentNode.removeChild(obj.colgroup[r]),obj.headers[r].parentNode.removeChild(obj.headers[r]);for(var i=obj.headers.splice(e,t),l=obj.colgroup.splice(e,t),s=[],a=[],c=[],u=0;u<obj.options.data.length;u++)for(r=e;r<e+t;r++)obj.records[u][r].className="",obj.records[u][r].parentNode.removeChild(obj.records[u][r]);for(u=0;u<obj.options.data.length;u++)a[u]=obj.options.data[u].splice(e,t),s[u]=obj.records[u].splice(e,t);if(obj.options.footers)for(u=0;u<obj.options.footers.length;u++)c[u]=obj.options.footers[u].splice(e,t);if(obj.conditionalSelectionUpdate(0,e,e+t-1),obj.options.nestedHeaders&&0<obj.options.nestedHeaders.length)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var d=0;d<obj.options.nestedHeaders.length;d++){var p=parseInt(obj.options.nestedHeaders[d][obj.options.nestedHeaders[d].length-1].colspan)-t;obj.options.nestedHeaders[d][obj.options.nestedHeaders[d].length-1].colspan=p,obj.thead.children[d].children[obj.thead.children[d].children.length-1].setAttribute("colspan",p)}else p=parseInt(obj.options.nestedHeaders[0].colspan)-t,obj.options.nestedHeaders[0].colspan=p,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",p);obj.setHistory({action:"deleteColumn",columnNumber:e,numOfColumns:t,insertBefore:1,columns:n,headers:i,colgroup:l,records:s,footers:c,data:a}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,e,t,s)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(e){for(var t=[],n=0;n<obj.rows.length;n++)obj.rows[n].classList.contains("selected")&&t.push(e?n:obj.rows[n]);return t},obj.getSelectedColumns=function(){for(var e=[],t=0;t<obj.headers.length;t++)obj.headers[t].classList.contains("selected")&&e.push(t);return e},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var e=0;e<obj.headers.length;e++)(n=obj.headers[e].getAttribute("data-x"))!=e&&(obj.headers[e].setAttribute("data-x",e),obj.headers[e].getAttribute("title")||(obj.headers[e].innerHTML=jexcel.getColumnName(e)));for(var t=0;t<obj.rows.length;t++)obj.rows[t]&&(o=obj.rows[t].getAttribute("data-y"))!=t&&(obj.rows[t].setAttribute("data-y",t),obj.rows[t].children[0].setAttribute("data-y",t),obj.rows[t].children[0].innerHTML=t+1);for(var n,o,r,i,l,s,a=[],c=[],u=function(e,t,n,o){e!=n&&obj.records[o][n].setAttribute("data-x",n),t!=o&&obj.records[o][n].setAttribute("data-y",o),e==n&&t==o||(e=jexcel.getColumnNameFromId([e,t]),t=jexcel.getColumnNameFromId([n,o]),a[e]=t)},t=0;t<obj.records.length;t++)for(e=0;e<obj.records[0].length;e++)obj.records[t][e]&&(n=obj.records[t][e].getAttribute("data-x"),o=obj.records[t][e].getAttribute("data-y"),obj.records[t][e].getAttribute("data-merged")?(r=jexcel.getColumnNameFromId([n,o]),i=jexcel.getColumnNameFromId([e,t]),null==c[r]&&(r==i?c[r]=!1:(l=parseInt(e-n),s=parseInt(t-o),c[r]=[i,l,s]))):u(n,o,e,t));var d=Object.keys(c);if(d.length)for(e=0;e<d.length;e++)if(c[d[e]]){var p=jexcel.getIdFromColumnName(d[e],!0);for(u(n=p[0],o=p[1],n+c[d[e]][1],o+c[d[e]][2]),r=d[e],i=c[d[e]][0],t=0;t<obj.options.mergeCells[r][2].length;t++)n=parseInt(obj.options.mergeCells[r][2][t].getAttribute("data-x")),o=parseInt(obj.options.mergeCells[r][2][t].getAttribute("data-y")),obj.options.mergeCells[r][2][t].setAttribute("data-x",n+c[d[e]][1]),obj.options.mergeCells[r][2][t].setAttribute("data-y",o+c[d[e]][2]);obj.options.mergeCells[i]=obj.options.mergeCells[r],delete obj.options.mergeCells[r]}obj.updateFormulas(a),obj.updateMeta(a),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(0<obj.options.minSpareRows){for(var e=0,t=obj.rows.length-1;0<=t;t--){for(var n=!1,o=0;o<obj.headers.length;o++)obj.options.data[t][o]&&(n=!0);if(n)break;e++}0<obj.options.minSpareRows-e&&obj.insertRow(obj.options.minSpareRows-e)}if(0<obj.options.minSpareCols){for(var r=0,o=obj.headers.length-1;0<=o;o--){for(n=!1,t=0;t<obj.rows.length;t++)obj.options.data[t][o]&&(n=!0);if(n)break;r++}0<obj.options.minSpareCols-r&&obj.insertColumn(obj.options.minSpareCols-r)}if("function"==typeof obj.options.updateTable){for(obj.options.detachForUpdates&&el.removeChild(obj.content),t=0;t<obj.rows.length;t++)for(o=0;o<obj.headers.length;o++)obj.options.updateTable(el,obj.records[t][o],o,t,obj.options.data[t][o],obj.records[t][o].textContent,jexcel.getColumnNameFromId([o,t]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(e){if(e=obj.getCell(e))return!!e.classList.contains("readonly")},obj.setReadOnly=function(e,t){(e=obj.getCell(e))&&(t?e.classList.add("readonly"):e.classList.remove("readonly"))},obj.showRow=function(e){obj.rows[e].style.display=""},obj.hideRow=function(e){obj.rows[e].style.display="none"},obj.showColumn=function(e){obj.headers[e].style.display="",obj.colgroup[e].style.display="",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="");for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display="";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.hideColumn=function(e){obj.headers[e].style.display="none",obj.colgroup[e].style.display="none",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="none");for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display="none";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")},[]),secureFormula=(obj.updateFormulaChain=function(e,t,n){var o=jexcel.getColumnNameFromId([e,t]);if(obj.formula[o]&&0<obj.formula[o].length)if(chainLoopProtection[o])obj.records[t][e].innerHTML="#ERROR",obj.formula[o]="";else{chainLoopProtection[o]=!0;for(var r=0;r<obj.formula[o].length;r++){var i=jexcel.getIdFromColumnName(obj.formula[o][r],!0),l=""+obj.options.data[i[1]][i[0]];"="==l.substr(0,1)?n.push(obj.updateCell(i[0],i[1],l,!0)):Object.keys(obj.formula)[r]=null,obj.updateFormulaChain(i[0],i[1],n)}}chainLoopProtection=[]},obj.updateFormulas=function(e){for(var t,n=0;n<obj.options.data.length;n++)for(var o=0;o<obj.options.data[0].length;o++)"="==(s=""+obj.options.data[n][o]).substr(0,1)&&(t=obj.updateFormula(s,e))!=s&&(obj.options.data[n][o]=t);for(var r=[],i=Object.keys(obj.formula),n=0;n<i.length;n++){var l=i[n],s=obj.formula[l];for(r[l=e[l]?e[l]:l]=[],o=0;o<s.length;o++){var a=s[o];e[a]&&(a=e[a]),r[l].push(a)}}obj.formula=r},obj.updateFormula=function(e,t){for(var n=/[A-Z]/,o=/[0-9]/,r="",i=null,l=null,s="",a=0;a<e.length;a++)n.exec(e[a])?(i=1,l=0,s+=e[a]):o.exec(e[a])?(l=i?1:0,s+=e[a]):(r=r+(s=i&&l?t[s]||s:s)+e[a],l=i=0,s="");return s&&(r+=s=i&&l?t[s]||s:s),r},function(e){for(var t="",n=0,o=0;o<e.length;o++)t+=1==(n='"'==e[o]?0==n?1:0:n)?e[o]:e[o].toUpperCase();return t}),scrollLeft=(obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(e){for(var t=0;t<e.length;t++){for(var n,o,r=[],i=e[t].split(":"),l=jexcel.getIdFromColumnName(i[0],!0),i=jexcel.getIdFromColumnName(i[1],!0),s=(l[0]<=i[0]?(n=l[0],i):(n=i[0],l))[0],a=(l[1]<=i[1]?(o=l[1],i):(o=i[1],l))[1],c=o;c<=a;c++)for(var u=n;u<=s;u++)r.push(jexcel.getColumnNameFromId([u,c]));expression=expression.replace(e[t],r.join(","))}},tokens=(expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2"),expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g)),tokens=(tokens&&tokens.length&&tokensUpdate(tokens),expression.match(/([A-Z]+[0-9]+)/g));if(tokens&&-1<tokens.indexOf(parentId))return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={},position,value,value,number;if(tokens)for(var i=0;i<tokens.length;i++){obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')&&(position=jexcel.getIdFromColumnName(tokens[i],1),value=void 0!==obj.options.data[position[1]]&&void 0!==obj.options.data[position[1]][position[0]]?obj.options.data[position[1]][position[0]]:"","="==(""+value).substr(0,1)&&(formulaResults[tokens[i]]?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),""==(""+value).trim()?formulaExpressions[tokens[i]]=null:value==Number(value)&&1==obj.options.autoCasting?formulaExpressions[tokens[i]]=Number(value):(number=obj.parseNumber(value,position[0]),1==obj.options.autoCasting&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'))}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(e){var res="#ERROR";console.log(e)}return res};return execute(expression,x,y)},obj.parseNumber=function(e,t){var t=t&&obj.options.columns[t].decimal?obj.options.columns[t].decimal:".",n=""+e;return(n=n.split(t))[0]=n[0].match(/[+-]?[0-9]/g),n[0]&&(n[0]=n[0].join("")),n[1]&&(n[1]=n[1].match(/[0-9]*/g).join("")),e=n[0]&&Number.isInteger(Number(n[0]))?n[1]?Number(n[0]+"."+n[1]):Number(n[0]+".00"):null},obj.row=function(e){},obj.col=function(e){},obj.up=function(e,t){e?0<obj.selectedCell[3]&&obj.up.visible(1,t?0:1):(0<obj.selectedCell[1]&&obj.up.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading?0==obj.selectedCell[1]||0==obj.selectedCell[3]?(obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):(e=parseInt(obj.tbody.firstChild.getAttribute("data-y")),obj.selectedCell[1]-e<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))):0<obj.options.pagination&&(t=obj.whichPage(obj.selectedCell[3]))!=obj.pageNumber&&obj.page(t),obj.updateScroll(1)},obj.up.visible=function(e,t){var n,o=0==e?(n=parseInt(obj.selectedCell[0]),parseInt(obj.selectedCell[1])):(n=parseInt(obj.selectedCell[2]),parseInt(obj.selectedCell[3]));if(0==t){for(var r=0;r<o;r++)if("none"!=obj.records[r][n].style.display&&"none"!=obj.rows[r].style.display){o=r;break}}else o=obj.up.get(n,o);0==e?(obj.selectedCell[0]=n,obj.selectedCell[1]=o):(obj.selectedCell[2]=n,obj.selectedCell[3]=o)},obj.up.get=function(e,t){e=parseInt(e);for(var n=(t=parseInt(t))-1;0<=n;n--)if("none"!=obj.records[n][e].style.display&&"none"!=obj.rows[n].style.display){if(obj.records[n][e].getAttribute("data-merged")&&obj.records[n][e]==obj.records[t][e])continue;t=n;break}return t},obj.down=function(e,t){e?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,t?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading?obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):0<obj.options.pagination&&(e=obj.whichPage(obj.selectedCell[3]))!=obj.pageNumber&&obj.page(e),obj.updateScroll(3)},obj.down.visible=function(e,t){var n,o=0==e?(n=parseInt(obj.selectedCell[0]),parseInt(obj.selectedCell[1])):(n=parseInt(obj.selectedCell[2]),parseInt(obj.selectedCell[3]));if(0==t){for(var r=obj.rows.length-1;o<r;r--)if("none"!=obj.records[r][n].style.display&&"none"!=obj.rows[r].style.display){o=r;break}}else o=obj.down.get(n,o);0==e?(obj.selectedCell[0]=n,obj.selectedCell[1]=o):(obj.selectedCell[2]=n,obj.selectedCell[3]=o)},obj.down.get=function(e,t){e=parseInt(e);for(var n=(t=parseInt(t))+1;n<obj.rows.length;n++)if("none"!=obj.records[n][e].style.display&&"none"!=obj.rows[n].style.display){if(obj.records[n][e].getAttribute("data-merged")&&obj.records[n][e]==obj.records[t][e])continue;t=n;break}return t},obj.right=function(e,t){e?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,t?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(e,t){var n,o=0==e?(n=parseInt(obj.selectedCell[0]),parseInt(obj.selectedCell[1])):(n=parseInt(obj.selectedCell[2]),parseInt(obj.selectedCell[3]));if(0==t){for(var r=obj.headers.length-1;n<r;r--)if("none"!=obj.records[o][r].style.display){n=r;break}}else n=obj.right.get(n,o);0==e?(obj.selectedCell[0]=n,obj.selectedCell[1]=o):(obj.selectedCell[2]=n,obj.selectedCell[3]=o)},obj.right.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var n=e+1;n<obj.headers.length;n++)if("none"!=obj.records[t][n].style.display){if(obj.records[t][n].getAttribute("data-merged")&&obj.records[t][n]==obj.records[t][e])continue;e=n;break}return e},obj.left=function(e,t){e?0<obj.selectedCell[2]&&obj.left.visible(1,t?0:1):(0<obj.selectedCell[0]&&obj.left.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(e,t){var n,o=0==e?(n=parseInt(obj.selectedCell[0]),parseInt(obj.selectedCell[1])):(n=parseInt(obj.selectedCell[2]),parseInt(obj.selectedCell[3]));if(0==t){for(var r=0;r<n;r++)if("none"!=obj.records[o][r].style.display){n=r;break}}else n=obj.left.get(n,o);0==e?(obj.selectedCell[0]=n,obj.selectedCell[1]=o):(obj.selectedCell[2]=n,obj.selectedCell[3]=o)},obj.left.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var n=e-1;0<=n;n--)if("none"!=obj.records[t][n].style.display){if(obj.records[t][n].getAttribute("data-merged")&&obj.records[t][n]==obj.records[t][e])continue;e=n;break}return e},obj.first=function(e,t){e?t?obj.selectedCell[3]=0:obj.left.visible(1,0):(t?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1!=obj.options.lazyLoading||0!=obj.selectedCell[1]&&0!=obj.selectedCell[3]?0<obj.options.pagination&&(e=obj.whichPage(obj.selectedCell[3]))!=obj.pageNumber&&obj.page(e):obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(e,t){e?t?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(t?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1!=obj.options.lazyLoading||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1?0<obj.options.pagination&&(e=obj.whichPage(obj.selectedCell[3]))!=obj.pageNumber&&obj.page(e):obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(e){for(var t=1!=obj.options.search&&1!=obj.options.filters||!obj.results?obj.rows:obj.results,n=100*(e=null!=e&&-1!=e?e:Math.ceil(t.length/100)-1),o=100*e+100,r=n=(n=(o=o>t.length?t.length:o)-100)<0?0:n;r<o;r++)1!=obj.options.search&&1!=obj.options.filters||!obj.results?obj.tbody.appendChild(obj.rows[r]):obj.tbody.appendChild(obj.rows[t[r]]),100<obj.tbody.children.length&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){var e=1!=obj.options.search&&1!=obj.options.filters||!obj.results?obj.rows:obj.results,t=0;if(100<e.length){var n=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(0<(n=1!=obj.options.search&&1!=obj.options.filters||!obj.results?n:e.indexOf(n)))for(var o=0;o<30;o++)-1<--n&&(1!=obj.options.search&&1!=obj.options.filters||!obj.results?obj.tbody.insertBefore(obj.rows[n],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[e[n]],obj.tbody.firstChild),100<obj.tbody.children.length)&&(obj.tbody.removeChild(obj.tbody.lastChild),t=1)}return t},obj.loadDown=function(){var e=1!=obj.options.search&&1!=obj.options.filters||!obj.results?obj.rows:obj.results,t=0;if(100<e.length){var n=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if((n=1!=obj.options.search&&1!=obj.options.filters||!obj.results?n:e.indexOf(n))<obj.rows.length-1)for(var o=0;o<=30;o++)n<e.length&&(1!=obj.options.search&&1!=obj.options.filters||!obj.results?obj.tbody.appendChild(obj.rows[n]):obj.tbody.appendChild(obj.rows[e[n]]),100<obj.tbody.children.length)&&(obj.tbody.removeChild(obj.tbody.firstChild),t=1),n+=1}return t},obj.loadValidation=function(){if(obj.selectedCell){var e=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,t=parseInt(obj.selectedCell[3]/100),n=parseInt(obj.rows.length/100);if(e!=t&&t<=n&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(t),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(l){var s;return l=l&&l.toLowerCase(),obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],l?(s=function(e){-1==obj.results.indexOf(e)&&obj.results.push(e)},obj.options.data.filter(function(e,t){if(function(e,t,n){for(var o=0;o<e.length;o++)if(0<=(""+e[o]).toLowerCase().search(t)||0<=(""+obj.records[n][o].innerHTML).toLowerCase().search(t))return 1}(e,l,t)){var n=obj.isRowMerged(t);if(n.length)for(var o=0;o<n.length;o++)for(var r=jexcel.getIdFromColumnName(n[o],!0),i=0;i<obj.options.mergeCells[n[o]][1];i++)s(r[1]+i);else s(t);return!0}return!1})):obj.results=null,obj.updateResult()},obj.updateResult=function(){for(var e=0,t=1==obj.options.lazyLoading?100:0<obj.options.pagination?obj.options.pagination:(obj.results||obj.rows).length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var n=0;n<obj.rows.length;n++)!obj.results||-1<obj.results.indexOf(n)?(e<t&&(obj.tbody.appendChild(obj.rows[n]),e++),obj.rows[n].style.display=""):obj.rows[n].style.display="none";return 0<obj.options.pagination&&obj.updatePagination(),obj.updateCornerPosition(),t},obj.whichPage=function(e){return 1!=obj.options.search&&1!=obj.options.filters||!obj.results||(e=obj.results.indexOf(e)),Math.ceil((parseInt(e)+1)/parseInt(obj.options.pagination))-1},obj.page=function(e){var t=obj.pageNumber,n=1!=obj.options.search&&1!=obj.options.filters||!obj.results?obj.rows:obj.results,o=parseInt(obj.options.pagination),r=(null!=e&&-1!=e||(e=Math.ceil(n.length/o)-1),(obj.pageNumber=e)*o),i=e*o+o;for(i>n.length&&(i=n.length),r<0&&(r=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var l=r;l<i;l++)1!=obj.options.search&&1!=obj.options.filters||!obj.results?obj.tbody.appendChild(obj.rows[l]):obj.tbody.appendChild(obj.rows[n[l]]);0<obj.options.pagination&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,e,t)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){var e=(1!=obj.options.search&&1!=obj.options.filters||!obj.results?obj.rows:obj.results).length;if(e){var t,n,e=Math.ceil(e/obj.options.pagination);obj.pageNumber<6?(t=1,n=e<10?e:10):e-obj.pageNumber<5?(t=(n=e)-9)<1&&(t=1):(t=obj.pageNumber-4,n=obj.pageNumber+5),1<t&&((o=document.createElement("div")).className="jexcel_page",o.innerHTML="<",o.title=1,obj.pagination.children[1].appendChild(o));for(var o,r=t;r<=n;r++)(o=document.createElement("div")).className="jexcel_page",o.innerHTML=r,obj.pagination.children[1].appendChild(o),obj.pageNumber==r-1&&o.classList.add("jexcel_page_selected");n<e&&((o=document.createElement("div")).className="jexcel_page",o.innerHTML=">",o.title=e,obj.pagination.children[1].appendChild(o)),obj.pagination.children[0].innerHTML=function(e){var n=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,function(e,t){return void 0!==n[t]?n[t]:e})}(obj.options.text.showingPage,obj.pageNumber+1,e)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(e){var t;0==obj.options.allowExport?console.error("Export not allowed"):(t="",t+=obj.copy(!1,obj.options.csvDelimiter,!0,e,!0),e=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8;"}),window.navigator&&window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(e,obj.options.csvFileName+".csv"):(t=document.createElement("a"),e=URL.createObjectURL(e),t.href=e,t.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(t),t.click(),t.parentNode.removeChild(t)))},obj.setHistory=function(e){var t;1!=obj.ignoreHistory&&(t=++obj.historyIndex,obj.history=obj.history=obj.history.slice(0,1+t),obj.history[t]=e)},obj.copy=function(e,t,n,o,r){t=t||"\t";for(var i,l,s=new RegExp(t,"ig"),a=[],c=[],u=[],d=[],p=[],f=obj.options.data[0].length,h=obj.options.data.length,g="",m=!1,b="",j="",v=0,y=0,x=0,w=0,C=!0,E=0;E<h;E++)for(var A=0;A<f;A++)e&&!obj.records[E][A].classList.contains("highlight")||(x<=A&&(x=A),w<=E&&(w=E));if(f===x+1&&h===w+1&&(C=!1),r&&1==obj.options.includeHeadersOnDownload||!r&&1==obj.options.includeHeadersOnCopy&&!C||o){if(obj.options.nestedHeaders&&0<obj.options.nestedHeaders.length)for(g=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders],E=0;E<g.length;E++){for(var L=[],A=0;A<g[E].length;A++){var M=parseInt(g[E][A].colspan);L.push(g[E][A].title);for(var I=0;I<M-1;I++)L.push("")}j+=L.join(t)+"\r\n"}m=!0}for(obj.style=[],E=0;E<h;E++){for(c=[],u=[],A=0;A<f;A++)e&&!obj.records[E][A].classList.contains("highlight")||(1==m&&a.push(obj.headers[A].textContent),(i=obj.options.data[E][A]).match&&(i.match(s)||i.match(/,/g)||i.match(/\n/)||i.match(/\"/))&&(i='"'+i.replace(new RegExp('"',"g"),'""')+'"'),c.push(i),"checkbox"==obj.options.columns[A].type||"radio"==obj.options.columns[A].type?l=i:(l=1==obj.options.stripHTMLOnCopy?obj.records[E][A].textContent:obj.records[E][A].innerHTML).match&&(l.match(s)||l.match(/,/g)||l.match(/\n/)||l.match(/\"/))&&(l='"'+l.replace(new RegExp('"',"g"),'""')+'"'),u.push(l),g=(g=obj.records[E][A].getAttribute("style")).replace("display: none;",""),obj.style.push(g||""));c.length&&(m&&(v=c.length,d.push(a.join(t))),d.push(c.join(t))),u.length&&(y++,m&&(p.push(a.join(t)),m=!1),p.push(u.join(t)))}r=(b=f==v&&h==y?j:b)+d.join("\r\n"),C=b+p.join("\r\n");if(n||(1==obj.options.copyCompatibility?obj.textarea.value=C:obj.textarea.value=r,obj.textarea.select(),document.execCommand("copy")),1==obj.options.copyCompatibility?obj.data=C:obj.data=r,obj.hashString=obj.hash(obj.data),!n){if(obj.removeCopyingSelection(),obj.highlighted)for(A=0;A<obj.highlighted.length;A++)obj.highlighted[A].classList.add("copying"),obj.highlighted[A].classList.contains("highlight-left")&&obj.highlighted[A].classList.add("copying-left"),obj.highlighted[A].classList.contains("highlight-right")&&obj.highlighted[A].classList.add("copying-right"),obj.highlighted[A].classList.contains("highlight-top")&&obj.highlighted[A].classList.add("copying-top"),obj.highlighted[A].classList.contains("highlight-bottom")&&obj.highlighted[A].classList.add("copying-bottom");obj.dispatch("oncopy",el,1==obj.options.copyCompatibility?p:d,obj.hashString)}return obj.data},obj.paste=function(e,t,n){var o=obj.dispatch("onbeforepaste",el,n,e,t);if(!1===o)return!1;var o=obj.hash(n=o?o:n),r=o==obj.hashString?obj.style:null;if(1==obj.options.copyCompatibility&&o==obj.hashString&&(n=obj.data),n=obj.parseCSV(n,"\t"),null!=e&&null!=t&&n){for(var i,l=0,s=0,a=[],c={},u={},d=0,p=parseInt(e),f=parseInt(t);i=n[s];){for(l=0,p=parseInt(e);null!=i[l];){var h=obj.updateCell(p,f,i[l]);if(a.push(h),obj.updateFormulaChain(p,f,a),r&&r[d]&&(c[h=jexcel.getColumnNameFromId([p,f])]=r[d],u[h]=obj.getStyle(h),obj.records[f][p].setAttribute("style",r[d]),d++),null!=i[++l]){if(p>=obj.headers.length-1){if(1!=obj.options.allowInsertColumn)break;obj.insertColumn()}p=obj.right.get(p,f)}}if(n[++s]){if(f>=obj.rows.length-1){if(1!=obj.options.allowInsertRow)break;obj.insertRow()}f=obj.down.get(e,f)}}obj.updateSelectionFromCoords(e,t,p,f),obj.setHistory({action:"setValue",records:a,selection:obj.selectedCell,newStyle:c,oldStyle:u}),obj.updateTable(),obj.dispatch("onpaste",el,n),obj.onafterchanges(el,a)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var e=document.querySelectorAll(".jexcel .copying"),t=0;t<e.length;t++)e[t].classList.remove("copying"),e[t].classList.remove("copying-left"),e[t].classList.remove("copying-right"),e[t].classList.remove("copying-top"),e[t].classList.remove("copying-bottom")},obj.historyProcessRow=function(e,t){var n=t.insertBefore?+t.rowNumber:t.rowNumber+1;if(1==obj.options.search&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),1==e){for(var o=t.numOfRows,r=n;r<o+n;r++)obj.rows[r].parentNode.removeChild(obj.rows[r]);obj.records.splice(n,o),obj.options.data.splice(n,o),obj.rows.splice(n,o),obj.conditionalSelectionUpdate(1,n,o+n-1)}else{obj.records=jexcel.injectArray(obj.records,n,t.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,n,t.rowData),obj.rows=jexcel.injectArray(obj.rows,n,t.rowNode);for(var i=0,r=n;r<t.numOfRows+n;r++)obj.tbody.insertBefore(t.rowNode[i],obj.tbody.children[r]),i++}0<obj.options.pagination&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(e,t){var n=t.insertBefore?t.columnNumber:t.columnNumber+1;if(1==e){var o=t.numOfColumns;obj.options.columns.splice(n,o);for(var r=n;r<o+n;r++)obj.headers[r].parentNode.removeChild(obj.headers[r]),obj.colgroup[r].parentNode.removeChild(obj.colgroup[r]);obj.headers.splice(n,o),obj.colgroup.splice(n,o);for(var i=0;i<t.data.length;i++){for(r=n;r<o+n;r++)obj.records[i][r].parentNode.removeChild(obj.records[i][r]);obj.records[i].splice(n,o),obj.options.data[i].splice(n,o)}if(obj.options.footers)for(i=0;i<obj.options.footers.length;i++)obj.options.footers[i].splice(n,o)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,n,t.columns),obj.headers=jexcel.injectArray(obj.headers,n,t.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,n,t.colgroup);for(var l=0,r=n;r<t.numOfColumns+n;r++)obj.headerContainer.insertBefore(t.headers[l],obj.headerContainer.children[r+1]),obj.colgroupContainer.insertBefore(t.colgroup[l],obj.colgroupContainer.children[r+1]),l++;for(i=0;i<t.data.length;i++)for(obj.options.data[i]=jexcel.injectArray(obj.options.data[i],n,t.data[i]),obj.records[i]=jexcel.injectArray(obj.records[i],n,t.records[i]),l=0,r=n;r<t.numOfColumns+n;r++)obj.rows[i].insertBefore(t.records[i][l],obj.rows[i].children[r+1]),l++;if(obj.options.footers)for(i=0;i<obj.options.footers.length;i++)obj.options.footers[i]=jexcel.injectArray(obj.options.footers[i],n,t.footers[i])}if(obj.options.nestedHeaders&&0<obj.options.nestedHeaders.length)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(i=0;i<obj.options.nestedHeaders.length;i++){var s=1==e?parseInt(obj.options.nestedHeaders[i][obj.options.nestedHeaders[i].length-1].colspan)-t.numOfColumns:parseInt(obj.options.nestedHeaders[i][obj.options.nestedHeaders[i].length-1].colspan)+t.numOfColumns;obj.options.nestedHeaders[i][obj.options.nestedHeaders[i].length-1].colspan=s,obj.thead.children[i].children[obj.thead.children[i].children.length-1].setAttribute("colspan",s)}else s=1==e?parseInt(obj.options.nestedHeaders[0].colspan)-t.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+t.numOfColumns,obj.options.nestedHeaders[0].colspan=s,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",s);obj.updateTableReferences()},obj.undo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory,n=(obj.ignoreEvents=!0,obj.ignoreHistory=!0,[]);if(0<=obj.historyIndex){var o=obj.history[obj.historyIndex--];if("insertRow"==o.action)obj.historyProcessRow(1,o);else if("deleteRow"==o.action)obj.historyProcessRow(0,o);else if("insertColumn"==o.action)obj.historyProcessColumn(1,o);else if("deleteColumn"==o.action)obj.historyProcessColumn(0,o);else if("moveRow"==o.action)obj.moveRow(o.newValue,o.oldValue);else if("moveColumn"==o.action)obj.moveColumn(o.newValue,o.oldValue);else if("setMerge"==o.action)obj.removeMerge(o.column,o.data);else if("setStyle"==o.action)obj.setStyle(o.oldValue,null,null,1);else if("setWidth"==o.action)obj.setWidth(o.column,o.oldValue);else if("setHeight"==o.action)obj.setHeight(o.row,o.oldValue);else if("setHeader"==o.action)obj.setHeader(o.column,o.oldValue);else if("setComments"==o.action)obj.setComments(o.column,o.oldValue[0],o.oldValue[1]);else if("orderBy"==o.action){for(var r=[],i=0;i<o.rows.length;i++)r[o.rows[i]]=i;obj.updateOrderArrow(o.column,o.order?0:1),obj.updateOrder(r)}else if("setValue"==o.action){for(var l=0;l<o.records.length;l++)n.push({x:o.records[l].x,y:o.records[l].y,newValue:o.records[l].oldValue}),o.oldStyle&&obj.resetStyle(o.oldStyle);obj.setValue(n),o.selection&&obj.updateSelectionFromCoords(o.selection[0],o.selection[1],o.selection[2],o.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onundo",el,o)},obj.redo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var n=obj.history[++obj.historyIndex];if("insertRow"==n.action)obj.historyProcessRow(0,n);else if("deleteRow"==n.action)obj.historyProcessRow(1,n);else if("insertColumn"==n.action)obj.historyProcessColumn(0,n);else if("deleteColumn"==n.action)obj.historyProcessColumn(1,n);else if("moveRow"==n.action)obj.moveRow(n.oldValue,n.newValue);else if("moveColumn"==n.action)obj.moveColumn(n.oldValue,n.newValue);else if("setMerge"==n.action)obj.setMerge(n.column,n.colspan,n.rowspan,1);else if("setStyle"==n.action)obj.setStyle(n.newValue,null,null,1);else if("setWidth"==n.action)obj.setWidth(n.column,n.newValue);else if("setHeight"==n.action)obj.setHeight(n.row,n.newValue);else if("setHeader"==n.action)obj.setHeader(n.column,n.newValue);else if("setComments"==n.action)obj.setComments(n.column,n.newValue[0],n.newValue[1]);else if("orderBy"==n.action)obj.updateOrderArrow(n.column,n.order),obj.updateOrder(n.rows);else if("setValue"==n.action){obj.setValue(n.records);for(var o=0;o<n.records.length;o++)n.oldStyle&&obj.resetStyle(n.newStyle);n.selection&&obj.updateSelectionFromCoords(n.selection[0],n.selection[1],n.selection[2],n.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onredo",el,n)},obj.getDropDownValue=function(e,t){var n=[];if(obj.options.columns[e]&&obj.options.columns[e].source){for(var o=[],r=obj.options.columns[e].source,i=0;i<r.length;i++)"object"==typeof r[i]?o[r[i].id]=r[i].name:o[r[i]]=r[i];for(var l=Array.isArray(t)?t:(""+t).split(";"),i=0;i<l.length;i++)"object"==typeof l[i]?n.push(o[l[i].id]):o[l[i]]&&n.push(o[l[i]])}else console.error("Invalid column");return 0<n.length?n.join("; "):""},obj.parseCSV=function(e,t){9==(e=e.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(e.length-1)&&(e+="\0"),t=t||",";for(var n=[],o=!1,r=0,i=0,l=0;l<e.length;l++){var s=e[l],a=e[l+1];n[r]=n[r]||[],n[r][i]=n[r][i]||"",'"'==s&&o&&'"'==a?(n[r][i]+=s,++l):'"'!=s?s!=t||o?"\r"!=s||"\n"!=a||o?"\n"==s&&!o||"\r"==s&&!o?(++r,i=0):n[r][i]+=s:(++r,i=0,++l):++i:o=!o}return n},obj.hash=function(e){var t,n=0;if(0!==e.length)for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},obj.onafterchanges=function(e,t){obj.dispatch("onafterchanges",e,t)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,"function"==typeof jexcel.build&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(e){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(e){e=obj.parseCSV(e,obj.options.csvDelimiter);if(1==obj.options.csvHeaders&&0<e.length)for(var t=e.shift(),n=0;n<t.length;n++)obj.options.columns[n]||(obj.options.columns[n]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),void 0===obj.options.columns[n].title&&(obj.options.columns[n].title=t[n]);obj.options.data=e,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data||e,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.prepareTable()},options&&null!=options.contextMenu?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(e,t,n,o){var r,i=[];return null==n?(1==obj.options.allowInsertColumn&&i.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(t),1)}}),1==obj.options.allowInsertColumn&&i.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(t),0)}}),1==obj.options.allowDeleteColumn&&i.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(t))}}),1==obj.options.allowRenameColumn&&i.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(t)}}),1==obj.options.columnSorting&&(i.push({type:"line"}),i.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(t,0)}}),i.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(t,1)}}))):(1==obj.options.allowInsertRow&&(i.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(n),1)}}),i.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(n))}})),1==obj.options.allowDeleteRow&&i.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(n))}}),t&&1==obj.options.allowComments&&(i.push({type:"line"}),r=obj.records[n][t].getAttribute("title")||"",i.push({title:r?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var e=prompt(obj.options.text.comments,r);e&&obj.setComments([t,n],e)}}),r)&&i.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([t,n],"")}})),i.push({type:"line"}),i.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&i.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(e){e&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],e)})}}),obj.options.allowExport&&i.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&i.push({title:obj.options.text.about,onclick:function(){!0===obj.options.about?alert(Version().print()):alert(obj.options.about)}}),i},obj.scrollControls=function(e){obj.wheelControls(),0<obj.options.freezeColumns&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),1!=obj.options.lazyLoading&&1!=obj.options.tableOverflow||obj.edition&&"jdropdown"!=e.target.className.substr(0,9)&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(e){1==obj.options.lazyLoading&&null==jexcel.timeControlLoading&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var e=0;if(0<obj.options.freezeColumns)for(var t=0;t<obj.options.freezeColumns;t++)e+=parseInt(obj.options.columns[t].width);return e},0);return obj.updateFreezePosition=function(){var e=0;if(50<(scrollLeft=obj.content.scrollLeft))for(var t=0;t<obj.options.freezeColumns;t++){0<t&&"hidden"!==obj.options.columns[t-1].type&&(e+=parseInt(obj.options.columns[t-1].width)),obj.headers[t].classList.add("jexcel_freezed"),obj.headers[t].style.left=e+"px";for(var n,o=0;o<obj.rows.length;o++)obj.rows[o]&&obj.records[o][t]&&(n=scrollLeft+(0<t?obj.records[o][t-1].style.width:0)-51+"px",obj.records[o][t].classList.add("jexcel_freezed"),obj.records[o][t].style.left=n)}else for(t=0;t<obj.options.freezeColumns;t++)for(obj.headers[t].classList.remove("jexcel_freezed"),obj.headers[t].style.left="",o=0;o<obj.rows.length;o++)obj.records[o][t]&&(obj.records[o][t].classList.remove("jexcel_freezed"),obj.records[o][t].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj},component;jexcel.setDictionary=function(e){jSuites.setDictionary(e)},jexcel.setExtensions=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)"function"==typeof e[t[n]]&&(jexcel[t[n]]=e[t[n]],jexcel.license)&&"function"==typeof e[t[n]].license&&e[t[n]].license(jexcel.license)},void 0!==formula&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null;const destroyEvents=function(e){e.removeEventListener("mouseup",jexcel.mouseUpControls),e.removeEventListener("mousedown",jexcel.mouseDownControls),e.removeEventListener("mousemove",jexcel.mouseMoveControls),e.removeEventListener("mouseover",jexcel.mouseOverControls),e.removeEventListener("dblclick",jexcel.doubleClickControls),e.removeEventListener("paste",jexcel.pasteControls),e.removeEventListener("contextmenu",jexcel.contextMenuControls),e.removeEventListener("touchstart",jexcel.touchStartControls),e.removeEventListener("touchend",jexcel.touchEndControls),e.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls)};return jexcel.destroy=function(e,t){var n;e.jexcel&&(n=e.jexcel.options.root||document,e.removeEventListener("DOMMouseScroll",e.jexcel.scrollControls),e.removeEventListener("mousewheel",e.jexcel.scrollControls),e.jexcel=null,e.innerHTML="",t)&&(destroyEvents(n),jexcel=null)},jexcel.build=function(e){destroyEvents(e),e.addEventListener("mouseup",jexcel.mouseUpControls),e.addEventListener("mousedown",jexcel.mouseDownControls),e.addEventListener("mousemove",jexcel.mouseMoveControls),e.addEventListener("mouseover",jexcel.mouseOverControls),e.addEventListener("dblclick",jexcel.doubleClickControls),e.addEventListener("paste",jexcel.pasteControls),e.addEventListener("contextmenu",jexcel.contextMenuControls),e.addEventListener("touchstart",jexcel.touchStartControls),e.addEventListener("touchend",jexcel.touchEndControls),e.addEventListener("touchcancel",jexcel.touchEndControls),e.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(e){var t,n,o;jexcel.current&&(jexcel.current.edition&&(27==e.which?(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),e.preventDefault()):13==e.which?"calendar"==jexcel.current.options.columns[jexcel.current.edition[2]].type?jexcel.current.closeEditor(jexcel.current.edition[0],!0):"dropdown"!=jexcel.current.options.columns[jexcel.current.edition[2]].type&&"autocomplete"!=jexcel.current.options.columns[jexcel.current.edition[2]].type&&((1==jexcel.current.options.wordWrap||1==jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap||200<jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length)&&e.altKey?(o=jexcel.current.edition[0].children[0],n=jexcel.current.edition[0].children[0].value,t=o.selectionStart,n=n.slice(0,t)+"\n"+n.slice(t),o.value=n,o.focus(),o.selectionStart=t+1,o.selectionEnd=t+1):jexcel.current.edition[0].children[0].blur()):9==e.which&&(["calendar","html"].includes(jexcel.current.options.columns[jexcel.current.edition[2]].type)?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur())),!jexcel.current.edition&&jexcel.current.selectedCell?37==e.which?(jexcel.current.left(e.shiftKey,e.ctrlKey),e.preventDefault()):39==e.which?(jexcel.current.right(e.shiftKey,e.ctrlKey),e.preventDefault()):38==e.which?(jexcel.current.up(e.shiftKey,e.ctrlKey),e.preventDefault()):40==e.which?(jexcel.current.down(e.shiftKey,e.ctrlKey),e.preventDefault()):36==e.which?(jexcel.current.first(e.shiftKey,e.ctrlKey),e.preventDefault()):35==e.which?(jexcel.current.last(e.shiftKey,e.ctrlKey),e.preventDefault()):46==e.which?1==jexcel.current.options.editable&&(jexcel.current.selectedRow?1==jexcel.current.options.allowDeleteRow&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?1==jexcel.current.options.allowDeleteColumn&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,"")):13==e.which?(e.shiftKey?jexcel.current.up():(1==jexcel.current.options.allowInsertRow&&1==jexcel.current.options.allowManualInsertRow&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),e.preventDefault()):9==e.which?(e.shiftKey?jexcel.current.left():(1==jexcel.current.options.allowInsertColumn&&1==jexcel.current.options.allowManualInsertColumn&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),e.preventDefault()):!e.ctrlKey&&!e.metaKey||e.shiftKey?jexcel.current.selectedCell&&1==jexcel.current.options.editable&&(n=jexcel.current.selectedCell[1],o=jexcel.current.selectedCell[0],"readonly"!=jexcel.current.options.columns[o].type)&&(32==e.keyCode?(e.preventDefault(),"checkbox"==jexcel.current.options.columns[o].type||"radio"==jexcel.current.options.columns[o].type?jexcel.current.setCheckRadioValue():jexcel.current.openEditor(jexcel.current.records[n][o],!0)):113==e.keyCode?jexcel.current.openEditor(jexcel.current.records[n][o],!1):(8==e.keyCode||48<=e.keyCode&&e.keyCode<=57||96<=e.keyCode&&e.keyCode<=111||187<=e.keyCode&&e.keyCode<=190||(String.fromCharCode(e.keyCode)==e.key||String.fromCharCode(e.keyCode).toLowerCase()==e.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(e.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[n][o],!0),"calendar"==jexcel.current.options.columns[o].type)&&e.preventDefault()):65==e.which?(jexcel.current.selectAll(),e.preventDefault()):83==e.which?(jexcel.current.download(),e.preventDefault()):89==e.which?(jexcel.current.redo(),e.preventDefault()):90==e.which?(jexcel.current.undo(),e.preventDefault()):67==e.which?(jexcel.current.copy(!0),e.preventDefault()):88==e.which?(1==jexcel.current.options.editable?jexcel.cutControls():jexcel.copyControls(),e.preventDefault()):86==e.which&&jexcel.pasteControls():e.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(e.target.value)},200)))},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(e){var o,t,n,r=(e=e||window.event).buttons?e.buttons:e.button||e.which,i=jexcel.getElement(e.target);if(i[0]?jexcel.current!=i[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=i[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&1==r){if(e.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(e.target.classList.contains("jexcel_corner"))1==jexcel.current.options.editable&&(jexcel.current.selectedCorner=!0);else{if(1==i[1])if(t=e.target.getAttribute("data-x")){var l=e.target.getBoundingClientRect();if(1==jexcel.current.options.columnResize&&l.width-e.offsetX<6){jexcel.current.resizing={mousePosition:e.pageX,column:t,width:l.width},jexcel.current.headers[t].classList.add("resizing");for(var s=0;s<jexcel.current.records.length;s++)jexcel.current.records[s][t]&&jexcel.current.records[s][t].classList.add("resizing")}else if(1==jexcel.current.options.columnDrag&&l.height-e.offsetY<6)if(jexcel.current.isColMerged(t).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target,column:t,destination:t},jexcel.current.headers[t].classList.add("dragging"),s=0;s<jexcel.current.records.length;s++)jexcel.current.records[s][t]&&jexcel.current.records[s][t].classList.add("dragging");else{var a,c=jexcel.current.selectedHeader&&(e.shiftKey||e.ctrlKey)?(a=jexcel.current.selectedHeader,t):(jexcel.current.selectedHeader==t&&1==jexcel.current.options.allowRenameColumn&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(t)},800)),a=jexcel.current.selectedHeader=t);jexcel.current.updateSelectionFromCoords(a,0,c,jexcel.current.options.data.length-1)}}else e.target.parentNode.classList.contains("jexcel_nested")&&(r=e.target.getAttribute("data-column")?(r=e.target.getAttribute("data-column").split(","),n=parseInt(r[0]),parseInt(r[r.length-1])):(n=0,jexcel.current.options.columns.length-1),jexcel.current.updateSelectionFromCoords(n,0,r,jexcel.current.options.data.length-1));else jexcel.current.selectedHeader=!1;2==i[1]?(n=e.target.getAttribute("data-y"),e.target.classList.contains("jexcel_row")?(l=e.target.getBoundingClientRect(),1==jexcel.current.options.rowResize&&l.height-e.offsetY<6?(jexcel.current.resizing={element:e.target.parentNode,mousePosition:e.pageY,row:n,height:l.height},e.target.parentNode.classList.add("resizing")):1==jexcel.current.options.rowDrag&&l.width-e.offsetX<6?jexcel.current.isRowMerged(n).length?console.error("Jspreadsheet: This row is part of a merged cell"):1==jexcel.current.options.search&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target.parentNode,row:n,destination:n},e.target.parentNode.classList.add("dragging")):(c=(a=jexcel.current.selectedRow&&(e.shiftKey||e.ctrlKey)?jexcel.current.selectedRow:jexcel.current.selectedRow=n,n),jexcel.current.updateSelectionFromCoords(0,a,jexcel.current.options.data[0].length-1,c))):e.target.classList.contains("jclose")&&e.target.clientWidth-e.offsetX<50&&e.offsetY<50?jexcel.current.closeEditor(jexcel.current.edition[0],!0):(r=(o=function(e){var t=e.getAttribute("data-x"),n=e.getAttribute("data-y");return t&&n?[t,n]:e.parentNode?o(e.parentNode):void 0})(e.target))&&(t=r[0],n=r[1],!jexcel.current.edition||jexcel.current.edition[2]==t&&jexcel.current.edition[3]==n||jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.edition||(e.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],t,n):jexcel.current.updateSelectionFromCoords(t,n)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null)):jexcel.current.selectedRow=!1,e.target.classList.contains("jexcel_page")&&("<"==e.target.textContent?jexcel.current.page(0):">"==e.target.textContent?jexcel.current.page(e.target.getAttribute("title")-1):jexcel.current.page(e.target.textContent-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(e){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var t=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),n=jexcel.current.getSelectedColumns();if(1<n.length){for(var o=[],r=0;r<n.length;r++)o.push(parseInt(jexcel.current.colgroup[n[r]].getAttribute("width")));o[n.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(n,t,o)}else jexcel.current.setWidth(jexcel.current.resizing.column,t,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var i=0;i<jexcel.current.records.length;i++)jexcel.current.records[i][jexcel.current.resizing.column]&&jexcel.current.records[i][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");t=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,t,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){t=e.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),i=0;i<jexcel.current.rows.length;i++)jexcel.current.records[i][jexcel.current.dragging.column]&&jexcel.current.records[i][jexcel.current.dragging.column].classList.remove("dragging");for(r=0;r<jexcel.current.headers.length;r++)jexcel.current.headers[r].classList.remove("dragging-left"),jexcel.current.headers[r].classList.remove("dragging-right");t&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{var l;jexcel.current.dragging.element.nextSibling?(l=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y")),jexcel.current.dragging.row<l&&--l):l=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y")),jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,l,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,0<jexcel.current.selection.length)&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection());jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(e){var t=(e=e||window.event).buttons?e.buttons:e.button||e.which;if(t||(jexcel.isMouseAction=!1),jexcel.current)if(1==jexcel.isMouseAction){if(jexcel.current.resizing)jexcel.current.resizing.column?(t=e.pageX-jexcel.current.resizing.mousePosition,0<jexcel.current.resizing.width+t&&(t=jexcel.current.resizing.width+t,jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",t),jexcel.current.updateCornerPosition())):(t=e.pageY-jexcel.current.resizing.mousePosition,0<jexcel.current.resizing.height+t&&(t=jexcel.current.resizing.height+t,jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",t),jexcel.current.updateCornerPosition()));else if(jexcel.current.dragging)if(jexcel.current.dragging.column){t=e.target.getAttribute("data-x");if(t)if(jexcel.current.isColMerged(t).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var n=0;n<jexcel.current.headers.length;n++)jexcel.current.headers[n].classList.remove("dragging-left"),jexcel.current.headers[n].classList.remove("dragging-right");jexcel.current.dragging.column==t?jexcel.current.dragging.destination=parseInt(t):e.target.clientWidth/2>e.offsetX?(jexcel.current.dragging.column<t?jexcel.current.dragging.destination=parseInt(t)-1:jexcel.current.dragging.destination=parseInt(t),jexcel.current.headers[t].classList.add("dragging-left")):(jexcel.current.dragging.column<t?jexcel.current.dragging.destination=parseInt(t):jexcel.current.dragging.destination=parseInt(t)+1,jexcel.current.headers[t].classList.add("dragging-right"))}}else{var t=e.target.getAttribute("data-y");t&&(jexcel.current.isRowMerged(t).length?console.error("Jspreadsheet: This row is part of a merged cell."):(t=e.target.clientHeight/2>e.offsetY?e.target.parentNode.nextSibling:e.target.parentNode,jexcel.current.dragging.element!=t&&(e.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,t),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))))}}else{var t=e.target.getAttribute("data-x"),o=e.target.getAttribute("data-y"),r=e.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),e.target.parentNode.parentNode&&e.target.parentNode.parentNode.className&&(e.target.parentNode.parentNode.classList.contains("resizable")&&(e.target&&t&&!o&&r.width-(e.clientX-r.left)<6?(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="col-resize"):e.target&&!t&&o&&r.height-(e.clientY-r.top)<6&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="row-resize")),e.target.parentNode.parentNode.classList.contains("draggable"))&&(e.target&&!t&&o&&r.width-(e.clientX-r.left)<6||e.target&&t&&!o&&r.height-(e.clientY-r.top)<6)&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="move")}},jexcel.mouseOverControls=function(e){var t=(e=e||window.event).buttons?e.buttons:e.button||e.which;if(t||(jexcel.isMouseAction=!1),jexcel.current&&1==jexcel.isMouseAction){t=jexcel.getElement(e.target);if(t[0]){if(jexcel.current!=t[0].jexcel&&jexcel.current)return!1;var n,o,r=e.target.getAttribute("data-x"),i=e.target.getAttribute("data-y");jexcel.current.resizing||jexcel.current.dragging||(1==t[1]&&jexcel.current.selectedHeader&&(r=e.target.getAttribute("data-x"),n=jexcel.current.selectedHeader,o=r,jexcel.current.updateSelectionFromCoords(n,0,o,jexcel.current.options.data.length-1)),2==t[1]&&(e.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(n=jexcel.current.selectedRow,jexcel.current.updateSelectionFromCoords(0,n,jexcel.current.options.data[0].length-1,o=i)):jexcel.current.edition||r&&i&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(r,i):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],r,i))))}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(e){var t,n,o,r,i,l;jexcel.current&&(e.target.classList.contains("jexcel_corner")?0<jexcel.current.highlighted.length&&(l=jexcel.current.highlighted[0].getAttribute("data-x"),r=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,t=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),n=jexcel.current.records.length-1,jexcel.current.copyData(jexcel.current.records[r][l],jexcel.current.records[n][t])):e.target.classList.contains("jexcel_column_filter")?(o=e.target.getAttribute("data-x"),jexcel.current.openFilter(o)):(1==(r=jexcel.getElement(e.target))[1]&&1==jexcel.current.options.columnSorting&&(o=e.target.getAttribute("data-x"))&&jexcel.current.orderBy(o),2!=r[1]||1!=jexcel.current.options.editable||jexcel.current.edition||(l=(i=function(e){var t,n;if(e.parentNode)return t=e.getAttribute("data-x"),n=e.getAttribute("data-y"),t&&n?e:i(e.parentNode)})(e.target))&&l.classList.contains("highlight")&&jexcel.current.openEditor(l)))},jexcel.copyControls=function(e){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(e){!jexcel.current||jexcel.current.edition||(jexcel.current.copy(!0),1==jexcel.current.options.editable&&jexcel.current.setValue(jexcel.current.highlighted,""))},jexcel.pasteControls=function(e){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||1==jexcel.current.options.editable&&(e&&e.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],e.clipboardData.getData("text")),e.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(e){var t,n;"buttons"in(e=e||window.event)?e.buttons:e.which||e.button,jexcel.current&&(jexcel.current.edition?e.preventDefault():jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)&&(n=e.target.getAttribute("data-x"),t=e.target.getAttribute("data-y"),(n||t)&&((n<parseInt(jexcel.current.selectedCell[0])||n>parseInt(jexcel.current.selectedCell[2])||t<parseInt(jexcel.current.selectedCell[1])||t>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(n,t,n,t),n=jexcel.current.options.contextMenu(jexcel.current,n,t,e),jexcel.current.contextMenu.contextmenu.open(e,n),e.preventDefault())))},jexcel.touchStartControls=function(e){var t,n=jexcel.getElement(e.target);n[0]?jexcel.current!=n[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=n[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition&&(t=e.target.getAttribute("data-x"),n=e.target.getAttribute("data-y"),t)&&n&&(jexcel.current.updateSelectionFromCoords(t,n),jexcel.timeControl=setTimeout(function(){"color"==jexcel.current.options.columns[t].type?jexcel.tmpElement=null:jexcel.tmpElement=e.target,jexcel.current.openEditor(e.target,!1,e)},500))},jexcel.touchEndControls=function(e){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&"INPUT"==jexcel.tmpElement.children[0].tagName&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(e,t){for(var n,o,r=[],i=e.classList.contains("jexcel_tabs")?(o=e.children[0],e.children[1]):(e.innerHTML="",e.classList.add("jexcel_tabs"),e.jexcel=[],n=document.createElement("div"),o=e.appendChild(n),n=document.createElement("div"),e.appendChild(n)),l=[],s=[],a=0;a<t.length;a++){l[a]=document.createElement("div"),l[a].classList.add("jexcel_tab");var c=jexcel(l[a],t[a]);i.appendChild(l[a]),r[a]=e.jexcel.push(c),s[a]=document.createElement("div"),s[a].classList.add("jexcel_tab_link"),s[a].setAttribute("data-spreadsheet",e.jexcel.length-1),s[a].innerHTML=t[a].sheetName,s[a].onclick=function(){for(var e=0;e<o.children.length;e++)o.children[e].classList.remove("selected"),i.children[e].style.display="none";var t=this.getAttribute("data-spreadsheet");i.children[t].style.display="block",o.children[t].classList.add("selected")},o.appendChild(s[a])}for(var u=0;u<o.children.length;u++)o.children[u].classList.remove("selected"),i.children[u].style.display="none";return o.children[o.children.length-1].classList.add("selected"),i.children[o.children.length-1].style.display="block",r},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(e,n){function o(g){var m=[];return g.SheetNames.forEach(function(e){var t={rows:[],columns:[],data:[],style:{}};if((p=g.Sheets[t.sheetName=e]["!cols"])&&p.length)for(var n=0;n<p.length;n++)t.columns[n]={},p[n]&&p[n].wpx&&(t.columns[n].width=p[n].wpx+"px");if((p=g.Sheets[e]["!rows"])&&p.length)for(n=0;n<p.length;n++)p[n]&&p[n].hpx&&(t.rows[n]={},t.rows[n].height=p[n].hpx+"px");if((p=g.Sheets[e]["!merges"])&&0<p.length)for(t.mergeCells=[],n=0;n<p.length;n++){var o=p[n].s.c,r=p[n].s.r,i=p[n].e.c,l=p[n].e.r,s=jexcel.getColumnNameFromId([o,r]);t.mergeCells[s]=[i-o+1,l-r+1]}for(var a,c,u=0,d=0,p=Object.keys(g.Sheets[e]),n=0;n<p.length;n++)"!"!=p[n].substr(0,1)&&(a=g.Sheets[e][p[n]],c=jexcel.getIdFromColumnName(p[n],!0),t.data[c[1]]||(t.data[c[1]]=[]),t.data[c[1]][c[0]]=a.f?"="+a.f:a.w,u<c[0]&&(u=c[0]),d<c[1]&&(d=c[1]),a.style&&0<Object.keys(a.style).length&&(t.style[p[n]]=a.style),a.s)&&a.s.fgColor&&(t.style[p[n]]&&(t.style[p[n]]+=";"),t.style[p[n]]+="background-color:#"+a.s.fgColor.rgb);for(var f=t.columns,h=0;h<=d;h++)for(n=0;n<=u;n++)t.data[h]||(t.data[h]=[]),t.data[h][n]||f<n&&(t.data[h][n]="");m.push(t)}),m}var r;(r=new XMLHttpRequest).open("GET",e,!0),"undefined"!=typeof Uint8Array?(r.responseType="arraybuffer",r.onload=function(e){var t=r.response,t=new Uint8Array(t),t=XLSX.read(t,{type:"array",cellFormula:!0,cellStyles:!0});n(o(t))}):(r.setRequestHeader("Accept-Charset","x-user-defined"),r.onreadystatechange=function(){var e;4==r.readyState&&200==r.status&&(e=convertResponseBodyToText(r.responseBody),e=XLSX.read(e,{type:"binary",cellFormula:!0,cellStyles:!0}),n(o(e)))}),r.send()},jexcel.validLetter=function(e){return e.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(e,t,n){return e.slice(0,t).concat(n).concat(e.slice(t))},jexcel.getColumnName=function(e){var t="";return 701<e?t=(t+=String.fromCharCode(64+parseInt(e/676)))+String.fromCharCode(64+parseInt(e%676/26)):25<e&&(t+=String.fromCharCode(64+parseInt(e/26))),t+String.fromCharCode(65+e%26)},jexcel.getIdFromColumnName=function(e,t){var n=/^[a-zA-Z]+/.exec(e);if(n){for(var o=0,r=0;r<n[0].length;r++)o+=parseInt(n[0].charCodeAt(r)-64)*Math.pow(26,n[0].length-1-r);--o<0&&(o=0);var i=parseInt(/[0-9]+$/.exec(e));0<i&&i--,e=1==t?[o,i]:o+"-"+i}return e},jexcel.getColumnNameFromId=function(e){return Array.isArray(e)||(e=e.split("-")),jexcel.getColumnName(parseInt(e[0]))+(parseInt(e[1])+1)},jexcel.getElement=function(e){var n=0,o=0;return function e(t){t.className&&t.classList.contains("jexcel_container")&&(o=t),"THEAD"==t.tagName?n=1:"TBODY"==t.tagName&&(n=2),!t.parentNode||o||e(t.parentNode)}(e),[o,n]},jexcel.doubleDigitFormat=function(e){return e=1==(e=""+e).length?"0"+e:e},jexcel.createFromTable=function(e,o){if("TABLE"==e.tagName){(o=o||{}).columns=[],o.data=[];var t=e.querySelectorAll("colgroup > col");if(t.length)for(var r=0;r<t.length;r++){var n=(n=t[r].style.width)||t[r].getAttribute("width");n&&(o.columns[r]||(o.columns[r]={}),o.columns[r].width=n)}var i=function(e){var t=e.getBoundingClientRect(),n=50<t.width?t.width:50;o.columns[r]||(o.columns[r]={}),e.getAttribute("data-celltype")?o.columns[r].type=e.getAttribute("data-celltype"):o.columns[r].type="text",o.columns[r].width=n+"px",o.columns[r].title=e.innerHTML,o.columns[r].align=e.style.textAlign||"center",(t=e.getAttribute("name"))&&(o.columns[r].name=t),(t=e.getAttribute("id"))&&(o.columns[r].id=t),(t=e.getAttribute("data-mask"))&&(o.columns[r].mask=t)},l=[],s=e.querySelectorAll(":scope > thead > tr");if(s.length){for(var a=0;a<s.length-1;a++){for(var c=[],r=0;r<s[a].children.length;r++){var u={title:s[a].children[r].textContent,colspan:s[a].children[r].getAttribute("colspan")||1};c.push(u)}l.push(c)}for(s=s[s.length-1].children,r=0;r<s.length;r++)i(s[r])}var d=0,p={},f={},h={},g={},m=e.querySelectorAll(":scope > tr, :scope > tbody > tr");for(a=0;a<m.length;a++)if(o.data[d]=[],1!=o.parseTableFirstRowAsHeader||s.length||0!=a){for(r=0;r<m[a].children.length;r++){(b=m[a].children[r].getAttribute("data-formula"))?"="!=b.substr(0,1)&&(b="="+b):b=m[a].children[r].innerHTML,o.data[d].push(b);var b,j=jexcel.getColumnNameFromId([r,a]),v=m[a].children[r].getAttribute("class"),v=(v&&(g[j]=v),parseInt(m[a].children[r].getAttribute("colspan"))||0),y=parseInt(m[a].children[r].getAttribute("rowspan"))||0,v=((v||y)&&(p[j]=[v||1,y||1]),m[a].children[r].style&&"none"==m[a].children[r].style.display&&(m[a].children[r].style.display=""),m[a].children[r].getAttribute("style"));v&&(h[j]=v),m[a].children[r].classList.contains("styleBold")&&(h[j]?h[j]+="; font-weight:bold;":h[j]="font-weight:bold;")}m[a].style&&m[a].style.height&&(f[a]={height:m[a].style.height}),d++}else for(r=0;r<m[a].children.length;r++)i(m[a].children[r]);if(0<Object.keys(l).length&&(o.nestedHeaders=l),0<Object.keys(h).length&&(o.style=h),0<Object.keys(p).length&&(o.mergeCells=p),0<Object.keys(f).length&&(o.rows=f),0<Object.keys(g).length&&(o.classes=g),(m=e.querySelectorAll("tfoot tr")).length){for(var x=[],a=0;a<m.length;a++){var w=[];for(r=0;r<m[a].children.length;r++)w.push(m[a].children[r].textContent);x.push(w)}0<Object.keys(x).length&&(o.footers=x)}if(1==o.parseTableAutoCellType){var C=[];for(r=0;r<o.columns.length;r++){var E=!0,A=!0;for(C[r]=[],a=0;a<o.data.length;a++)b=o.data[a][r],C[r][b]||(C[r][b]=0),C[r][b]++,25<b.length&&(E=!1),10==b.length&&"-"==b.substr(4,1)&&"-"==b.substr(7,1)||(A=!1);var L=Object.keys(C[r]).length;A?o.columns[r].type="calendar":1==E&&1<L&&L<=parseInt(.1*o.data.length)&&(o.columns[r].type="dropdown",o.columns[r].source=Object.keys(C[r]))}}return o}console.log("Element is not a table")},jexcel.helpers=(component={getCaretIndex:function(e){var t,n=this.config.root||window,o=0,n=n.getSelection();return n&&0!==n.rangeCount&&((t=(n=n.getRangeAt(0)).cloneRange()).selectNodeContents(e),t.setEnd(n.endContainer,n.endOffset),o=t.toString().length),o},invert:function(e){for(var t=[],n=Object.keys(e),o=0;o<n.length;o++)t[e[n[o]]]=n[o];return t},getColumnName:function(e){var t="";return 701<e?t=(t+=String.fromCharCode(64+parseInt(e/676)))+String.fromCharCode(64+parseInt(e%676/26)):25<e&&(t+=String.fromCharCode(64+parseInt(e/26))),t+String.fromCharCode(65+e%26)},getColumnNameFromCoords:function(e,t){return component.getColumnName(parseInt(e))+(parseInt(t)+1)},getCoordsFromColumnName:function(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var n=0,o=0;o<t[0].length;o++)n+=parseInt(t[0].charCodeAt(o)-64)*Math.pow(26,t[0].length-1-o);--n<0&&(n=0);e=parseInt(/[0-9]+$/.exec(e))||null;return 0<e&&e--,[n,e]}},createFromTable:function(){},injectArray:function(e,t,n){return e.slice(0,t).concat(n).concat(e.slice(t))},parseCSV:function(e,t){t=t||",";for(var n=0,o=0,r=[[]],i=0,l=null,s=!1,a=!1,c=0;c<e.length;c++)if(r[o]||(r[o]=[]),r[o][n]||(r[o][n]=""),"\r"!=e[c])if("\n"!=e[c]&&e[c]!=t||0!=s&&1!=a&&l){if('"'==e[c]&&(s=!s),null===l){if(1==(l=s))continue}else if(!0===l&&!a&&'"'==e[c]){'"'==e[c+1]?(s=!0,r[o][n]+=e[c],c++):a=!0;continue}r[o][n]+=e[c]}else{var u,l=null,s=!1,a=!1;'"'==r[o][n][0]&&'"'==(u=r[o][n].trim())[u.length-1]&&(r[o][n]=u.substr(1,u.length-2)),"\n"==e[c]?(n=0,o++):++n>i&&(i=n)}for(var d=0;d<r.length;d++)for(c=0;c<=i;c++)void 0===r[d][c]&&(r[d][c]="");return r}},component),"undefined"!=typeof jQuery&&function(n){n.fn.jspreadsheet=n.fn.jexcel=function(e){var t=n(this).get(0);return t.jexcel?Array.isArray(t.jexcel)?t.jexcel[e][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):t.jexcel[e].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(n(this).get(0),e)}}(jQuery),jexcel};module.exports=factory()}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];return void 0!==t||(t=__webpack_module_cache__[e]={exports:{}},__webpack_modules__[e].call(t.exports,t,t.exports,__webpack_require__)),t.exports}var __webpack_exports__=__webpack_require__(138);return __webpack_exports__}),!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.jSuites=t():e.jSuites=t()}(this,function(){return n={195:function(e){e.exports=function(e){function i(e,t){this.highOrder=e,this.lowOrder=t}var t=[new i(1779033703,4089235720),new i(3144134277,2227873595),new i(1013904242,4271175723),new i(2773480762,1595750129),new i(1359893119,2917565137),new i(2600822924,725511199),new i(528734635,4215389547),new i(1541459225,327033209)],n=[new i(1116352408,3609767458),new i(1899447441,602891725),new i(3049323471,3964484399),new i(3921009573,2173295548),new i(961987163,4081628472),new i(1508970993,3053834265),new i(2453635748,2937671579),new i(2870763221,3664609560),new i(3624381080,2734883394),new i(310598401,1164996542),new i(607225278,1323610764),new i(1426881987,3590304994),new i(1925078388,4068182383),new i(2162078206,991336113),new i(2614888103,633803317),new i(3248222580,3479774868),new i(3835390401,2666613458),new i(4022224774,944711139),new i(264347078,2341262773),new i(604807628,2007800933),new i(770255983,1495990901),new i(1249150122,1856431235),new i(1555081692,3175218132),new i(1996064986,2198950837),new i(2554220882,3999719339),new i(2821834349,766784016),new i(2952996808,2566594879),new i(3210313671,3203337956),new i(3336571891,1034457026),new i(3584528711,2466948901),new i(113926993,3758326383),new i(338241895,168717936),new i(666307205,1188179964),new i(773529912,1546045734),new i(1294757372,1522805485),new i(1396182291,2643833823),new i(1695183700,2343527390),new i(1986661051,1014477480),new i(2177026350,1206759142),new i(2456956037,344077627),new i(2730485921,1290863460),new i(2820302411,3158454273),new i(3259730800,3505952657),new i(3345764771,106217008),new i(3516065817,3606008344),new i(3600352804,1432725776),new i(4094571909,1467031594),new i(275423344,851169720),new i(430227734,3100823752),new i(506948616,1363258195),new i(659060556,3750685593),new i(883997877,3785050280),new i(958139571,3318307427),new i(1322822218,3812723403),new i(1537002063,2003034995),new i(1747873779,3602036899),new i(1955562222,1575990012),new i(2024104815,1125592928),new i(2227730452,2716904306),new i(2361852424,442776044),new i(2428436474,593698344),new i(2756734187,3733110249),new i(3204031479,2999351573),new i(3329325298,3815920427),new i(3391569614,3928383900),new i(3515267271,566280711),new i(3940187606,3454069534),new i(4118630271,4000239992),new i(116418474,1914138554),new i(174292421,2731055270),new i(289380356,3203993006),new i(460393269,320620315),new i(685471733,587496836),new i(852142971,1086792851),new i(1017036298,365543100),new i(1126000580,2618297676),new i(1288033470,3409855158),new i(1501505948,4234509866),new i(1607167915,987167468),new i(1816402316,1246189591)],o=new Array(64);function r(e,t){var n=(65535&e.lowOrder)+(65535&t.lowOrder),o=(e.lowOrder>>>16)+(t.lowOrder>>>16)+(n>>>16),r=(65535&o)<<16|65535&n;return n=(65535&e.highOrder)+(65535&t.highOrder)+(o>>>16),new i((65535&(e.highOrder>>>16)+(t.highOrder>>>16)+(n>>>16))<<16|65535&n,r)}function l(e,t){return t<=32?new i(e.highOrder>>>t|e.lowOrder<<32-t,e.lowOrder>>>t|e.highOrder<<32-t):new i(e.lowOrder>>>t|e.highOrder<<32-t,e.highOrder>>>t|e.lowOrder<<32-t)}function s(e,t){return t<=32?new i(e.highOrder>>>t,e.lowOrder>>>t|e.highOrder<<32-t):new i(0,e.highOrder<<32-t)}a=8*(a=e,(e=unescape(encodeURIComponent(a))).length);var a;(e=function(e){for(var t=[],n=8*e.length,o=0;o<n;o+=8)t[o>>5]|=(255&e.charCodeAt(o/8))<<24-o%32;return t}(e))[a>>5]|=128<<24-a%32,e[31+(128+a>>10<<5)]=a;for(var c=0;c<e.length;c+=32){for(var u=t[0],d=t[1],p=t[2],f=t[3],h=t[4],g=t[5],m=t[6],b=t[7],j=0;j<80;j++)o[j]=j<16?new i(e[2*j+c],e[2*j+c+1]):(N=o[j-2],D=T=void 0,T=l(N,19),D=l(N,61),N=s(N,6),T=new i(T.highOrder^D.highOrder^N.highOrder,T.lowOrder^D.lowOrder^N.lowOrder),D=o[j-7],N=o[j-15],I=M=void 0,M=l(N,1),I=l(N,8),N=s(N,7),M=new i(M.highOrder^I.highOrder^N.highOrder,M.lowOrder^I.lowOrder^N.lowOrder),I=o[j-16],L=A=N=void 0,N=(65535&T.lowOrder)+(65535&D.lowOrder)+(65535&M.lowOrder)+(65535&I.lowOrder),A=(T.lowOrder>>>16)+(D.lowOrder>>>16)+(M.lowOrder>>>16)+(I.lowOrder>>>16)+(N>>>16),L=(65535&A)<<16|65535&N,N=(65535&T.highOrder)+(65535&D.highOrder)+(65535&M.highOrder)+(65535&I.highOrder)+(A>>>16),new i((65535&(T.highOrder>>>16)+(D.highOrder>>>16)+(M.highOrder>>>16)+(I.highOrder>>>16)+(N>>>16))<<16|65535&N,L)),A=b,D=T=void 0,T=l(M=h,14),D=l(M,18),M=l(M,41),I=new i(T.highOrder^D.highOrder^M.highOrder,T.lowOrder^D.lowOrder^M.lowOrder),N=g,L=m,E=new i((E=h).highOrder&N.highOrder^~E.highOrder&L.highOrder,E.lowOrder&N.lowOrder^~E.lowOrder&L.lowOrder),v=n[j],y=o[j],C=w=x=void 0,x=(65535&A.lowOrder)+(65535&I.lowOrder)+(65535&E.lowOrder)+(65535&v.lowOrder)+(65535&y.lowOrder),w=(A.lowOrder>>>16)+(I.lowOrder>>>16)+(E.lowOrder>>>16)+(v.lowOrder>>>16)+(y.lowOrder>>>16)+(x>>>16),C=(65535&w)<<16|65535&x,x=(65535&A.highOrder)+(65535&I.highOrder)+(65535&E.highOrder)+(65535&v.highOrder)+(65535&y.highOrder)+(w>>>16),w=new i((65535&(A.highOrder>>>16)+(I.highOrder>>>16)+(E.highOrder>>>16)+(v.highOrder>>>16)+(y.highOrder>>>16)+(x>>>16))<<16|65535&x,C),v=r((v=E=void 0,E=l(y=u,28),v=l(y,34),y=l(y,39),new i(E.highOrder^v.highOrder^y.highOrder,E.lowOrder^v.lowOrder^y.lowOrder)),(x=d,C=p,new i((E=u).highOrder&x.highOrder^E.highOrder&C.highOrder^x.highOrder&C.highOrder,E.lowOrder&x.lowOrder^E.lowOrder&C.lowOrder^x.lowOrder&C.lowOrder))),b=m,m=g,g=h,h=r(f,w),f=p,p=d,d=u,u=r(w,v);t[0]=r(u,t[0]),t[1]=r(d,t[1]),t[2]=r(p,t[2]),t[3]=r(f,t[3]),t[4]=r(h,t[4]),t[5]=r(g,t[5]),t[6]=r(m,t[6]),t[7]=r(b,t[7])}var v,y,x,w,C;var E;var A,L;var M,I;var N,T,D;for(var S=[],c=0;c<t.length;c++)S.push(t[c].highOrder),S.push(t[c].lowOrder);return function(e){for(var t,n="0123456789abcdef",o="",r=4*e.length,i=0;i<r;i+=1)t=e[i>>2]>>8*(3-i%4),o+=n.charAt(t>>4&15)+n.charAt(15&t);return o}(S)}}},o={},de.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return de.d(t,{a:t}),t},de.d=function(e,t){for(var n in t)de.o(t,n)&&!de.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},de.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},pe={},function(){"use strict";de.d(pe,{default:function(){return ue}});var i={two:function(e){return e=1==(e=""+e).length?"0"+e:e},focus:function(e){var t,n,o;e.innerText.length&&(t=document.createRange(),n=window.getSelection(),o=e.childNodes[e.childNodes.length-1],t.setStart(o,o.length),t.collapse(!0),n.removeAllRanges(),n.addRange(t),e.scrollLeft=e.scrollWidth)},isNumeric:function(e){return"string"==typeof e&&(e=e.trim()),!isNaN(e)&&null!==e&&""!==e},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},getNode:function(){var e=document.getSelection().anchorNode;return e?3==e.nodeType?e.parentNode:e:null},hash:function(e){var t,n,o=0;if(0!==e.length)for(t=0;t<e.length;t++)32<(n=e.charCodeAt(t))&&(o=(o<<5)-o+n,o|=0);return o},randomColor:function(e){for(var t,n=String("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,""),o=(n.length<6&&(n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]),[]),r=0;r<3;r++)t=parseInt(n.substr(2*r,2),16),t=Math.round(Math.min(Math.max(0,t+-.25*t),255)).toString(16),o.push(("00"+t).substr(t.length));return 1==e?"#"+i.two(o[0].toString(16))+i.two(o[1].toString(16))+i.two(o[2].toString(16)):o},getWindowWidth:function(){var e=window,t=document,n=t.documentElement,t=t.getElementsByTagName("body")[0];return e.innerWidth||n.clientWidth||t.clientWidth},getWindowHeight:function(){var e=window,t=document,n=t.documentElement,t=t.getElementsByTagName("body")[0];return e.innerHeight||n.clientHeight||t.clientHeight},getPosition:function(e){var t;return e=e.changedTouches&&e.changedTouches[0]?(t=e.changedTouches[0].pageX,e.changedTouches[0].pageY):(t=window.Event?e.pageX:e.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft),window.Event?e.pageY:e.clientY+(document.documentElement.scrollTop||document.body.scrollTop)),[t,e]},click:function(e){var t;e.click?e.click():(t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}),e.dispatchEvent(t))}},k=(i.findElement=function(e,n){var o=!1;return function e(t){t&&!o&&("function"==typeof n?o=n(t):"string"==typeof n&&t.classList&&t.classList.contains(n)&&(o=t)),t.parentNode&&!o&&e(t.parentNode)}(e),o},i);function r(e){return"undefined"!=typeof document&&document.dictionary&&document.dictionary[e]||e}t={now:function(e,t){var n=null,o=null,r=null,i=null,l=null,s=null,s=Array.isArray(e)?(n=e[0],o=e[1],r=e[2],i=e[3],l=e[4],e[5]):(n=(e=e||new Date).getFullYear(),o=e.getMonth()+1,r=e.getDate(),i=e.getHours(),l=e.getMinutes(),e.getSeconds());return 1==t?k.two(n)+"-"+k.two(o)+"-"+k.two(r):k.two(n)+"-"+k.two(o)+"-"+k.two(r)+" "+k.two(i)+":"+k.two(l)+":"+k.two(s)},toArray:function(e){var t=(e=e.split(-1!==e.indexOf("T")?"T":" "))[1],e=e[0].split("-"),n=parseInt(e[0]),o=parseInt(e[1]),e=parseInt(e[2]),r=0,i=0;return t&&(t=t.split(":"),r=parseInt(t[0]),i=parseInt(t[1])),[n,o,e,r,i,0]}},n=Date.UTC(1900,0,0),o=Date.UTC(1900,1,29),t.dateToNum=function(e){e=(e="string"==typeof e?new Date(e+"  GMT+0"):e).getTime();return o<=e&&(e+=864e5),(e-=n)/864e5},t.numToDate=function(e){e=n+864e5*e,o<=e&&(e-=864e5),e=new Date(e),e=[e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()];return t.now(e)},t.weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t.months=["January","February","March","April","May","June","July","August","September","October","November","December"],t.weekdaysShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t.monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var t,n,o,I=t,N={setDictionary:function(e){document.dictionary||(document.dictionary={});for(var t=null,n=null,o=Object.keys(e),n=0;n<o.length;n++)document.dictionary[o[n]]=e[o[n]];for(n=0;n<I.weekdays.length;n++)t=r(I.weekdays[n]),I.weekdays[n]&&(I.weekdays[n]=t,I.weekdaysShort[n]=t.substr(0,3));for(n=0;n<I.months.length;n++)(t=r(I.months[n]))&&(I.months[n]=t,I.monthsShort[n]=t.substr(0,3))},translate:r};function T(e,t){1==t?(document.jsuitesComponents=document.jsuitesComponents.filter(function(e){return null!==e}),setTimeout(function(){document.jsuitesComponents.push(e)},0)):0<=(t=document.jsuitesComponents.indexOf(e))&&document.jsuitesComponents.splice(t,1)}function O(n,o,r){if((n=n.split(".")).length){let e=this,t=null;for(;1<n.length;){if(t=n.shift(),!e.hasOwnProperty(t)){if(void 0===o)return;e[t]={}}e=e[t]}if(t=n.shift(),void 0!==o)return!0===r?delete e[t]:e[t]=o,!0;if(e)return e[t]}return!1}function H(o,e){var t,n={options:{}},r={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},i=null;for(t in r)e&&e.hasOwnProperty(t)?n.options[t]=e[t]:n.options[t]=r[t];o.classList.add("jsorting"),o.addEventListener("dragstart",function(e){var t=Array.prototype.indexOf.call(e.target.parentNode.children,e.target);i={element:e.target,o:t,d:t},e.target.style.opacity="0.25","function"==typeof n.options.ondragstart&&n.options.ondragstart(o,e.target,e)}),o.addEventListener("dragover",function(e){e.preventDefault(),l(e.target)&&i&&"true"==e.target.getAttribute("draggable")&&i.element!=e.target&&((n.options.direction?e.target.clientWidth/2>e.offsetX:e.target.clientHeight/2>e.offsetY)?e.target.parentNode.insertBefore(i.element,e.target):e.target.parentNode.insertBefore(i.element,e.target.nextSibling),i.d=Array.prototype.indexOf.call(e.target.parentNode.children,i.element))}),o.addEventListener("dragleave",function(e){e.preventDefault()}),o.addEventListener("dragend",function(e){e.preventDefault(),i&&("function"==typeof n.options.ondragend&&n.options.ondragend(o,i.element,e),i.o<i.d?e.target.parentNode.insertBefore(i.element,e.target.parentNode.children[i.o]):e.target.parentNode.insertBefore(i.element,e.target.parentNode.children[i.o].nextSibling),i.element.style.opacity="",i=null)}),o.addEventListener("drop",function(e){e.preventDefault(),i&&i.o!=i.d&&"function"==typeof n.options.ondrop&&n.options.ondrop(o,i.o,i.d,i.element,e.target,e),i.element.style.opacity="",i=null});for(var l=function(e){var n=!1;return function e(t){(n=!(!t.className||!t.classList.contains("jsorting"))||n)||e(t.parentNode)}(e),n},s=0;s<o.children.length;s++)o.children[s].hasAttribute("draggable")||o.children[s].setAttribute("draggable","true");return o.val=function(){for(var e,t=[],n=0;n<o.children.length;n++)(e=o.children[n].getAttribute("data-id"))&&t.push(e);return t},o}function B(o,r){function t(e){var t,n;null==i&&(t=!1,n=o.scrollTop,o.scrollTop+2*o.clientHeight>=o.scrollHeight?r.loadDown()&&(n==o.scrollTop&&(o.scrollTop=o.scrollTop-o.clientHeight),t=!0):o.scrollTop<=o.clientHeight&&r.loadUp()&&(n==o.scrollTop&&(o.scrollTop=o.scrollTop+o.clientHeight),t=!0),i=setTimeout(function(){i=null},r.timer),t)&&"function"==typeof r.onupdate&&r.onupdate()}r.loadUp&&"function"==typeof r.loadUp||(r.loadUp=function(){return!1}),r.loadDown&&"function"==typeof r.loadDown||(r.loadDown=function(){return!1}),r.timer||(r.timer=100);var i=null;return o.onscroll=function(e){t()},o.onwheel=function(e){t()},{}}u.send=function(e){e.data?Array.isArray(e.data)?e.send(e.data.join("&")):e.send(e.data):e.send(),u.requests.push(e)},u.exists=function(e,t){var n=new XMLHttpRequest;n.open("HEAD",e,!1),n.send(),n.status&&t(n.status)},u.pending=function(e){var t=0,n=u.requests;if(n&&n.length)for(var o=0;o<n.length;o++)e&&e!=n[o].options.group||t++;return t},u.oncomplete={},u.requests=[],u.queue=[];var R=u;function u(n,e){if(Array.isArray(n)){var t={instance:[],complete:e};if(0<n.length)for(var o=0;o<n.length;o++)(n[o].multiple=t).instance.push(u(n[o]));return t}if(n.data||(n.data={}),n.type&&(n.method=n.type),n.method||(n.method="GET"),n.dataType||(n.dataType="json"),n.data){var c=function(e,t){var n=[];if(e){var o=Object.keys(e);if(o.length)for(var r,i=0;i<o.length;i++)if(e[r=t?t+"["+o[i]+"]":o[i]]instanceof FileList)n[r]=e[o[i]];else if(null===e[o[i]]||void 0===e[o[i]])n[r]="";else if("object"==typeof e[o[i]])for(var l=c(e[o[i]],r),s=Object.keys(l),a=0;a<s.length;a++)n[s[a]]=l[s[a]];else n[r]=e[o[i]]}return n},r=c(n.data),i=Object.keys(r);if("GET"==n.method){if(i.length){for(var l=[],o=0;o<i.length;o++)l.push(i[o]+"="+encodeURIComponent(r[i[o]]));n.url.indexOf("?")<0&&(n.url+="?"),n.url+=l.join("&")}}else for(l=new FormData,o=0;o<i.length;o++)if(r[i[o]]instanceof FileList){if(r[i[o]].length)for(var s=0;s<r[i[o]].length;s++)l.append(i[o],r[i[o]][s],r[i[o]][s].name)}else l.append(i[o],r[i[o]])}var a=new XMLHttpRequest;return a.open(n.method,n.url,!0),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.contentType&&a.setRequestHeader("Content-Type",n.contentType),"POST"===n.method?a.setRequestHeader("Accept","application/json"):"blob"===n.dataType?a.responseType="blob":n.contentType||("json"===n.dataType?a.setRequestHeader("Content-Type","text/json"):"html"===n.dataType&&a.setRequestHeader("Content-Type","text/html")),!0!==n.cache&&(a.setRequestHeader("pragma","no-cache"),a.setRequestHeader("cache-control","no-cache")),!0===n.withCredentials&&(a.withCredentials=!0),"function"==typeof n.beforeSend&&n.beforeSend(a),"function"==typeof u.beforeSend&&u.beforeSend(a),document.ajax&&"function"==typeof document.ajax.beforeSend&&document.ajax.beforeSend(a),a.onload=function(){var e;if(200<=a.status&&a.status<300)if("json"===n.dataType)try{var t=JSON.parse(a.responseText);n.success&&"function"==typeof n.success&&n.success(t)}catch(e){n.error&&"function"==typeof n.error&&n.error(e,t)}else t="blob"===n.dataType?a.response:a.responseText,n.success&&"function"==typeof n.success&&n.success(t);else n.error&&"function"==typeof n.error&&n.error(a.responseText,a.status);u.queue&&0<u.queue.length&&u.send(u.queue.shift()),u.requests&&u.requests.length&&(e=u.requests.indexOf(a),u.requests.splice(e,1),u.requests.length||n.complete&&"function"==typeof n.complete&&n.complete(t),n.group&&u.oncomplete&&"function"==typeof u.oncomplete[n.group]&&!u.pending(n.group)&&(u.oncomplete[n.group](),u.oncomplete[n.group]=null),n.multiple)&&n.multiple.instance&&(e=n.multiple.instance.indexOf(a),n.multiple.instance.splice(e,1),n.multiple.instance.length||n.multiple.complete&&"function"==typeof n.multiple.complete&&n.multiple.complete(t))},a.options=n,a.data=l,!0===n.queue&&0<u.requests.length?u.queue.push(a):u.send(a),a}var D=function(){const t={loading:{}};return t.loading.show=function(e){t.loading.element||(t.loading.element=document.createElement("div"),t.loading.element.className="jloading"),document.body.appendChild(t.loading.element),0<e&&setTimeout(function(){t.loading.hide()},1e3*e)},t.loading.hide=function(){t.loading.element&&t.loading.element.parentNode&&document.body.removeChild(t.loading.element)},t.slideLeft=function(e,t,n){1==t?(e.classList.add("slide-left-in"),setTimeout(function(){e.classList.remove("slide-left-in"),"function"==typeof n&&n()},400)):(e.classList.add("slide-left-out"),setTimeout(function(){e.classList.remove("slide-left-out"),"function"==typeof n&&n()},400))},t.slideRight=function(e,t,n){!0===t?(e.classList.add("slide-right-in"),setTimeout(function(){e.classList.remove("slide-right-in"),"function"==typeof n&&n()},400)):(e.classList.add("slide-right-out"),setTimeout(function(){e.classList.remove("slide-right-out"),"function"==typeof n&&n()},400))},t.slideTop=function(e,t,n){!0===t?(e.classList.add("slide-top-in"),setTimeout(function(){e.classList.remove("slide-top-in"),"function"==typeof n&&n()},400)):(e.classList.add("slide-top-out"),setTimeout(function(){e.classList.remove("slide-top-out"),"function"==typeof n&&n()},400))},t.slideBottom=function(e,t,n){!0===t?(e.classList.add("slide-bottom-in"),setTimeout(function(){e.classList.remove("slide-bottom-in"),"function"==typeof n&&n()},400)):(e.classList.add("slide-bottom-out"),setTimeout(function(){e.classList.remove("slide-bottom-out"),"function"==typeof n&&n()},100))},t.fadeIn=function(e,t){e.style.display="",e.classList.add("fade-in"),setTimeout(function(){e.classList.remove("fade-in"),"function"==typeof t&&t()},2e3)},t.fadeOut=function(e,t){e.classList.add("fade-out"),setTimeout(function(){e.style.display="none",e.classList.remove("fade-out"),"function"==typeof t&&t()},1e3)},t}();l={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},d=function(e){return"currency"===e||"percentage"===e||"numeric"===e},p=function(e){var t;return e&&Number(e)==e?".":this.options.decimal||(this.locale?(t=Intl.NumberFormat(this.locale).format(1.1),this.options.decimal=t[1]):(e=e||this.mask,(t=new RegExp("0{1}(.{1})0+","ig").exec(e))&&t[1]&&1==t[1].length?(this.options.decimal=t[1],t[1]):((t=new RegExp("#{1}(.{1})#+","ig").exec(e))&&t[1]&&1==t[1].length?","===t[1]?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2),this.options.decimal||null)))},a=function(e,t){if(""==e)return"";t=t||p.call(this);t=!(!(t=(e=(""+e).split(t))[0].match(/[-]+/g))||!t.length);return e[0]=e[0].match(/[0-9]+/g),e[0]?(t&&e[0].unshift("-"),e[0]=e[0].join("")):t&&(e[0]="-"),e[0]||e[1]?(void 0!==e[1]&&(e[1]=e[1].match(/[0-9]+/g),e[1]?e[1]=e[1].join(""):e[1]=""),e):""},f=function(e,t){var n,o,r;return""!==e&&(n=p.call(this),o=this.options,""!==(e=a.call(this,e)))&&(r=null,e[0]&&(r="percent"===o.style?parseFloat(e[0])/100:parseFloat(e[0]+".1")),"-"!==e[0]&&"-00"!==e[0]||e[1]||!t||"deleteContentBackward"!=t.inputType)?(t=(t=new Intl.NumberFormat(this.locale,o).format(r)).split(n),"percent"===o.style&&-1!==t[0].indexOf("%")&&(t[0]=t[0].replace("%",""),t[2]="%"),void 0!==t[1]&&(r=t[1].replace(/[0-9]*/g,""))&&(t[2]=r),void 0!==e[1]?t[1]=n+e[1]:t[1]="",t.join("")):""},h=function(e,t){var n;if(void 0===e)return"DIV"==this.tagName?(n=0,(o=window.getSelection())&&0!==o.rangeCount&&((l=(r=o.getRangeAt(0)).cloneRange()).selectNodeContents(this),l.setEnd(r.endContainer,r.endOffset),n=l.toString().length),n):this.selectionStart;var o,r,i=g.call(this);if(t){for(var l=null,s=0;s<i.length;s++)!i[s].match(/[\-0-9]/g)&&"."!==i[s]&&","!==i[s]||(l=s);(l=null===l?i.indexOf(" "):l)<=e&&(e=l+1)}(e=e>i.length?i.length:e)&&("DIV"==this.tagName?(o=window.getSelection(),r=document.createRange(),this.childNodes[0]&&(r.setStart(this.childNodes[0],e),o.removeAllRanges(),o.addRange(r))):(this.selectionStart=e,this.selectionEnd=e))},g=function(e,t,n){if("DIV"==this.tagName){if(void 0===e)return e=this.innerText,this.value&&this.value.length>e.length?this.value:e;this.innerText!==e&&(this.innerText=e,t)&&h.call(this,t,n)}else{if(void 0===e)return this.value;this.value!==e&&(this.value=e,t)&&h.call(this,t,n)}},P=I.weekdays,V=I.weekdaysShort,s=I.months,_=I.monthsShort,c={YEAR:function(e,t){var n=""+(new Date).getFullYear();void 0===this.values[this.index]&&(this.values[this.index]=""),0<=parseInt(e)&&parseInt(e)<=10&&this.values[this.index].length<t&&(this.values[this.index]+=e),this.values[this.index].length==t&&(2==t?n=n.substr(0,2)+this.values[this.index]:3==t?n=n.substr(0,1)+this.values[this.index]:4==t&&(n=this.values[this.index]),this.date[0]=n,this.index++)},YYYY:function(e){c.YEAR.call(this,e,4)},YYY:function(e){c.YEAR.call(this,e,3)},YY:function(e){c.YEAR.call(this,e,2)},FIND:function(e,t){if(j(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&-1<this.event.inputType.indexOf("delete"))this.values[this.index]+=e;else{for(var n=0,o=0,r=(this.values[this.index]+e).toLowerCase(),i=0;i<t.length;i++)0==t[i].toLowerCase().indexOf(r)&&(n=i,o++);if(1<o)this.values[this.index]+=e;else if(1==o)return e=t[n].length-this.values[this.index].length-1,this.position+=e,this.values[this.index]=t[n],this.index++,n}},MMM:function(e){e=c.FIND.call(this,e,_);void 0!==e&&(this.date[1]=e+1)},MON:function(e){c.MMM.call(this,e)},MMMM:function(e){e=c.FIND.call(this,e,s);void 0!==e&&(this.date[1]=e+1)},MONTH:function(e){c.MMMM.call(this,e)},MMMMM:function(e){j(this.values[this.index])&&(this.values[this.index]="");for(var t=(this.values[this.index]+e).toLowerCase(),n=0;n<s.length;n++)if(0==s[n][0].toLowerCase().indexOf(t)){this.values[this.index]=s[n][0],this.date[1]=n+1,this.index++;break}},MM:function(e){j(this.values[this.index])?1<parseInt(e)&&parseInt(e)<10?(this.date[1]=this.values[this.index]="0"+e,this.index++):parseInt(e)<2&&(this.values[this.index]=e):(1==this.values[this.index]&&parseInt(e)<3||0==this.values[this.index]&&0<parseInt(e)&&parseInt(e)<10)&&(this.date[1]=this.values[this.index]+=e,this.index++)},M:function(e){var t=!1;0<=parseInt(e)&&parseInt(e)<10?j(this.values[this.index])?1<(this.values[this.index]=e)&&(this.date[1]=this.values[this.index],this.index++):1==this.values[this.index]&&parseInt(e)<3||0==this.values[this.index]&&0<parseInt(e)?(this.date[1]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t&&0<(e=parseInt(this.values[this.index]))&&e<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)},D:function(e){var t=!1;0<=parseInt(e)&&parseInt(e)<10?j(this.values[this.index])?(this.values[this.index]=e,3<parseInt(e)&&(this.date[2]=this.values[this.index],this.index++)):3==this.values[this.index]&&parseInt(e)<2||1==this.values[this.index]||2==this.values[this.index]||0==this.values[this.index]&&0<parseInt(e)?(this.date[2]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t&&0<(e=parseInt(this.values[this.index]))&&e<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)},DD:function(e){j(this.values[this.index])?3<parseInt(e)&&parseInt(e)<10?(this.date[2]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(3==this.values[this.index]&&parseInt(e)<2||(1==this.values[this.index]||2==this.values[this.index])&&parseInt(e)<10||0==this.values[this.index]&&0<parseInt(e)&&parseInt(e)<10)&&(this.date[2]=this.values[this.index]+=e,this.index++)},DDD:function(e){c.FIND.call(this,e,V)},DY:function(e){c.DDD.call(this,e)},DDDD:function(e){c.FIND.call(this,e,P)},DAY:function(e){c.DDDD.call(this,e)},HH12:function(e,t){j(this.values[this.index])?1<parseInt(e)&&parseInt(e)<10?(this.date[3]=this.values[this.index]=e=t?0+e:e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(1==this.values[this.index]&&parseInt(e)<3||this.values[this.index]<1&&parseInt(e)<10)&&(this.date[3]=this.values[this.index]+=e,this.index++)},HH24:function(e,t){0<=parseInt(e)&&parseInt(e)<10&&(null==this.values[this.index]||""==this.values[this.index]?2<parseInt(e)&&parseInt(e)<10?(this.date[3]=this.values[this.index]=e=t?0+e:e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(2==this.values[this.index]&&parseInt(e)<4||this.values[this.index]<2&&parseInt(e)<10)&&(t||"0"!==this.values[this.index]||(this.values[this.index]=""),this.date[3]=this.values[this.index]+=e,this.index++))},HH:function(e){c.HH24.call(this,e,1)},H:function(e){c.HH24.call(this,e,0)},"\\[H\\]":function(e){null==this.values[this.index]&&(this.values[this.index]=""),e.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=e:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(e,t){null==this.values[this.index]||""==this.values[this.index]?5<parseInt(e)&&parseInt(e)<10?(this.date[t]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):parseInt(e)<10&&(this.date[t]=this.values[this.index]+=e,this.index++)},MI:function(e){c.N60.call(this,e,4)},SS:function(e){c.N60.call(this,e,5)},"AM/PM":function(e){void 0===this.values[this.index]&&(this.values[this.index]=""),""===this.values[this.index]?e.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":e.match(/p/i)&&(this.values[this.index]+="P"):"A"!==this.values[this.index]&&"P"!==this.values[this.index]||(this.values[this.index]+="M",this.index++)},WD:function(e){void 0===this.values[this.index]&&(this.values[this.index]=""),0<=parseInt(e)&&parseInt(e)<7&&(this.values[this.index]=e),1==this.values[this.index].length&&this.index++},"0{1}(.{1}0+)?":function(e){var t=p.call(this),n=!1,o=(j(this.values[this.index])?this.values[this.index]="":"-"==this.values[this.index]&&(n=!0),a.call(this,this.values[this.index],t));o&&(this.values[this.index]=o.join(t)),0<=parseInt(e)&&parseInt(e)<10?("0"==this.values[this.index]&&0<e?this.values[this.index]="":"-0"==this.values[this.index]&&0<e&&(this.values[this.index]="-"),("0"!=this.values[this.index]&&"-0"!=this.values[this.index]||e==t)&&(this.values[this.index]+=e)):t&&e==t?-1==this.values[this.index].indexOf(t)&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=e):"-"==e&&(n=!0),!0===n&&"-"!==this.values[this.index][0]&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?%":function(e){c["0{1}(.{1}0+)?"].call(this,e),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&-1==this.values[this.index].indexOf("%")&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(e){c["0{1}(.{1}0+)?"].call(this,e);var e=p.call(this),t=this.tokens[this.index].substr(1,1),n="-"===this.values[this.index][0],o=a.call(this,this.values[this.index],e);if(""!==o){if(r=o[0].match(/[0-9]/g)){for(var r,i=[],l=0,s=(r=r.join("")).length-1;0<=s;s--)i.push(r[s]),++l%3||i.push(t);i=i.reverse(),o[0]=i.join(""),o[0].substr(0,1)==t&&(o[0]=o[0].substr(1))}else o[0]="";this.values[this.index]=o.join(e),n&&(this.values[this.index]="-"+this.values[this.index])}},0:function(e){e.match(/[0-9]/g)&&(this.values[this.index]=e,this.index++)},"[0-9a-zA-Z$]+":function(e){j(this.values[this.index])&&(this.values[this.index]="");var t=this.tokens[this.index];t[this.values[this.index].length]==e?(this.values[this.index]+=e,this.values[this.index]==t&&this.index++):(this.values[this.index]=t,this.index++,e.match(/[\-0-9]/g)&&this.position--)},A:function(e){e.match(/[a-zA-Z]/gi)&&(this.values[this.index]=e,this.index++)},".":function(e){c["[0-9a-zA-Z$]+"].call(this,e)},"@":function(e){j(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=e}},m=function(e){t="general"==this.type?[].concat(l.general):[].concat(l.currency,l.datetime,l.percentage,l.numeric,l.text,l.general);var t=new RegExp(t.join("|"),"gi");return e.match(t)},b=function(e){var t;t=this.type?"text"==this.type?["text"]:"general"==this.type?["general"]:"datetime"==this.type?["numeric","datetime","general"]:["currency","percentage","numeric","general"]:Object.keys(l);for(var n=0;n<t.length;n++)for(var o=t[n],r=0;r<l[o].length;r++){var i=new RegExp(l[o][r],"gi");if(e.match(i))return{type:o,method:l[o][r]}}},y.getType=v,y.prepare=function(e,t){return m.call(t=t||{},e)},y.apply=function(e){var t=g.call(e.target);1==e.key.length&&(t+=e.key),g.call(e.target,y(t,e.target.getAttribute("data-mask")))},y.run=function(e,t,n){return y(e,{mask:t,decimal:n})},y.extract=function(e,t,n){var o,r,i;return j(e)||"object"!=typeof t?e:((t=Object.assign({},t)).options||(t.options={}),!t.mask&&t.format&&(t.mask=t.format),t.mask&&(-1!==t.mask.indexOf(";")&&(o=t.mask.split(";"),t.mask=o[0]),t.mask=t.mask.replace(new RegExp(/\[h]/),"|h|"),t.mask=t.mask.replace(new RegExp(/\[.*?\]/),""),t.mask=t.mask.replace(new RegExp(/\|h\|/),"[h]")),p.call(t,t.mask),r=o=null,"percent"==t.type||"percent"==t.options.style?o="percentage":t.mask&&(o=v.call(t,t.mask)),"general"===o?(i=y(e,t,!0),r=e):"datetime"===o?(e instanceof Date&&(e=y.getDateString(e,t.mask)),i=y(e,t,!0),r=k.isNumeric(e)?e:function(){var e,t="";return this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]?(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5])&&(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),e=I.now(this.date),t=I.dateToNum(e),this.date[4])&&(t+=parseFloat(this.date[4]/60)):(t=-1!==this.mask.toLowerCase().indexOf("[h]")?parseInt(this.date[3]):(e=parseInt(this.date[3]))<13&&-1!==this.values.indexOf("PM")?(e+12)%24:e%24,this.date[4]&&(t+=parseFloat(this.date[4]/60)),this.date[5]&&(t+=parseFloat(this.date[5]/3600)),t/=24),t=isNaN(t)?"":t}.call(i)):(r=q.call(t,e),"percentage"===o&&-1!==e.indexOf("%")&&(r/=100),i=t),i.value=r,!i.type&&o&&(i.type=o),n?i:r)},y.render=function(e,t,n){if(!j(e)&&"object"==typeof t){(t=Object.assign({},t)).options||(t.options={}),!t.mask&&t.format&&(t.mask=t.format),t.mask&&(-1!==t.mask.indexOf(";")&&(i=t.mask.split(";"),n||(i[0]=i[0].replace(new RegExp(/_\)/g),""),i[0]=i[0].replace(new RegExp(/_\(/g),"")),t.mask=i[0]),t.mask=t.mask.replace(new RegExp(/\[h]/),"|h|"),t.mask=t.mask.replace(new RegExp(/\[.*?\]/),""),t.mask=t.mask.replace(new RegExp(/\|h\|/),"[h]"));var o=null,r=("percent"==t.type||"percent"==t.options.style?o="percentage":t.mask?o=v.call(t,t.mask):e instanceof Date&&(o="datetime"),!1);if("datetime"==o||"calendar"==t.type)(i=y.getDateString(e,t.mask))&&(e=i),t.mask&&n&&(r=!0);else if("percentage"==o&&(e*=100),"number"==typeof e){var i=null;if(t.mask&&n&&-1===(""+e).indexOf("e")){var l=p.call(t,t.mask);i=-1!==t.mask.indexOf(l)?(l=(l=""+(l=t.mask.split(l))[1].match(/[0-9]+/g)).length,e.toFixed(l)):e.toFixed(0)}else if(t.locale&&n){l=(""+e).split(".");if(t.options){void 0===l[1]&&(l[1]="");var s=l[1].length;if(t.options.minimumFractionDigits>s)for(var a=0;a<t.options.minimumFractionDigits-s;a++)l[1]+="0"}i=l[1].length?l.join("."):l[0];s=l[1].length;t.options&&t.options.maximumFractionDigits<s&&(i=parseFloat(i).toFixed(t.options.maximumFractionDigits))}else i=(""+ +e).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(e,t,n,o,r){return r<0?t+"0."+Array(1-r-n.length).join(0)+n+o:t+n+o+Array(r-o.length+1).join(0)});null!==i&&(e=i,p.call(t,t.mask),t.options.decimal)&&(e=e.replace(".",t.options.decimal))}else t.mask&&n&&(r=!0);if(r){var c=t.mask.length-e.length;if(0<c)for(a=0;a<c;a++)e+=" "}if(e=y(e,t),n&&"numeric"===o){i=t.mask.match(new RegExp(/^[0]+$/gm));if(i&&1===i.length){var u=i[0].length;if(3<u)for(e=""+e;e.length<u;)e="0"+e}}}return e},y.set=function(e,t){t&&(e.setAttribute("data-mask",t),t=new Event("input",{bubbles:!0,cancelable:!0}),e.dispatchEvent(t))},y.extractDateFromString=function(e,t){t=y(e,{mask:t},!0);return 0<e&&Number(e)==e&&(t.values.join("")!==t.value||"numeric"==t.type)?(e=new Date(Math.round(86400*(e-25569)*1e3))).getFullYear()+"-"+k.two(e.getMonth())+"-"+k.two(e.getDate())+" 00:00:00":(e=!1,t.values.length===t.tokens.length&&t.values[t.values.length-1].length>=t.tokens[t.tokens.length-1].length&&(e=!0),t.date[0]&&t.date[1]&&(t.date[2]||e)?(t.date[2]||(t.date[2]=1),t.date[0]+"-"+k.two(t.date[1])+"-"+k.two(t.date[2])+" "+k.two(t.date[3])+":"+k.two(t.date[4])+":"+k.two(t.date[5])):"")},y.getDateString=function(e,t){if(0<=(t=(t=(t=t||{})&&"object"==typeof t?t.format:t)||"YYYY-MM-DD").indexOf("[h]"))return n=0,e&&k.isNumeric(e)&&(n=parseFloat(24*Number(e)),0<=t.indexOf("mm"))&&(l=(s=(""+n).split("."))[1]?(l=60*parseFloat("0."+s[1]),parseFloat(l.toFixed(2))):0,n=parseInt(s[0])+":"+k.two(l)),n;e instanceof Date?e=I.now(e):e&&k.isNumeric(e)&&(e=I.numToDate(e));for(var n=new RegExp(["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."].join("|"),"gi"),o=t.match(n),r=0;r<o.length;r++)"MM"==o[r].toUpperCase()&&(o[r-1]&&0<=o[r-1].toUpperCase().indexOf("H")||o[r-2]&&0<=o[r-2].toUpperCase().indexOf("H")||o[r+1]&&0<=o[r+1].toUpperCase().indexOf("S")||o[r+2]&&0<=o[r+2].toUpperCase().indexOf("S"))&&(o[r]="mi");var i={tokens:o};if(e){var l,t=-1!==(l=""+e).indexOf("T")?"T":" ",s=0,n=0,a=0;if((l=l.split(t))[1]&&(n=(s=l[1].split(":"))[1]||0,a=s[2]||0,s=s[0]||0),(l=l[0].split("-"))[0]&&l[1]&&l[2]&&0<l[0]&&0<l[1]&&l[1]<13&&0<l[2]&&l[2]<32){i.data=[l[0],l[1],l[2],s,n,a],i.value=[];for(var c=new Date(i.data[0],i.data[1]-1,i.data[2],i.data[3],i.data[4],i.data[5]),u=function(e){var t=this.tokens[e],n=t.toUpperCase(),o=null;"YYYY"===n?o=this.data[0]:"YYY"===n?o=this.data[0].substring(1,4):"YY"===n?o=this.data[0].substring(2,4):"Y"===n?o=this.data[0].substring(3,4):"MON"===t?o=I.months[c.getMonth()].substr(0,3).toUpperCase():"mon"===t?o=I.months[c.getMonth()].substr(0,3).toLowerCase():"MONTH"===t?o=I.months[c.getMonth()].toUpperCase():"month"===t?o=I.months[c.getMonth()].toLowerCase():"MMMMM"===n?o=I.months[c.getMonth()].substr(0,1):"MMMM"===n||"Month"===t?o=I.months[c.getMonth()]:"MMM"===n||"Mon"==t?o=I.months[c.getMonth()].substr(0,3):"MM"===n?o=k.two(this.data[1]):"M"===n?o=c.getMonth()+1:"DAY"===t?o=I.weekdays[c.getDay()].toUpperCase():"day"===t?o=I.weekdays[c.getDay()].toLowerCase():"DDDD"===n||"Day"==t?o=I.weekdays[c.getDay()]:"DDD"===n?o=I.weekdays[c.getDay()].substr(0,3):"DD"===n?o=k.two(this.data[2]):"D"===n?o=parseInt(this.data[2]):"Q"===n?o=Math.floor((c.getMonth()+3)/3):"HH24"===n||"HH"===n?(12<(o=this.data[3])&&-1!==this.tokens.indexOf("am/pm")&&(o-=12),o=k.two(o)):"HH12"===n?o=12<this.data[3]?k.two(this.data[3]-12):k.two(this.data[3]):"H"===n?12<(o=this.data[3])&&-1!==this.tokens.indexOf("am/pm")&&(o=k.two(o-=12)):"MI"===n?o=k.two(this.data[4]):"SS"===n?o=k.two(this.data[5]):"MS"===n?o=c.getMilliseconds():"AM/PM"===n?o=12<=this.data[3]?"PM":"AM":"WD"===n&&(o=I.weekdays[c.getDay()]),this.value[e]=null===o?this.tokens[e]:o},r=0;r<i.tokens.length;r++)u.call(i,r);e=i.value.join("")}else e=""}return e};var l,d,p,a,f,h,g,P,V,s,_,c,m,b,e=y;function j(e){return null===e||""===e||void 0===e}function q(e){return(e=a.call(this,e))?("-"===e[0]&&(e[0]="-0"),parseFloat(e.join("."))):null}function v(e){var t,n=b.call(this,e);if(t=n?n.type:t){for(var o=0,r=m.call(this,e),i=0;i<r.length;i++)(n=b.call(this,r[i]))&&d(n.type)&&o++;1<o&&(t="general")}return t}function Y(){"function"==typeof c[this.methods[this.index]]?(c[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)}function y(e,t,n){var o,r=null,i={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if("object"==typeof e){if(i.input=e.target,i.value=g.call(e.target),i.caret=h.call(e.target),(r=e.target.getAttribute("data-mask"))&&(i.mask=r),(r=e.target.getAttribute("data-type"))&&(i.type=r),e.target.mask?(e.target.mask.options&&(i.options=e.target.mask.options),e.target.mask.locale&&(i.locale=e.target.mask.locale)):(r=e.target.getAttribute("data-locale"))&&(i.locale=r,i.mask)&&(i.options.style=i.mask),e.target.attributes&&e.target.attributes.length)for(var l=0;l<e.target.attributes.length;l++){var s=e.target.attributes[l].name,a=e.target.attributes[l].value;"data"==s.substr(0,4)&&(i.options[s.substr(5)]=a)}}else{if("string"==typeof t)i.mask=t;else for(s=Object.keys(t),l=0;l<s.length;l++)i[s[l]]=t[s[l]];"number"==typeof e&&(p.call(i,i.mask),e=(""+e).replace(".",i.options.decimal)),i.value=e,i.input&&(g.call(i.input,e),k.focus(i.input),i.caret=h.call(i.input))}if("="!=(""+i.value)[0]&&(i.mask||i.locale)){if(i.mask&&(i.mask=i.mask.replace(new RegExp(/\[h]/),"|h|"),i.mask=i.mask.replace(new RegExp(/\[.*?\]/),""),i.mask=i.mask.replace(new RegExp(/\|h\|/),"[h]"),-1!==i.mask.indexOf(";")&&(r=i.mask.split(";"),i.mask=r[0]),-1!==i.mask.indexOf("##")&&((o=i.mask.split(";"))[0]&&("object"==typeof e&&(o[0]=o[0].replace(new RegExp(/_\)/g),""),o[0]=o[0].replace(new RegExp(/_\(/g),"")),o[0]=o[0].replace("*","\t"),o[0]=o[0].replace(new RegExp(/_-/g),""),o[0]=o[0].replace(new RegExp(/_/g),""),o[0]=o[0].replace("##0.###","##0.000"),o[0]=o[0].replace("##0.##","##0.00"),o[0]=o[0].replace("##0.#","##0.0"),o[0]=o[0].replace("##0,###","##0,000"),o[0]=o[0].replace("##0,##","##0,00"),o[0]=o[0].replace("##0,#","##0,0")),i.mask=o[0]),-1!==i.mask.indexOf("\\")&&((o=i.mask.split(";"))[0]=o[0].replace(new RegExp(/\\/g),""),i.mask=o[0]),i.type||(i.type=v.call(i,i.mask)),i.tokens=m.call(i,i.mask)),"object"!=typeof e||!e.inputType||!e.inputType.indexOf("insert")||!e.inputType.indexOf("delete"))if(i.locale)i.input?function(e,t){var n=g.call(e);n&&(n=(t=f.call(this,n,t)).length-n.length,n=h.call(e)+n,g.call(e,t,n,!0))}.call(i,i.input,e):c=f.call(i,i.value);else{for(i.methods=function(e){for(var t=[],n=0;n<e.length;n++){var o=b.call(this,e[n]);t.push(o?o.method:null)}for(n=0;n<t.length;n++)"MM"==t[n]&&(t[n-1]&&0<=t[n-1].indexOf("H")||t[n-2]&&0<=t[n-2].indexOf("H")||t[n+1]&&0<=t[n+1].indexOf("S")||t[n+2]&&0<=t[n+2].indexOf("S"))&&(t[n]="MI");return t}.call(i,i.tokens),i.event=e;i.position<i.value.length&&void 0!==i.tokens[i.index];)Y.call(i);var c=i.values.join("");if(d(i.type)&&""!==c){for(;void 0!==i.tokens[i.index];)(r=b.call(i,i.tokens[i.index]))&&"general"==r.type&&(i.values[i.index]=i.tokens[i.index]),i.index++;var u=!0}else u=!1;c=i.values.join(""),i.input&&(r=c.length-i.value.length,g.call(i.input,c,0<r?i.caret+r:i.caret,u))}if(i.input&&(o=null,d(i.type)?(u=g.call(i.input),i.number=q.call(i,u),o="percentage"==i.type&&-1!==u.indexOf("%")?i.number/100:i.number):"datetime"==i.type&&(o=function(){var e;return-1!==this.mask.toLowerCase().indexOf("[h]")?(e=0,this.date[4]&&(e=parseFloat(this.date[4]/60)),e=parseInt(this.date[3])+e,e/=24):this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]?(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),e=k.two(this.date[0])+"-"+k.two(this.date[1])+"-"+k.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(e+=" "+k.two(this.date[3])+":"+k.two(this.date[4])+":"+k.two(this.date[5]))):e=k.two(this.date[3])+":"+k.two(this.date[4])+":"+k.two(this.date[5]),e}.call(i),i.date[0])&&i.date[1]&&i.date[2]&&i.input.setAttribute("data-completed",!0),o)&&i.input.setAttribute("data-value",o),void 0!==c)return n?i:c}}S.keydown=function(e){var t=null;(t=S.current)&&(13==e.which?t.close(!1,!0):27==e.which&&t.close(!1,!1))},S.prettify=function(e,t){t=t||{justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"},-1===e.indexOf("GMT")&&(e+=" GMT");var n=new Date,e=new Date(e),n=parseInt((n-e)/1e3/60);return String.prototype.format=function(e){return this.replace("{0}",e)},0==n?t.justNow:n<90?t.xMinutesAgo.format(n):n<1440?t.xHoursAgo.format(Math.round(n/60)):n<20160?t.xDaysAgo.format(Math.round(n/1440)):n<43200?t.xWeeksAgo.format(Math.round(n/10080)):n<1036800?t.xMonthsAgo.format(Math.round(n/43200)):t.xYearsAgo.format(Math.round(n/525600))},S.prettifyAll=function(){for(var e=document.querySelectorAll(".prettydate"),t=0;t<e.length;t++)e[t].getAttribute("data-date")?e[t].innerHTML=S.prettify(e[t].getAttribute("data-date")):e[t].innerHTML&&(e[t].setAttribute("title",e[t].innerHTML),e[t].setAttribute("data-date",e[t].innerHTML),e[t].innerHTML=S.prettify(e[t].innerHTML))},S.now=I.now,S.toArray=I.toArray,S.dateToNum=I.dateToNum,S.numToDate=I.numToDate,S.weekdays=I.weekdays,S.months=I.months,S.weekdaysShort=I.weekdaysShort,S.monthsShort=I.monthsShort,S.extractDateFromString=e.extractDateFromString,S.getDateString=e.getDateString;var U=S;function S(a,e){if(a.calendar)return a.calendar.setOptions(e,!0);function t(e){var t,n;k.findElement(e.target,"jcalendar-container")?"jcalendar-prev"==(t=e.target.className)?j.prev():"jcalendar-next"==t?j.next():"jcalendar-month"==t?j.getMonths():"jcalendar-year"==t?j.getYears():"jcalendar-set-year"==t?(j.date[0]=e.target.innerText,"year-month-picker"==j.options.type?j.getMonths():j.getDays()):e.target.classList.contains("jcalendar-set-month")?(n=parseInt(e.target.getAttribute("data-value")),"year-month-picker"==j.options.type?j.update(e.target,n):(j.date[1]=n,j.getDays())):"jcalendar-confirm"==t||"jcalendar-update"==t||"jcalendar-close"==t?j.close(null,!0):"jcalendar-backdrop"==t?j.close(!1,!1):"jcalendar-reset"==t?j.reset():e.target.classList.contains("jcalendar-set-day")&&e.target.innerText&&j.update(e.target):j.close(!1,!1)}function n(e){e.target.value&&3<e.target.value.length&&(e=S.extractDateFromString(e.target.value,j.options.format))&&j.setValue(e)}var j={type:"calendar",options:{},date:null,setOptions:function(e,t){var n,o,r={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:I.monthsShort,monthsFull:I.months,weekdays:I.weekdays,textDone:N.translate("Done"),textReset:N.translate("Reset"),textUpdate:N.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(n in r)e&&e.hasOwnProperty(n)?j.options[n]=e[n]:void 0!==j.options[n]&&!0!==t||(j.options[n]=r[n]);return 0==j.options.resetButton?i.style.display="none":i.style.display="",j.options.readonly?a.setAttribute("readonly","readonly"):a.removeAttribute("readonly"),j.options.placeholder?a.setAttribute("placeholder",j.options.placeholder):a.removeAttribute("placeholder"),k.isNumeric(j.options.value)&&0<j.options.value&&(j.options.value=S.numToDate(j.options.value),j.options.dataType="numeric"),i.innerHTML=j.options.textReset,l.innerHTML=j.options.textDone,p.innerHTML=j.options.textUpdate,a.setAttribute("data-mask",j.options.format.toLowerCase()),(o=!j.options.value&&j.options.today?S.now():j.options.value)&&(j.options.value=null,j.setValue(o)),j},open:function(e){var t,n,o;r.classList.contains("jcalendar-focus")||r.classList.contains("jcalendar-inline")||(T(S.current=j,!0),j.getDays(),"year-month-picker"==j.options.type&&j.getMonths(),j.options.time&&(f.value=j.date[3],h.value=j.date[4]),r.classList.add("jcalendar-focus"),k.getWindowWidth()<800||j.options.fullscreen?(r.classList.add("jcalendar-fullsize"),D.slideBottom(c,1)):(r.classList.remove("jcalendar-fullsize"),t=a.getBoundingClientRect(),n=c.getBoundingClientRect(),j.options.position?(s.style.position="fixed",window.innerHeight<t.bottom+n.height?s.style.top=t.top-(n.height+2)+"px":s.style.top=t.top+t.height+2+"px",s.style.left=t.left+"px"):(window.innerHeight<t.bottom+n.height?((o=-1*(t.height+n.height+2))+t.top<0&&(o=-1*(t.top+t.height)),s.style.top=o+"px"):s.style.top="2px",window.innerWidth<t.left+n.width?(o=window.innerWidth-(t.left+n.width+20),s.style.left=o+"px"):s.style.left="0px")),"function"==typeof j.options.onopen&&j.options.onopen(a))},close:function(e,t){var n;return!0!==j.options.autoSelect&&void 0===t&&(t=!1),r.classList.contains("jcalendar-focus")&&(!1!==t?(n=r.querySelector(".jcalendar-selected"),t="string"==typeof t?t:!n||n.classList.contains("jcalendar-disabled")?j.options.value:j.getValue(),j.setValue(t)):j.options.value&&(n=j.options.value,j.options.value="",j.setValue(n)),e||"function"!=typeof j.options.onclose||j.options.onclose(a),r.classList.remove("jcalendar-focus"),T(j,!1),S.current=null),j.options.value},prev:function(){"years"==j.options.mode?(j.date[0]=j.date[0]-12,j.getYears()):"months"==j.options.mode?(j.date[0]=parseInt(j.date[0])-1,j.getMonths()):(j.date[1]<2?(j.date[0]=j.date[0]-1,j.date[1]=12):j.date[1]=j.date[1]-1,j.getDays())},next:function(){"years"==j.options.mode?(j.date[0]=parseInt(j.date[0])+12,j.getYears()):"months"==j.options.mode?(j.date[0]=parseInt(j.date[0])+1,j.getMonths()):(11<j.date[1]?(j.date[0]=parseInt(j.date[0])+1,j.date[1]=1):j.date[1]=parseInt(j.date[1])+1,j.getDays())},setToday:function(){var e=(new Date).toISOString().substr(0,10);return j.setValue(e),e},setValue:function(e){var t,n,o,r,i,l=e=e||""+e,s=j.options.value;s!=l&&(l?(j.setLabel(l,j.options),(n=l.split(" "))[1]||(n[1]="00:00:00"),r=n[1].split(":"),n=n[0].split("-"),i=parseInt(n[0]),t=parseInt(n[1]),n=parseInt(n[2]),o=parseInt(r[0]),r=parseInt(r[1]),j.date=[i,t,n,o,r,0],e=j.setLabel(l,j.options),o=S.now(new Date(i,t-1,n),!0),!j.options.validRange||(r=!j.options.validRange[0]||o>=j.options.validRange[0],i=!j.options.validRange[1]||o<=j.options.validRange[1],r&&i)?(a.classList.remove("jcalendar_warning"),a.title=""):(a.classList.add("jcalendar_warning"),a.title=N.translate("Date outside the valid range"))):(j.date=null,e="",a.classList.remove("jcalendar_warning"),a.title=""),j.options.value=l,"function"==typeof j.options.onchange&&j.options.onchange(a,l,s),a.value!=e)&&(a.value=e,"function"==typeof a.oninput)&&a.oninput({type:"input",target:a,value:a.value}),j.getDays(),"year-month-picker"==j.options.type&&j.getMonths()},getValue:function(){return j.date?j.options.time?k.two(j.date[0])+"-"+k.two(j.date[1])+"-"+k.two(j.date[2])+" "+k.two(j.date[3])+":"+k.two(j.date[4])+":"+k.two(0):k.two(j.date[0])+"-"+k.two(j.date[1])+"-"+k.two(j.date[2])+" "+k.two(0)+":"+k.two(0)+":"+k.two(0):""},update:function(e,t){var n;e.classList.contains("jcalendar-disabled")||((n=r.querySelector(".jcalendar-selected"))&&n.classList.remove("jcalendar-selected"),e.classList.add("jcalendar-selected"),e.classList.contains("jcalendar-set-month")?(j.date[1]=t,j.date[2]=1):j.date[2]=e.innerText,j.options.time?(j.date[3]=f.value,j.date[4]=h.value):j.close(null,!0)),v()},reset:function(){j.setValue(""),j.date=null,j.close(!1,!1)},getDays:function(){j.options.mode="days";var e=new Date,t=j.date&&k.isNumeric(j.date[0])?j.date[0]:parseInt(e.getFullYear()),n=j.date&&k.isNumeric(j.date[1])?j.date[1]:parseInt(e.getMonth())+1,o=j.date&&k.isNumeric(j.date[2])?j.date[2]:parseInt(e.getDate()),r=j.date&&k.isNumeric(j.date[3])?j.date[3]:parseInt(e.getHours()),i=j.date&&k.isNumeric(j.date[4])?j.date[4]:parseInt(e.getMinutes()),l=(j.date=[t,n,o,r,i,0],y.innerHTML=t,x.innerHTML=j.options.months[n-1],e.getMonth()==n-1&&e.getFullYear()==t),s=e.getDate(),a=(e=new Date(t,n,0,0,0)).getDate(),c=(e=new Date(t,n-1,0,0,0)).getDay()+1,u=(c-=p=j.options.startingDay||0,w.innerHTML="",document.createElement("tr"));u.setAttribute("align","center"),w.appendChild(u);for(var d=0;d<7;d++)(g=document.createElement("td")).classList.add("jcalendar-weekday"),g.innerHTML=j.options.weekdays[p].substr(0,1),u.appendChild(g),6<++p&&(p=0);for(var p=0,f=0,h=0;h<6;h++){(u=document.createElement("tr")).setAttribute("align","center"),u.style.height="34px";for(var g,m,b,d=0;d<7;d++)(g=document.createElement("td")).classList.add("jcalendar-set-day"),c<=p&&p<c+a&&(f++,(g.innerHTML=f)==o&&g.classList.add("jcalendar-selected"),l&&s==f&&(g.style.fontWeight="bold"),b=S.now(new Date(t,n-1,f),!0),j.options.validRange)&&(m=!j.options.validRange[0]||b>=j.options.validRange[0],b=!j.options.validRange[1]||b<=j.options.validRange[1],m&&b||g.classList.add("jcalendar-disabled")),u.appendChild(g),p++;w.appendChild(u)}j.options.time?C.style.display="":C.style.display="none",v()},getMonths:function(){j.options.mode="months";for(var e=j.options.months,t=(j.options.value,new Date),n=parseInt(t.getFullYear()),o=parseInt(t.getMonth())+1,r=j.date&&k.isNumeric(j.date[0])?j.date[0]:n,i=j.date&&k.isNumeric(j.date[1])?j.date[1]:o,l=(y.innerHTML=j.date[0],x.innerHTML=e[i-1],document.createElement("table")),s=(l.setAttribute("width","100%"),null),a=0;a<12;a++){a%4||((s=document.createElement("tr")).setAttribute("align","center"),l.appendChild(s));var c,u,d=document.createElement("td");d.classList.add("jcalendar-set-month"),d.setAttribute("data-value",a+1),d.innerText=e[a],j.options.validRange&&(u=r+"-"+k.two(a+1),c=!j.options.validRange[0]||u>=j.options.validRange[0].substr(0,7),u=!j.options.validRange[1]||u<=j.options.validRange[1].substr(0,7),c&&u||d.classList.add("jcalendar-disabled")),a+1==i&&d.classList.add("jcalendar-selected"),n==r&&a+1==o&&(d.style.fontWeight="bold"),s.appendChild(d)}w.innerHTML='<tr><td colspan="7"></td></tr>',w.children[0].children[0].appendChild(l),v()},getYears:function(){j.options.mode="years";for(var e=new Date,t=e.getFullYear(),n=j.date&&k.isNumeric(j.date[0])?j.date[0]:parseInt(e.getFullYear()),o=[],r=0;r<25;r++)o[r]=parseInt(j.date[0])+(r-12);var i=document.createElement("table");i.setAttribute("width","100%");for(r=0;r<25;r++){r%5||((l=document.createElement("tr")).setAttribute("align","center"),i.appendChild(l));var l,s=document.createElement("td");s.classList.add("jcalendar-set-year"),s.innerText=o[r],n==o[r]&&s.classList.add("jcalendar-selected"),t==o[r]&&(s.style.fontWeight="bold"),l.appendChild(s)}w.innerHTML='<tr><td colspan="7"></td></tr>',w.firstChild.firstChild.appendChild(i),v()},setLabel:function(e,t){return S.getDateString(e,t)},fromFormatted:function(e,t){return S.extractDateFromString(e,t)}},v=function(){var e=r.querySelector(".jcalendar-selected");e&&e.classList.contains("jcalendar-disabled")?(p.setAttribute("disabled","disabled"),f.setAttribute("disabled","disabled"),h.setAttribute("disabled","disabled")):(p.removeAttribute("disabled"),f.removeAttribute("disabled"),h.removeAttribute("disabled")),"function"==typeof j.options.onupdate&&j.options.onupdate(a,j.getValue())},r=null,i=null,l=null,s=null,c=null,y=null,x=null,o=null,w=null,u=null,C=null,d=null,p=null,f=null,h=null;"INPUT"==a.tagName&&a.value&&(e.value=a.value),(i=document.createElement("div")).className="jcalendar-reset",(l=document.createElement("div")).className="jcalendar-confirm",(u=document.createElement("div")).className="jcalendar-controls",u.style.borderBottom="1px solid #ddd",u.appendChild(i),u.appendChild(l),(s=document.createElement("div")).className="jcalendar-container",(c=document.createElement("div")).className="jcalendar-content",s.appendChild(c),"DIV"==a.tagName?(r=a).classList.add("jcalendar-inline"):(c.appendChild(u),(r=document.createElement("div")).className="jcalendar"),r.classList.add("jcalendar-container"),r.appendChild(s);(u=document.createElement("div")).className="jcalendar-table",c.appendChild(u);var g=document.createElement("td"),m=(g.setAttribute("colspan","2"),g.className="jcalendar-prev",(y=document.createElement("span")).className="jcalendar-year",(x=document.createElement("span")).className="jcalendar-month",document.createElement("td")),b=(m.className="jcalendar-header",m.setAttribute("colspan","3"),m.appendChild(x),m.appendChild(y),document.createElement("td")),E=(b.setAttribute("colspan","2"),b.className="jcalendar-next",document.createElement("thead")),A=document.createElement("tr");A.appendChild(g),A.appendChild(m),A.appendChild(b),E.appendChild(A),o=document.createElement("table"),w=document.createElement("tbody"),o.setAttribute("cellpadding","0"),o.setAttribute("cellspacing","0"),o.appendChild(E),o.appendChild(w),u.appendChild(o),(f=document.createElement("select")).className="jcalendar-select",f.onchange=function(){j.date[3]=this.value,"function"==typeof j.options.onupdate&&j.options.onupdate(a,j.getValue())};for(var L=0;L<24;L++)(M=document.createElement("option")).value=L,M.innerHTML=k.two(L),f.appendChild(M);(h=document.createElement("select")).className="jcalendar-select",h.onchange=function(){j.date[4]=this.value,"function"==typeof j.options.onupdate&&j.options.onupdate(a,j.getValue())};for(var M,L=0;L<60;L++)(M=document.createElement("option")).value=L,M.innerHTML=k.two(L),h.appendChild(M);return(g=document.createElement("div")).className="jcalendar-controls",(C=document.createElement("div")).className="jcalendar-time",C.style.maxWidth="140px",C.appendChild(f),C.appendChild(h),(p=document.createElement("button")).setAttribute("type","button"),p.className="jcalendar-update",(d=document.createElement("div")).style.flexGrow="10",d.appendChild(p),g.appendChild(C),"INPUT"==a.tagName&&g.appendChild(d),c.appendChild(g),(m=document.createElement("div")).className="jcalendar-backdrop",r.appendChild(m),a.addEventListener("keyup",n),r.addEventListener("swipeleft",function(e){D.slideLeft(o,0,function(){j.next(),D.slideRight(o,1)}),e.preventDefault(),e.stopPropagation()}),r.addEventListener("swiperight",function(e){D.slideRight(o,0,function(){j.prev(),D.slideLeft(o,1)}),e.preventDefault(),e.stopPropagation()}),"ontouchend"in document.documentElement==!0?(r.addEventListener("touchend",t),a.addEventListener("touchend",j.open)):(r.addEventListener("mouseup",t),a.addEventListener("mouseup",j.open)),S.hasEvents||(S.hasEvents=!0,document.addEventListener("keydown",S.keydown)),j.setOptions(e),"INPUT"==a.tagName?(a.parentNode.insertBefore(r,a.nextSibling),a.setAttribute("autocomplete","off"),a.classList.add("jcalendar-input"),a.value=j.setLabel(j.getValue(),j.options)):(j.getDays(),j.options.time&&(f.value=j.date[3],h.value=j.date[4])),1==j.options.opened&&j.open(),0==j.options.controls&&s.classList.add("jcalendar-hide-controls"),a.change=j.setValue,a.val=function(e){if(void 0===e)return j.getValue();j.setValue(e)},a.calendar=r.calendar=j}x={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},W.get=function(e){return x[e]||x},W.set=function(e,t){x[e]=t};var x,z=W;function W(e){return x[e]||x.material}function X(s,e){var t,a={options:{}},n={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(t in n)e&&e.hasOwnProperty(t)?a.options[t]=e[t]:a.options[t]=n[t];s.classList.add("jtabs");function l(e){var t;a.options.animation&&(t=a.headers.children[e].getBoundingClientRect(),"modern"===a.options.palette?(p.style.width=t.width-4+"px",p.style.left=a.headers.children[e].offsetLeft+2+"px"):(p.style.width=t.width+"px",p.style.left=a.headers.children[e].offsetLeft+"px"),"bottom"===a.options.position?p.style.top="0px":p.style.bottom="0px")}function c(e){"function"==typeof a.headers.scrollTo?a.headers.scrollTo({left:e,behavior:"smooth"}):a.headers.scrollLeft=e,e<=1?u.classList.add("disabled"):u.classList.remove("disabled"),e>=a.headers.scrollWidth-a.headers.offsetWidth?d.classList.add("disabled"):d.classList.remove("disabled"),a.headers.scrollWidth<=a.headers.offsetWidth?(u.style.display="none",d.style.display="none"):(u.style.display="",d.style.display="")}var u=null,d=null,p=null;if(a.setBorder=l,a.open=function(e){for(var t,n,o,r=null,i=0;i<a.headers.children.length;i++)a.headers.children[i].classList.contains("jtabs-selected")&&(r=i),a.headers.children[i].classList.remove("jtabs-selected"),a.content.children[i]&&a.content.children[i].classList.remove("jtabs-selected");a.headers.children[e].classList.add("jtabs-selected"),a.content.children[e]&&a.content.children[e].classList.add("jtabs-selected"),r!=e&&"function"==typeof a.options.onchange&&a.content.children[e]&&a.options.onchange(s,a,e,a.headers.children[e],a.content.children[e]),1==a.options.hideHeaders&&a.headers.children.length<3&&0==a.options.allowCreate?a.headers.parentNode.style.display="none":(l(e),a.headers.parentNode.style.display="",e=(t=a.headers.children[e].offsetLeft)+a.headers.children[e].offsetWidth,o=(n=a.headers.scrollLeft)+a.headers.offsetWidth,n<=t&&e<=o||c(t-1))},a.selectIndex=function(e){e=Array.prototype.indexOf.call(a.headers.children,e);return 0<=e&&a.open(e),e},a.rename=function(e,t){t=t||prompt("New title",a.headers.children[e].innerText),a.headers.children[e].innerText=t,a.open(e)},a.create=function(e,t){if("function"==typeof a.options.onbeforecreate){var n=a.options.onbeforecreate(s);if(!1===n)return!1;e=n}n=a.appendElement(e);return"function"==typeof a.options.oncreate&&a.options.oncreate(s,n),l(),n},a.remove=function(e){return a.deleteElement(e)},a.nextNumber=function(){for(var e=0,t=0;t<a.headers.children.length;t++){var n=a.headers.children[t].innerText.match(/[0-9].*/);e<n&&(e=parseInt(n))}return e?e++:e=1,e},a.deleteElement=function(e){if(!a.headers.children[e])return!1;a.headers.removeChild(a.headers.children[e]),a.content.removeChild(a.content.children[e]),a.open(0),"function"==typeof a.options.ondelete&&a.options.ondelete(s,e)},a.appendElement=function(e,t){var n,o;if(e=e||prompt("Title?",""))return n=document.createElement("div"),a.content.appendChild(n),(o=document.createElement("div")).innerHTML=e,o.content=n,a.headers.insertBefore(o,a.headers.lastChild),a.options.allowChangePosition&&o.setAttribute("draggable","true"),a.selectIndex(o),"function"==typeof t&&t(n,o),n},a.getActive=function(){for(var e=0;e<a.headers.children.length;e++)if(a.headers.children[e].classList.contains("jtabs-selected"))return e;return 0},a.updateContent=function(e,t){"string"==typeof t&&(document.createElement("div").innerHTML=t),a.content.children[e].classList.contains("jtabs-selected")&&t.classList.add("jtabs-selected"),a.content.replaceChild(t,a.content.children[e]),l()},a.updatePosition=function(e,t){t<e?a.content.insertBefore(a.content.children[e],a.content.children[t]):a.content.insertBefore(a.content.children[e],a.content.children[t].nextSibling),a.open(t),"function"==typeof a.options.onchangeposition&&a.options.onchangeposition(a.headers,e,t)},a.move=function(e,t){t<e?a.headers.insertBefore(a.headers.children[e],a.headers.children[t]):a.headers.insertBefore(a.headers.children[e],a.headers.children[t].nextSibling),a.updatePosition(e,t)},a.setBorder=l,a.init=function(){s.innerHTML="",a.headers=document.createElement("div"),a.content=document.createElement("div"),a.headers.classList.add("jtabs-headers"),a.content.classList.add("jtabs-content"),a.options.palette?s.classList.add("jtabs-modern"):s.classList.remove("jtabs-modern"),a.options.padding&&(a.content.style.padding=parseInt(a.options.padding)+"px");var e=document.createElement("div"),t=(e.className="jtabs-headers-container",e.appendChild(a.headers),a.options.maxWidth&&(e.style.maxWidth=parseInt(a.options.maxWidth)+"px"),document.createElement("div"));t.className="jtabs-controls",t.setAttribute("draggable","false"),e.appendChild(t),"bottom"==a.options.position?(s.appendChild(a.content),s.appendChild(e)):(s.appendChild(e),s.appendChild(a.content)),1==a.options.allowCreate&&((e=document.createElement("div")).className="jtabs-add",e.onclick=function(){a.create()},t.appendChild(e)),(u=document.createElement("div")).className="jtabs-prev",u.onclick=function(){c(a.headers.scrollLeft-a.headers.offsetWidth)},t.appendChild(u),(d=document.createElement("div")).className="jtabs-next",d.onclick=function(){c(a.headers.scrollLeft+a.headers.offsetWidth)},t.appendChild(d);for(var n,o,r,i,l=0;l<a.options.data.length;l++)n=a.options.data[l].titleElement||document.createElement("div"),a.options.data[l].icon&&(o=document.createElement("div"),(r=document.createElement("i")).classList.add("material-icons"),r.innerHTML=a.options.data[l].icon,o.appendChild(r),n.appendChild(o)),a.options.data[l].title&&(r=document.createTextNode(a.options.data[l].title),n.appendChild(r)),a.options.data[l].width&&(n.style.width=a.options.data[l].width),a.options.data[l].contentElement?i=a.options.data[l].contentElement:(i=document.createElement("div")).innerHTML=a.options.data[l].content,a.headers.appendChild(n),a.content.appendChild(i);(p=document.createElement("div")).className="jtabs-border",a.headers.appendChild(p),a.options.animation&&s.classList.add("jtabs-animation"),a.headers.addEventListener("click",function(e){e=e.target.parentNode.classList.contains("jtabs-headers")?e.target:("I"==e.target.tagName?e.target.parentNode:e.target).parentNode;e=a.selectIndex(e);"function"==typeof a.options.onclick&&a.options.onclick(s,a,e,a.headers.children[e],a.content.children[e])}),a.headers.addEventListener("contextmenu",function(e){a.selectIndex(e.target)}),a.headers.children.length&&a.open(0),c(0),1==a.options.allowChangePosition&&H(a.headers,{direction:1,ondrop:function(e,t,n){a.updatePosition(t,n)}}),"function"==typeof a.options.onload&&a.options.onload(s,a)},s.children[0]&&s.children[0].children.length)for(var o=0;o<s.children[0].children.length;o++){var r=a.options.data&&a.options.data[o]?a.options.data[o]:{};s.children[1]&&s.children[1].children[o]?(r.titleElement=s.children[0].children[o],r.contentElement=s.children[1].children[o]):r.contentElement=s.children[0].children[o],a.options.data[o]=r}var i=!1;if(a.options.data)for(o=0;o<a.options.data.length;o++)a.options.data[o].url&&(R({url:a.options.data[o].url,type:"GET",dataType:"text/html",index:o,success:function(e){a.options.data[this.index].content=e},complete:function(){a.init()}}),i=!0);return i||a.init(),s.tabs=a}function G(r,e){var s,i,l,a,c,u,t,d,o,p,n,f,h,g,m,b,j,v,y,x,w,C;return r.color?r.color.setOptions(e,!0):(d=t=u=c=a=l=i=null,(s={type:"color",options:{},setOptions:function(e,t){var n,o={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};for(n in(e=e||{})&&!e.palette&&(e.palette=z()),o)e&&e.hasOwnProperty(n)?s.options[n]=e[n]:void 0!==s.options[n]&&!0!==t||(s.options[n]=o[n]);return c&&(c.innerHTML=s.options.resetLabel),u&&(u.innerHTML=s.options.doneLabel),s.options.palette&&d&&d.updateContent(0,h()),"string"==typeof s.options.value&&(r.value=s.options.value,"INPUT"===r.tagName)&&(r.style.color=r.value,r.style.backgroundColor=r.value),s.options.placeholder?r.setAttribute("placeholder",s.options.placeholder):r.getAttribute("placeholder")&&r.removeAttribute("placeholder"),s},select:function(e){var t=i.querySelector(".jcolor-selected");t&&t.classList.remove("jcolor-selected"),s.values[e]&&s.values[e].classList.add("jcolor-selected"),s.options.value=e},open:function(){var e,t,n,o;i.classList.contains("jcolor-focus")||(T(s,!0),i.classList.add("jcolor-focus"),s.options.value&&s.select(s.options.value),a.style.marginTop="",a.style.marginLeft="",e=a.getBoundingClientRect(),t=k.getWindowWidth(),n=k.getWindowHeight(),t<800||1==s.options.fullscreen?(a.classList.add("jcolor-fullscreen"),D.slideBottom(a,1),l.style.display="block"):(a.classList.contains("jcolor-fullscreen")&&(a.classList.remove("jcolor-fullscreen"),l.style.display=""),s.options.position?a.style.position="fixed":a.style.position="",e.left+e.width>t&&(a.style.marginLeft=-1*(e.left+e.width-(t-20))+"px"),e.top+e.height>n&&(a.style.marginTop=-1*(e.top+e.height-(n-20))+"px")),"function"==typeof s.options.onopen&&s.options.onopen(r,s),d.setBorder(d.getActive()),s.options.value&&(o=f(s.options.value),x.forEach(function(e,t){e.value=o[t],e.dispatchEvent(new Event("input"))})))},close:function(e){return i.classList.contains("jcolor-focus")&&(i.classList.remove("jcolor-focus"),l.style.display="",e||"function"!=typeof s.options.onclose||s.options.onclose(r,s),T(s,!1)),s.options.value},setValue:function(e){(e=e||"")!=s.options.value&&(s.options.value=e,y=e,s.select(e),"function"==typeof s.options.onchange&&s.options.onchange(r,e,s),r.value!=s.options.value&&(r.value=s.options.value,"INPUT"===r.tagName&&(r.style.color=r.value,r.style.backgroundColor=r.value),"function"==typeof r.oninput)&&r.oninput({type:"input",target:r,value:r.value}),1==s.options.closeOnChange)&&s.close()}}).getValue=function(){return s.options.value},o=function(e){e=e.toString(16);return 1===e.length?"0"+e:e},p=function(e,t,n){return"#"+o(e)+o(t)+o(n)},n=function(e){return parseInt("0x"+e)},f=function(e){return[n(e.substr(1,2)),n(e.substr(3,2)),n(e.substr(5,2))]},h=function(){var e=document.createElement("div"),t=(e.className="jcolor-grid",s.values=[],document.createElement("table"));t.setAttribute("cellpadding","7"),t.setAttribute("cellspacing","0");for(var n=0;n<s.options.palette.length;n++){for(var o=document.createElement("tr"),r=0;r<s.options.palette[n].length;r++){var i=document.createElement("td"),l=s.options.palette[n][r];l.length<7&&"#"!==l.substr(0,1)&&(l="#"+l),i.style.backgroundColor=l,i.setAttribute("data-value",l),i.innerHTML="",o.appendChild(i),s.options.value==l&&i.classList.add("jcolor-selected"),s.values[l]=i}t.appendChild(o)}return e.appendChild(t),e},(g=document.createElement("canvas")).width=200,g.height=160,m=g.getContext("2d"),b=function(){var e=t.firstChild.getBoundingClientRect();g.width=e.width-14,j()},j=function(){var e=m.createLinearGradient(0,0,g.width,0);e.addColorStop(0,"rgb(255,0,0)"),e.addColorStop(.15,"rgb(255,0,255)"),e.addColorStop(.33,"rgb(0,0,255)"),e.addColorStop(.49,"rgb(0,255,255)"),e.addColorStop(.67,"rgb(0,255,0)"),e.addColorStop(.84,"rgb(255,255,0)"),e.addColorStop(1,"rgb(255,0,0)"),m.fillStyle=e,m.fillRect(0,0,g.width,g.height),(e=m.createLinearGradient(0,0,0,g.height)).addColorStop(0,"rgba(255,255,255,1)"),e.addColorStop(.5,"rgba(255,255,255,0)"),e.addColorStop(.5,"rgba(0,0,0,0)"),e.addColorStop(1,"rgba(0,0,0,1)"),m.fillStyle=e,m.fillRect(0,0,g.width,g.height)},v=function(){function t(e,t,n){1===e&&(t=t-(e=o.getBoundingClientRect()).left,n=n-e.top,(t=t<0?0:t)>e.width&&(t=e.width),(n=n<0?0:n)>e.height&&(n=e.height),r.style.left=t+"px",r.style.top=n+"px",e=m.getImageData(t,n,1,1).data,y=p(e[0],e[1],e[2]))}var o=document.createElement("div"),r=(o.className="jcolor-hsl",document.createElement("div")),e=(r.className="jcolor-point",document.createElement("div"));e.appendChild(g),e.appendChild(r),o.appendChild(e);return o.addEventListener("mousedown",function(e){t(e.buttons,e.clientX,e.clientY)}),o.addEventListener("mousemove",function(e){t(e.buttons,e.clientX,e.clientY)}),o.addEventListener("touchmove",function(e){t(1,e.changedTouches[0].clientX,e.changedTouches[0].clientY)}),o},y="",x=[],w=function(){if(""!==y)for(var e=0;e<x.length;e++){var t=f(y);t[e]=0;var n=(n="linear-gradient(90deg, rgb(")+t.join(", ")+"), rgb(";t[e]=255,n=n+t.join(", ")+"))",x[e].style.backgroundImage=n}},C=function(){function e(e){var t=document.createElement("div"),n=(t.className="jcolor-sliders-input-container",document.createElement("label"));n.innerText=e;(e=document.createElement("div")).className="jcolor-sliders-input-subcontainer";var o=document.createElement("input"),r=(o.type="range",o.min=0,o.max=255,o.value=0,t.appendChild(n),e.appendChild(o),document.createElement("div"));return r.innerText=o.value,o.addEventListener("input",function(){r.innerText=o.value}),e.appendChild(r),t.appendChild(e),i.appendChild(t),o}var t=document.createElement("div"),i=(t.className="jcolor-sliders",document.createElement("div")),n=(x=[e("Red"),e("Green"),e("Blue")],t.appendChild(i),document.createElement("div")),o=(n.className="jcolor-sliders-final-color",document.createElement("div"));o.style.visibility="hidden",o.innerText="a",n.appendChild(o);return x.forEach(function(e){e.addEventListener("input",function(){var e;e=p(parseInt(x[0].value),parseInt(x[1].value),parseInt(x[2].value)),o.innerText=e,o.style.color=e,o.style.removeProperty("visibility"),y=e,w()})}),t.appendChild(n),t},s.toHex=function(e){function t(e){return("0"+parseInt(e).toString(16)).slice(-2)}if(e)return/^#[0-9A-F]{6}$/i.test(e)?e:(e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))&&e.length?"#"+t(e[1])+t(e[2])+t(e[3]):""},s.setOptions(e),"INPUT"==r.tagName&&(r.classList.add("jcolor-input"),r.readOnly=!0),(i=document.createElement("div")).className="jcolor",(l=document.createElement("div")).className="jcolor-backdrop",i.appendChild(l),(a=document.createElement("div")).className="jcolor-content",(e=document.createElement("div")).className="jcolor-controls",a.appendChild(e),(c=document.createElement("div")).className="jcolor-reset",c.innerHTML=s.options.resetLabel,e.appendChild(c),(u=document.createElement("div")).className="jcolor-close",u.innerHTML=s.options.doneLabel,e.appendChild(u),t=document.createElement("div"),a.appendChild(t),d=X(t,{animation:!0,data:[{title:"Grid",contentElement:h()},{title:"Spectrum",contentElement:v()},{title:"Sliders",contentElement:C()}],onchange:function(e,t,n){var o,r;1===n?b():(o=""!==y?y:s.getValue(),2===n&&o&&(r=f(o),x.forEach(function(e,t){e.value=r[t],e.dispatchEvent(new Event("input"))})))},palette:"modern"}),i.appendChild(a),"INPUT"==r.tagName?r.parentNode.insertBefore(i,r.nextSibling):r.appendChild(i),i.addEventListener("click",function(e){var t;"TD"==e.target.tagName?(t=e.target.getAttribute("data-value"))&&s.setValue(t):e.target.classList.contains("jcolor-reset")?(s.setValue(""),s.close()):e.target.classList.contains("jcolor-close")?(0<d.getActive()&&s.setValue(y),s.close()):e.target.classList.contains("jcolor-backdrop")?s.close():s.open()}),r.addEventListener("mouseup",function(e){s.open()}),window.addEventListener("resize",function(){i.classList.contains("jcolor-focus")&&1==d.getActive()&&b()}),1==s.options.opened&&s.open(),r.change=s.setValue,r.val=function(e){if(void 0===e)return s.getValue();s.setValue(e)},r.color=s,i.color=s)}var $=w;function w(i,e){var t,l={type:"contextmenu",options:{}},n={items:null,onclick:null};for(t in n)e&&e.hasOwnProperty(t)?l.options[t]=e[t]:l.options[t]=n[t];return i.classList.add("jcontextmenu"),l.open=function(e,t){var n,o;t&&(l.options.items=t,l.create(t)),w.current&&w.current.close(),T(l,!0),i.classList.add("jcontextmenu-focus"),((w.current=l).options.items&&0<l.options.items.length||i.children.length)&&(t=e.target?(e.changedTouches&&e.changedTouches[0]?(n=e.changedTouches[0].clientX,e.changedTouches[0]):(n=e.clientX,e)).clientY:(n=e.x,e.y),e=i.getBoundingClientRect(),window.innerHeight<t+e.height?(o=t-e.height,i.style.top=(o=o<0?0:o)+"px"):i.style.top=t+"px",window.innerWidth<n+e.width?0<n-e.width?i.style.left=n-e.width+"px":i.style.left="10px":i.style.left=n+"px")},l.isOpened=function(){return!!i.classList.contains("jcontextmenu-focus")},l.close=function(){i.classList.contains("jcontextmenu-focus")&&i.classList.remove("jcontextmenu-focus"),T(l,!1)},l.create=function(e){i.innerHTML="";(t=document.createElement("div")).classList.add("header"),t.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation()}),(n=document.createElement("a")).classList.add("title"),n.innerHTML=N.translate("Menu"),t.appendChild(n),(n=document.createElement("a")).classList.add("close"),n.innerHTML=N.translate("close"),n.addEventListener("click",function(e){l.close()}),t.appendChild(n);var t,n=t;i.appendChild(n);for(var o=0;o<e.length;o++){var r=function e(t){if(!t.type||"line"!=t.type&&"divisor"!=t.type){var n=document.createElement("div"),o=document.createElement("a");if(o.innerHTML=t.title,t.tooltip&&n.setAttribute("title",t.tooltip),t.icon&&n.setAttribute("data-icon",t.icon),t.id&&(n.id=t.id),t.disabled?n.className="jcontextmenu-disabled":t.onclick&&(n.method=t.onclick,n.addEventListener("mousedown",function(e){e.preventDefault()}),n.addEventListener("mouseup",function(e){this.method(this,e)})),n.appendChild(o),t.submenu){for(var o=document.createElement("span"),r=(o.innerHTML="&#9658;",n.appendChild(o),n.classList.add("jcontexthassubmenu"),document.createElement("div")),i=(r.classList.add("jcontextmenu"),r.setAttribute("tabindex","900"),t.submenu),l=0;l<i.length;l++){var s=e(i[l]);r.appendChild(s)}n.appendChild(r)}else t.shortcut&&((o=document.createElement("span")).innerHTML=t.shortcut,n.appendChild(o))}else var n=document.createElement("hr");return n}(e[o]);i.appendChild(r)}},"function"==typeof l.options.onclick&&i.addEventListener("click",function(e){l.options.onclick(l,e)}),l.options.items&&l.create(l.options.items),window.addEventListener("mousewheel",function(){l.close()}),i.contextmenu=l}C.keydown=function(e){var t=null;if(t=C.current)if(13==e.which||9==e.which)t.header.value&&null==t.currentIndex&&t.options.newOptions?t.add():(null==t.currentIndex&&1==t.options.autocomplete&&""!=t.header.value&&t.find(t.header.value),t.selectIndex(t.currentIndex));else if(38==e.which)null==t.currentIndex?t.first():0<t.currentIndex&&t.prev(),e.preventDefault();else if(40==e.which)null==t.currentIndex?t.first():t.currentIndex+1<t.items.length&&t.next(),e.preventDefault();else if(36==e.which)t.first(),e.target.classList.contains("jdropdown-header")||e.preventDefault();else if(35==e.which)t.last(),e.target.classList.contains("jdropdown-header")||e.preventDefault();else if(27==e.which)t.close();else if(33==e.which){if(null==t.currentIndex)t.first();else if(0<t.currentIndex)for(var n=0;n<7;n++)t.prev();e.preventDefault()}else if(34==e.which){if(null==t.currentIndex)t.first();else if(t.currentIndex+1<t.items.length)for(n=0;n<7;n++)t.next();e.preventDefault()}},C.mouseup=function(e){var t=k.findElement(e.target,"jdropdown");if(t){var n,o=t.dropdown;if(e.target.classList.contains("jdropdown-header"))t.classList.contains("jdropdown-focus")&&t.classList.contains("jdropdown-default")?(t=t.getBoundingClientRect(),(e.changedTouches&&e.changedTouches[0]?(n=e.changedTouches[0].clientX,e.changedTouches[0]):(n=e.clientX,e)).clientY,t.width-(n-t.left)<30?e.target.classList.contains("jdropdown-add")?o.add():o.close():0==o.options.autocomplete&&o.close()):o.open();else if(e.target.classList.contains("jdropdown-group-name")){var r=e.target.nextSibling.children;if("none"!=e.target.nextSibling.style.display)for(var i=0;i<r.length;i++)"none"!=r[i].style.display&&o.selectItem(r[i])}else e.target.classList.contains("jdropdown-group-arrow")?e.target.classList.contains("jdropdown-group-arrow-down")?(e.target.classList.remove("jdropdown-group-arrow-down"),e.target.classList.add("jdropdown-group-arrow-up"),e.target.parentNode.nextSibling.style.display="none"):(e.target.classList.remove("jdropdown-group-arrow-up"),e.target.classList.add("jdropdown-group-arrow-down"),e.target.parentNode.nextSibling.style.display=""):e.target.classList.contains("jdropdown-item")?o.selectItem(e.target):e.target.classList.contains("jdropdown-image")||e.target.classList.contains("jdropdown-description")?o.selectItem(e.target.parentNode):e.target.classList.contains("jdropdown-title")?o.selectItem(e.target.parentNode.parentNode):(e.target.classList.contains("jdropdown-close")||e.target.classList.contains("jdropdown-backdrop"))&&o.close()}},C.extractFromDom=function(e,r){var i=e;if(r=r||{},!e.getAttribute("multiple")||r&&null!=r.multiple||(r.multiple=!0),!e.getAttribute("placeholder")||r&&null!=r.placeholder||(r.placeholder=e.getAttribute("placeholder")),!e.getAttribute("data-autocomplete")||r&&null!=r.autocomplete||(r.autocomplete=!0),r&&null!=r.width||(r.width=e.offsetWidth),!e.value||r&&null!=r.value||(r.value=e.value),!r||null==r.data){r.data=[];for(var t=0;t<e.children.length;t++)if("OPTGROUP"==e.children[t].tagName)for(var n=0;n<e.children[t].children.length;n++)r.data.push({value:e.children[t].children[n].value,text:e.children[t].children[n].textContent,group:e.children[t].getAttribute("label")});else r.data.push({value:e.children[t].value,text:e.children[t].textContent})}r&&null!=r.onchange||(r.onchange=function(e,t,n,o){1==r.multiple?obj.items[t].classList.contains("jdropdown-selected")?i.options[t].setAttribute("selected","selected"):i.options[t].removeAttribute("selected"):i.value=o});var o=document.createElement("div");return e.parentNode.insertBefore(o,e),e.style.display="none",{el:e=o,options:r}};var K=C;function C(r,e){var p,i,n,o,l,s,c,a,u,d,f,h,g,t,m,b,j,v;return r.dropdown?r.dropdown.setOptions(e,!0):(i=function(e,t){e&&e.length&&(!1!==p.options.sortResults&&("function"==typeof p.options.sortResults?e.sort(p.options.sortResults):e.sort(n)),p.setData(e)),"function"==typeof p.options.onload&&p.options.onload(r,p,e,t),t&&l(t),null==t&&(p.options.value=""),r.value=p.options.value,1==p.options.opened&&p.open()},n=function(e,t){var n,o;return"string"==typeof e?n=e:e.text?n=e.text:e.name&&(n=e.name),"string"==typeof t?o=t:t.text?o=t.text:t.name&&(o=t.name),"string"==typeof n||"string"==typeof o?(n="string"!=typeof n?""+n:n).localeCompare(o="string"!=typeof o?""+o:o):n-o},o=function(){p.value={};for(var e=0;e<p.items.length;e++)1==p.items[e].selected&&(p.items[e].element&&p.items[e].element.classList.remove("jdropdown-selected"),p.items[e].selected=null);p.options.value="",r.value=""},l=function(e){if(o(),null!==e)if(e){Array.isArray(e)||(e=(""+e).split(";"));for(var t=0;t<e.length;t++)p.value[e[t]]=""}else void 0!==p.value[""]&&(p.value[""]="");for(t=0;t<p.items.length;t++)void 0!==p.value[s(t)]&&(p.items[t].element&&p.items[t].element.classList.add("jdropdown-selected"),p.items[t].selected=!0,p.value[s(t)]=c(t));p.options.value=Object.keys(p.value).join(";"),p.header.value=p.getText()},s=function(e,t){var n;return n=p.options.format?"id":"value",p.items[e]?void 0!==t?p.items[e].data[n]=t:p.items[e].data[n]:""},c=function(e,t){var n;return n=p.options.format?"name":"text",p.items[e]?void 0!==t?p.items[e].data[n]=t:p.items[e].data[n]:""},a=function(){return Object.keys(p.value)},u=function(){for(var e=[],t=Object.keys(p.value),n=0;n<t.length;n++)e.push(p.value[t[n]]);return e},b=m=t=g=h=f=d=null,j=function(e){r.value!=p.options.value&&(r.value=p.options.value,"function"==typeof r.oninput)&&r.oninput({type:"input",target:r,value:r.value}),"function"==typeof p.options.onchange&&p.options.onchange(r,p,e,p.options.value)},(p={type:"dropdown",options:{},setOptions:function(e,t){e=e||{};var n,o={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1};for(n in o)e&&e.hasOwnProperty(n)?p.options[n]=e[n]:void 0!==p.options[n]&&!0!==t||(p.options[n]=o[n]);return 1!=p.options.remoteSearch&&"searchbar"!==p.options.type||(p.options.autocomplete=!0),1==p.options.newOptions?p.header.classList.add("jdropdown-add"):p.header.classList.remove("jdropdown-add"),1==p.options.autocomplete?p.header.removeAttribute("readonly"):p.header.setAttribute("readonly","readonly"),p.options.placeholder?p.header.setAttribute("placeholder",p.options.placeholder):p.header.removeAttribute("placeholder"),r.classList.remove("jdropdown-searchbar"),r.classList.remove("jdropdown-picker"),r.classList.remove("jdropdown-list"),"searchbar"==p.options.type?r.classList.add("jdropdown-searchbar"):"list"==p.options.type?r.classList.add("jdropdown-list"):"picker"==p.options.type?r.classList.add("jdropdown-picker"):k.getWindowWidth()<800?p.options.autocomplete?(r.classList.add("jdropdown-searchbar"),p.options.type="searchbar"):(r.classList.add("jdropdown-picker"),p.options.type="picker"):(p.options.width?(r.style.width=p.options.width,r.style.minWidth=p.options.width):(r.style.removeProperty("width"),r.style.removeProperty("min-width")),r.classList.add("jdropdown-default"),p.options.type="default"),"searchbar"==p.options.type?d.appendChild(g):f.insertBefore(g,f.firstChild),p.options.url&&!e.data?R({url:p.options.url,method:"GET",dataType:"json",success:function(e){e&&i(e,p.options.value)}}):i(p.options.data,p.options.value),p},getUrl:function(){return p.options.url},setUrl:function(e,t){p.options.url=e,R({url:p.options.url,method:"GET",dataType:"json",success:function(e){p.setData(e),"function"==typeof t&&t(p)}})},setId:function(e,t){var n;n=p.options.format?"id":"value","object"==typeof e?e[n]=t:p.items[e].data[n]=t},add:function(e,t){if(!e){var n=1==p.options.autocomplete?p.header.value:"";if(!(e=prompt(N.translate("Add A New Option"),n)))return!1}if(t=t||k.guid(),n=p.options.format?{id:t,name:e}:{value:t,text:e},"function"==typeof p.options.onbeforeinsert){t=p.options.onbeforeinsert(p,n);if(!1===t)return!1;t&&(n=t)}p.options.data.push(n);e=p.createItem(n);return h.appendChild(e.element),"function"==typeof p.options.oninsert&&p.options.oninsert(p,n,e),"none"==h.style.display&&(h.style.display=""),p.results&&p.results.push(e),n},createItem:function(e,t,n){p.options.format?(e.id||void 0===e.value||(e.id=e.value),e.name||void 0===e.text||(e.name=e.text)):(e.value||void 0===e.id||(e.value=e.id),e.text||void 0===e.name||(e.text=e.name));var o={},r=(o.element=document.createElement("div"),o.element.className="jdropdown-item",o.element.indexValue=p.items.length,o.data=e,t&&(o.group=t),e.id&&o.element.setAttribute("id",e.id),1==e.disabled&&o.element.setAttribute("data-disabled",!0),e.tooltip&&o.element.setAttribute("title",e.tooltip),e.image?((t=document.createElement("img")).className="jdropdown-image",t.src=e.image,e.title||t.classList.add("jdropdown-image-small"),o.element.appendChild(t)):e.icon?((t=document.createElement("span")).className="jdropdown-icon material-icons",t.innerText=e.icon,e.title||t.classList.add("jdropdown-icon-small"),e.color&&(t.style.color=e.color),o.element.appendChild(t)):e.color&&((t=document.createElement("div")).className="jdropdown-color",t.style.backgroundColor=e.color,o.element.appendChild(t)),t=p.options.format?e.name:e.text,document.createElement("div"));return r.className="jdropdown-description",r.textContent=t||"&nbsp;",e.title&&((t=document.createElement("div")).className="jdropdown-title",t.innerText=e.title,r.appendChild(t)),t=p.options.format?e.id:e.value,p.value[t]&&(o.element.classList.add("jdropdown-selected"),o.selected=!0),p.items.push(o),o.element.appendChild(r),o},appendData:function(e){if(e.length){for(var t=[],n=[],o=0;o<e.length;o++)(e[o].group?(n[e[o].group]||(n[e[o].group]=[]),n[e[o].group]):t).push(o);var r=0,i=Object.keys(n);if(0<i.length)for(o=0;o<i.length;o++){var l=document.createElement("div"),s=(l.className="jdropdown-group",document.createElement("div")),a=(s.className="jdropdown-group-name",s.textContent=i[o],document.createElement("i")),c=(a.className="jdropdown-group-arrow jdropdown-group-arrow-down",s.appendChild(a),document.createElement("div"));c.className="jdropdown-group-items";for(var u=0;u<n[i[o]].length;u++){var d=p.createItem(e[n[i[o]][u]],l,i[o]);(0==p.options.lazyLoading||r<200)&&(c.appendChild(d.element),r++)}l.appendChild(s),l.appendChild(c),p.groups.push(l),0<c.children.length&&h.appendChild(l)}if(t.length)for(o=0;o<t.length;o++){d=p.createItem(e[t[o]]);(0==p.options.lazyLoading||r<200)&&(h.appendChild(d.element),r++)}}},setData:function(e){if(o(),h.textContent="",p.header.value="",p.items=[],e&&e.length){for(var t=0;t<e.length;t++)"object"!=typeof e[t]&&(p.options.format?e[t]={id:e[t],name:e[t]}:e[t]={value:e[t],text:e[t]});p.appendData(e),p.options.data=e}else p.options.data=[];p.close()},getData:function(){return p.options.data},getPosition:function(e){for(var t=0;t<p.items.length;t++)if(s(t)==e)return t;return!1},getText:function(e){var t=u();return e?t:t.join("; ")},getValue:function(e){var t=a();return e?t:t.join(";")},setValue:function(e){var t=p.getValue();t!==(e=Array.isArray(e)?e.join(";"):e)&&(l(e),j(t))},resetSelected:function(){p.setValue(null)},selectIndex:function(e,t){e=parseInt(e);p.items&&p.items[e]&&(!0===t||!0!==p.items[e].data.disabled)&&(p.setCursor(e,!1),p.options.multiple?(t=p.options.value,p.items[e].selected?(p.items[e].element.classList.remove("jdropdown-selected"),p.items[e].selected=!1,delete p.value[s(e)]):(p.items[e].element.classList.add("jdropdown-selected"),p.items[e].selected=!0,p.value[s(e)]=c(e)),p.options.value=Object.keys(p.value).join(";"),0==p.options.autocomplete&&(p.header.value=u().join("; ")),j(t)):(p.items[e].selected?p.setValue(null):p.setValue(s(e)),p.close()))},selectItem:function(e){p.selectIndex(e.indexValue)}}).find=function(t){if(p.search==t.trim())return!1;if(p.search=t,p.setCursor(),p.groups.length)for(var e=0;e<p.groups.length;e++)p.groups[e].lastChild.textContent="";if(h.textContent="",1==p.options.remoteSearch){p.results=null;let e={url:p.options.url,method:"GET",data:{q:t},dataType:"json",success:function(e){p.items=[];var t=Object.keys(p.value);if(t.length)for(var n=0;n<t.length;n++)!function(e,t){for(var n=0;n<t.length;n++)if(p.options.format){if(t[n].id==e)return!0}else if(t[n].value==e)return!0;return!1}(t[n],e)&&(p.options.format?e.unshift({id:t[n],name:p.value[t[n]]}):e.unshift({value:t[n],text:p.value[t[n]]}));p.appendData(e),e.length?h.style.display="":h.style.display="none","function"==typeof p.options.onsearch&&p.options.onsearch(p,e)}};if("function"==typeof p.options.onbeforesearch){var n=p.options.onbeforesearch(p,e);if(!1===n)return;"object"==typeof n&&(e=n)}R(e)}else{t=new RegExp(t,"gi");for(var o=[],e=0;e<p.items.length;e++){var r=c(e),i=p.items[e].data.title||"",l=p.items[e].data.group||"",s=(s=p.items[e].data.synonym||"")&&s.join(" ");(null==t||1==p.items[e].selected||r.match(t)||i.match(t)||l.match(t)||s.match(t))&&o.push(p.items[e])}if(o.length){h.style.display="";var a=(p.results=o).length||0;1==p.options.lazyLoading&&200<a&&(a=200);for(e=0;e<a;e++)(p.results[e].group?(p.results[e].group.parentNode||h.appendChild(p.results[e].group),p.results[e].group.lastChild):h).appendChild(p.results[e].element)}else h.style.display="none",p.results=null}1==p.options.autofocus&&p.first()},p.open=function(){var e,t;r.classList.contains("jdropdown-focus")||(T(C.current=p,!0),r.classList.add("jdropdown-focus"),k.getWindowWidth()<800&&(null!=p.options.type&&"picker"!=p.options.type||D.slideBottom(f,1)),1==p.options.autocomplete&&(p.header.value=p.search,p.header.focus()),(e=a())[0]&&!1!==(e=p.getPosition(e[0]))&&p.setCursor(e),p.options.type&&"default"!=p.options.type)||(e=r.getBoundingClientRect(),t=f.getBoundingClientRect(),p.options.position?(f.style.position="fixed",window.innerHeight<e.bottom+t.height?(f.style.top="",f.style.bottom=window.innerHeight-e.top+1+"px"):(f.style.top=e.bottom+"px",f.style.bottom=""),f.style.left=e.left+"px"):window.innerHeight<e.bottom+t.height?(f.style.top="",f.style.bottom=e.height+1+"px"):(f.style.top="",f.style.bottom=""),f.style.minWidth=e.width+"px",p.options.maxWidth&&(f.style.maxWidth=p.options.maxWidth),p.items.length||1!=p.options.autocomplete?h.style.display="":h.style.display="none"),"function"==typeof p.options.onopen&&p.options.onopen(r)},p.close=function(e){return r.classList.contains("jdropdown-focus")&&(p.header.value=p.getText(),p.setCursor(),e||"function"!=typeof p.options.onclose||p.options.onclose(r),p.header.blur&&p.header.blur(),r.classList.remove("jdropdown-focus"),T(p,!1),C.current=null),p.getValue()},p.setCursor=function(e,t){null!=p.currentIndex&&p.items&&p.items[p.currentIndex]&&p.items[p.currentIndex].element.classList.remove("jdropdown-cursor"),null==e?p.currentIndex=null:(e=parseInt(e),p.items[e].element.parentNode&&(p.items[e].element.classList.add("jdropdown-cursor"),p.currentIndex=e,!1!==t)&&p.items[p.currentIndex].element&&(h.scrollTop,e=p.items[p.currentIndex].element,h.scrollTop=e.offsetTop-e.scrollTop+e.clientTop-95))},p.resetCursor=p.setCursor,p.updateCursor=p.setCursor,p.reset=function(){p.setCursor(),p.setValue(null)},p.first=function(){!0===p.options.lazyLoading&&p.loadFirst();var e=h.querySelectorAll(".jdropdown-item");e.length&&(e=e[0].indexValue,p.setCursor(e))},p.last=function(){!0===p.options.lazyLoading&&p.loadLast();var e=h.querySelectorAll(".jdropdown-item");e.length&&(e=e[e.length-1].indexValue,p.setCursor(e))},p.next=function(e){var t,n,o=null;if(e){if(1==e.length){var r,i=p.currentIndex||-1,l=(e=e.toLowerCase(),null),s=h.querySelectorAll(".jdropdown-item");if(s.length){for(var a=0;a<s.length;a++)if(s[a].indexValue>i&&(r=p.items[s[a].indexValue])&&(l=r.element.innerText[0])&&e==(l=l.toLowerCase())){o=s[a].indexValue;break}p.setCursor(o)}}}else null==p.currentIndex||null==p.currentIndex?p.first():((n=(t=p.items[p.currentIndex].element).nextElementSibling)?o=(n=n.classList.contains("jdropdown-group")?n.lastChild.firstChild:n).indexValue:t.parentNode.classList.contains("jdropdown-group-items")&&((n=t.parentNode.parentNode.nextElementSibling)&&(n.classList.contains("jdropdown-group")?n=n.lastChild.firstChild:n.classList.contains("jdropdown-item")?o=n.indexValue:n=null),n)&&(o=n.indexValue),null!==o&&p.setCursor(o))},p.prev=function(){var e,t,n=null;null===p.currentIndex?p.first():(t=(e=p.items[p.currentIndex].element).previousElementSibling)?n=(t=t.classList.contains("jdropdown-group")?t.lastChild.lastChild:t).indexValue:e.parentNode.classList.contains("jdropdown-group-items")&&((t=e.parentNode.parentNode.previousElementSibling)&&(t.classList.contains("jdropdown-group")?t=t.lastChild.lastChild:t.classList.contains("jdropdown-item")?n=t.indexValue:t=null),t)&&(n=t.indexValue),null!==n&&p.setCursor(n)},p.loadFirst=function(){var e,t=(e=p.results||p.items).length||0;1==p.options.lazyLoading&&200<t&&(t=200),h.textContent="";for(var n=0;n<t;n++)(e[n].group?(e[n].group.parentNode||h.appendChild(e[n].group),e[n].group.lastChild):h).appendChild(e[n].element);h.scrollTop=0},p.loadLast=function(){var e,t=(e=p.results||p.items).length;if(200<t){t-=200,h.textContent="";for(var n=t;n<e.length;n++)(e[n].group?(e[n].group.parentNode||h.appendChild(e[n].group),e[n].group.lastChild):h).appendChild(e[n].element);h.scrollTop=h.scrollHeight}},p.loadUp=function(){var e,t=!1;e=p.results||p.items;var n=h.querySelectorAll(".jdropdown-item")[0].indexValue,n=p.items[n],o=e.indexOf(n)-1;if(0<o){for(var r=0;0<o&&e[o]&&r<200;)e[o].group?(e[o].group.parentNode||h.insertBefore(e[o].group,h.firstChild),e[o].group.lastChild.insertBefore(e[o].element,e[o].group.lastChild.firstChild)):h.insertBefore(e[o].element,h.firstChild),o--,r++;t=!0}return t},p.loadDown=function(){var e,t=!1,n=(e=p.results||p.items,h.querySelectorAll(".jdropdown-item")),n=n[n.length-1].indexValue,n=p.items[n],o=e.indexOf(n)+1;if(o<e.length){for(var r=0;o<e.length&&e[o]&&r<200;)(e[o].group?(e[o].group.parentNode||h.appendChild(e[o].group),e[o].group.lastChild):h).appendChild(e[o].element),o++,r++;t=!0}return t},e=e||{},"SELECT"==r.tagName&&(v=C.extractFromDom(r,e),r=v.el,e=v.options),!e.placeholder&&r.getAttribute("placeholder")&&(e.placeholder=r.getAttribute("placeholder")),p.value={},p.items=[],p.groups=[],p.search="",p.results=null,r.classList.add("jdropdown"),(d=document.createElement("div")).className="jdropdown-container-header",p.header=document.createElement("input"),p.header.className="jdropdown-header jss_object",p.header.type="text",p.header.setAttribute("autocomplete","off"),p.header.onfocus=function(){"function"==typeof p.options.onfocus&&p.options.onfocus(r)},p.header.onblur=function(){"function"==typeof p.options.onblur&&p.options.onblur(r)},p.header.onkeyup=function(e){1!=p.options.autocomplete||b?p.options.autocomplete||p.next(e.key):(p.search!=p.header.value.trim()&&(b=setTimeout(function(){p.find(p.header.value.trim()),b=null},400)),r.classList.contains("jdropdown-focus")||p.open())},C.hasEvents||(C.hasEvents=!0,document.addEventListener("keydown",C.keydown)),(f=document.createElement("div")).className="jdropdown-container",(h=document.createElement("div")).className="jdropdown-content",(g=document.createElement("div")).className="jdropdown-close",g.textContent="Done",(t=document.createElement("div")).className="jdropdown-reset",t.textContent="x",t.onclick=function(){p.reset(),p.close()},(m=document.createElement("div")).className="jdropdown-backdrop",d.appendChild(p.header),f.appendChild(h),r.appendChild(d),r.appendChild(f),r.appendChild(m),p.setOptions(e),"ontouchsend"in document.documentElement==!0?r.addEventListener("touchsend",C.mouseup):r.addEventListener("mouseup",C.mouseup),1==p.options.lazyLoading&&B(h,{loadUp:p.loadUp,loadDown:p.loadDown}),h.onwheel=function(e){e.stopPropagation()},r.change=p.setValue,r.val=function(e){if(void 0===e)return p.getValue(!!p.options.multiple);p.setValue(e)},r.dropdown=p)}function J(r,e){var a,c,u,d;return r.picker?r.picker.setOptions(e,!0):(u=c=null,d=function(e){return e instanceof Element||e instanceof HTMLDocument},(a={type:"picker",options:{}}).setOptions=function(e,t){var n,o={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};for(n in e&&e.options&&(e.data=e.options),o)e&&e.hasOwnProperty(n)?a.options[n]=e[n]:void 0!==a.options[n]&&!0!==t||(a.options[n]=o[n]);!1===a.options.header?c.style.display="none":c.style.display="",a.options.width?c.style.width=parseInt(a.options.width)+"px":c.style.width="",a.options.height?(u.style.maxHeight=a.options.height+"px",u.style.overflow="scroll"):u.style.overflow="",0<a.options.columns&&(a.options.grid?(u.classList.add("jpicker-grid"),u.style.gridTemplateColumns="repeat("+a.options.grid+", 1fr)"):(u.classList.add("jpicker-columns"),u.style.width=a.options.width||36*a.options.columns+"px")),isNaN(parseInt(a.options.value))&&(a.options.value=0),u.innerHTML="";for(var r=Object.keys(a.options.data),i=0;i<r.length;i++){var l=document.createElement("div"),s=(l.classList.add("jpicker-item"),l.k=r[i],l.v=a.options.data[r[i]],a.getLabel(r[i],l));d(s)?l.appendChild(s):l.innerHTML=s,u.appendChild(l)}return a.setValue(a.options.value),a},a.getValue=function(){return a.options.value},a.setValue=function(e,t){var n;a.setLabel(e),a.options.value=String(e),r.value!=a.options.value&&(r.value=a.options.value,"function"==typeof r.oninput)&&r.oninput({type:"input",target:r,value:r.value}),u.children[e]&&"generic"!==u.children[e].getAttribute("type")&&a.close(),t&&"function"==typeof a.options.onchange&&(n=a.options.data[e],a.options.onchange(r,a,n,n,e,t))},a.getLabel=function(e,t){e=a.options.data[e]||null;return e="function"==typeof a.options.render?a.options.render(e,t):e},a.setLabel=function(e){e=a.options.content?'<i class="material-icons">'+a.options.content+"</i>":a.getLabel(e,null);d(e)?(c.innerHTML="",c.appendChild(e)):c.innerHTML=e},a.open=function(){var e,t,n,o;r.classList.contains("jpicker-focus")||(T(a,!0),r.classList.add("jpicker-focus"),r.focus(),e=o=0,u.style.marginLeft="",t=c.getBoundingClientRect(),n=u.getBoundingClientRect(),o=window.innerHeight<t.bottom+n.height||a.options.bottom?-1*(n.height+4):t.height+4,!0===a.options.right&&(e=-1*n.width+t.width),n.left+e<0&&(e=e+n.left+10),n.left+n.width>window.innerWidth&&(e=-1*(10+n.left+n.width-window.innerWidth)),u.style.marginTop=parseInt(o)+"px",u.style.marginLeft=parseInt(e)+"px","function"==typeof a.options.onopen&&a.options.onopen(r,a))},a.close=function(){r.classList.contains("jpicker-focus")&&(r.classList.remove("jpicker-focus"),T(a,!1),"function"==typeof a.options.onclose)&&a.options.onclose(r,a)},r.classList.add("jpicker"),r.setAttribute("tabindex","900"),r.onmousedown=function(e){r.classList.contains("jpicker-focus")||a.open()},(c=document.createElement("div")).classList.add("jpicker-header"),(u=document.createElement("div")).classList.add("jpicker-content"),u.onclick=function(e){var t=k.findElement(e.target,"jpicker-item");t&&t.parentNode===u&&a.setValue(t.k,e)},r.appendChild(c),r.appendChild(u),r.value=e.value||0,a.setOptions(e),"function"==typeof a.options.onload&&a.options.onload(r,a),r.change=a.setValue,r.val=function(e){if(void 0===e)return a.getValue();a.setValue(e)},r.picker=a)}function Z(a,e){var t,c={type:"toolbar",options:{}},n={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(t in n)e&&e.hasOwnProperty(t)?c.options[t]=e[t]:c.options[t]=n[t];!a&&e.app&&e.app.el&&(a=document.createElement("div"),e.app.el.appendChild(a));var o=document.createElement("div"),r=(o.classList.add("jtoolbar-item"),o.classList.add("jtoolbar-arrow"),document.createElement("div")),u=(r.classList.add("jtoolbar-floating"),o.appendChild(r),c.selectItem=function(e){for(var t=u.children,n=0;n<t.length;n++)e!=t[n]&&t[n].classList.remove("jtoolbar-selected");e.classList.add("jtoolbar-selected")},c.hide=function(){D.slideBottom(a,0,function(){a.style.display="none"})},c.show=function(){a.style.display="",D.slideBottom(a,1)},c.get=function(){return a},c.setBadge=function(e,t){u.children[e].children[1].firstChild.innerHTML=t},c.destroy=function(){toolbar.remove(),a.innerHTML=""},c.update=function(e,t){for(var n=0;n<u.children.length;n++)"function"==typeof(o=u.children[n]).updateState&&o.updateState(a,c,o,e,t);for(var o,n=0;n<r.children.length;n++)"function"==typeof(o=r.children[n]).updateState&&o.updateState(a,c,o,e,t)},c.create=function(e){u.innerHTML="";for(var t=0;t<e.length;t++){var n=document.createElement("div");if(n.classList.add("jtoolbar-item"),e[t].width&&(n.style.width=parseInt(e[t].width)+"px"),e[t].k&&(n.k=e[t].k),e[t].tooltip&&n.setAttribute("title",e[t].tooltip),e[t].id&&n.setAttribute("id",e[t].id),e[t].updateState&&(n.updateState=e[t].updateState),e[t].active&&n.classList.add("jtoolbar-active"),e[t].disabled&&n.classList.add("jtoolbar-disabled"),"select"==e[t].type||"dropdown"==e[t].type)J(n,e[t]);else if("divisor"==e[t].type)n.classList.add("jtoolbar-divisor");else if("label"==e[t].type)n.classList.add("jtoolbar-label"),n.innerHTML=e[t].content;else{var o,r,i=document.createElement("i");if(void 0===e[t].class)i.classList.add("material-icons");else for(var l=e[t].class.split(" "),s=0;s<l.length;s++)i.classList.add(l[s]);i.innerHTML=e[t].content||"",n.appendChild(i),1==c.options.badge&&((o=document.createElement("div")).classList.add("jbadge"),(r=document.createElement("div")).innerHTML=e[t].badge||"",o.appendChild(r),n.appendChild(o)),e[t].title&&(1==c.options.title?((r=document.createElement("span")).innerHTML=e[t].title,n.appendChild(r)):n.setAttribute("title",e[t].title)),c.options.app&&e[t].route&&(n.route=e[t].route,n.onclick=function(){c.options.app.pages(this.route)},c.options.app.pages(e[t].route,{toolbarItem:n,closed:!0})),"function"==typeof e[t].render&&e[t].render(n,e[t])}e[t].onclick&&(n.onclick=e[t].onclick.bind(e[t],a,c,n)),u.appendChild(n)}setTimeout(function(){c.refresh()},0)},c.open=function(){o.classList.add("jtoolbar-arrow-selected");a.getBoundingClientRect();r.getBoundingClientRect().bottom>window.innerHeight||c.options.bottom?r.style.bottom="0":r.style.removeProperty("bottom"),r.style.right="0",o.children[0].focus(),T(c,!0)},c.close=function(){o.classList.remove("jtoolbar-arrow-selected"),T(c,!1)},c.refresh=function(){if(1==c.options.responsive){var e=a.parentNode.getBoundingClientRect(),t=(c.options.maxWidth||(c.options.maxWidth=e.width),parseInt(c.options.maxWidth));for(o.parentNode&&o.parentNode.removeChild(o);r.firstChild;)u.appendChild(r.firstChild);if(t<u.offsetWidth)for(t-=50;u.lastChild&&t<u.offsetWidth;)r.insertBefore(u.lastChild,r.firstChild);0<r.children.length&&u.appendChild(o)}},c.setReadonly=function(e){a.classList[e=e?"add":"remove"]("jtoolbar-disabled")},a.onclick=function(e){var t=k.findElement(e.target,"jtoolbar-item");t&&c.selectItem(t),e.target.classList.contains("jtoolbar-arrow")&&c.open()},window.addEventListener("resize",function(){c.refresh()}),a.classList.add("jtoolbar"),a.innerHTML="",1==c.options.container&&a.classList.add("jtoolbar-container"),document.createElement("div"));return a.appendChild(u),c.options.app&&a.classList.add("jtoolbar-mobile"),c.create(c.options.items),a.toolbar=c}F.setCursor=function(e,t){e.focus(),document.execCommand("selectAll");var n,e=window.getSelection(),o=e.getRangeAt(0);t=1==t?(n=o.startContainer,0):(n=o.endContainer).length,o.setStart(n,t),o.setEnd(n,t),e.removeAllRanges(),e.addRange(o)},F.getDefaultToolbar=function(e){function t(e,t,n){n.color||(G(n,{onchange:function(e,t){"color"===n.k?document.execCommand("foreColor",!1,t):document.execCommand("backColor",!1,t)}}),n.color.open())}var n=[];return n.push({content:"undo",onclick:function(){document.execCommand("undo")}}),n.push({content:"redo",onclick:function(){document.execCommand("redo")}}),n.push({type:"divisor"}),e.options.toolbarOnTop&&(n.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(e){return'<span style="font-family:'+e+'">'+e+"</span>"},onchange:function(e,t,n,o,r){document.execCommand("fontName",!1,o)}}),n.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(e){return'<span style="font-size:'+e+'">'+e+"</span>"},onchange:function(e,t,n,o,r){document.execCommand("fontSize",!1,parseInt(r)+1)}}),n.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(e){return'<i class="material-icons">'+e+"</i>"},onchange:function(e,t,n,o,r){document.execCommand(["JustifyLeft","justifyCenter","justifyRight","justifyFull"][r])}}),n.push({type:"divisor"}),n.push({content:"format_color_text",k:"color",onclick:t}),n.push({content:"format_color_fill",k:"background-color",onclick:t})),n.push({content:"format_bold",onclick:function(e,t,n){document.execCommand("bold"),document.queryCommandState("bold")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_italic",onclick:function(e,t,n){document.execCommand("italic"),document.queryCommandState("italic")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_underline",onclick:function(e,t,n){document.execCommand("underline"),document.queryCommandState("underline")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({type:"divisor"}),n.push({content:"format_list_bulleted",onclick:function(e,t,n){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_list_numbered",onclick:function(e,t,n){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_indent_increase",onclick:function(e,t,n){document.execCommand("indent",!0,null),document.queryCommandState("indent")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),e.options.toolbarOnTop&&(n.push({type:"divisor"}),n.push({content:"photo",onclick:function(){e.upload()}}),n.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(e,t){t&&(t.onmouseover=this.onmouseover,e=e.split("x"),t.setAttribute("data-x",e[0]),t.setAttribute("data-y",e[1]));e=document.createElement("div");return t.style.margin="1px",t.style.border="1px solid #ddd",e},onmouseover:function(e){for(var t=parseInt(e.target.getAttribute("data-x")),n=parseInt(e.target.getAttribute("data-y")),o=0;o<e.target.parentNode.children.length;o++){var r=e.target.parentNode.children[o],i=parseInt(r.getAttribute("data-x")),l=parseInt(r.getAttribute("data-y"));i<=t&&l<=n?(r.style.backgroundColor="#cae1fc",r.style.borderColor="#2977ff"):(r.style.backgroundColor="",r.style.borderColor="#ddd")}},onchange:function(e,t,n){n=n.split("x");for(var o=document.createElement("table"),r=document.createElement("tbody"),i=0;i<=n[1];i++){for(var l=document.createElement("tr"),s=0;s<=n[0];s++){var a=document.createElement("td");a.innerHTML="",l.appendChild(a)}r.appendChild(l)}o.appendChild(r),o.setAttribute("width","100%"),o.setAttribute("cellpadding","6"),o.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,o.outerHTML)}})),n};var Q=F;function F(l,e){var t,c={type:"editor",options:{}},n={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(t in n)e&&e.hasOwnProperty(t)?c.options[t]=e[t]:c.options[t]=n[t];var o=null,s=null,a=[],u=(c.el=l,"function"==typeof c.options.onclick&&(l.onclick=function(e){c.options.onclick(l,c,e)}),l.classList.add("jeditor-container"),document.createElement("div")),r=(u.className="jsnippet",u.setAttribute("contenteditable",!1),document.createElement("div"));if(r.className="jeditor-toolbar",c.editor=document.createElement("div"),c.editor.setAttribute("contenteditable",!0),c.editor.setAttribute("spellcheck",!1),c.editor.classList.add("jeditor"),c.options.placeholder&&c.editor.setAttribute("data-placeholder",c.options.placeholder),(c.options.maxHeight||c.options.height)&&(c.editor.style.overflowY="auto",c.options.maxHeight&&(c.editor.style.maxHeight=c.options.maxHeight),c.options.height)&&(c.editor.style.height=c.options.height),c.options.url)R({url:c.options.url,dataType:"html",success:function(e){c.editor.innerHTML=e,F.setCursor(c.editor,"initial"==c.options.focus)}});else if(c.options.value)c.editor.innerHTML=c.options.value;else for(var i=0;i<l.children.length;i++)c.editor.appendChild(l.children[i]);function d(e){"function"==typeof c.options.onchange&&c.options.onchange(l,c,e),c.options.value=c.getData(),l.value!=c.options.value&&(l.value=c.options.value,"function"==typeof l.oninput)&&l.oninput({type:"input",target:l,value:l.value})}function p(){var e,t=null;(t=u.children[0])&&(t.classList.contains("jslider-grid")||t.classList.add("jslider-grid"),e=t.children.length,t.setAttribute("data-number",4<e?4:e),4<e?t.setAttribute("data-total",e-4):t.removeAttribute("data-total"))}function f(e){var t=window.getSelection(),n=document.createRange();n.selectNode(e),t.addRange(n)}l.innerHTML="",c.appendSnippet=function(e){u.innerHTML="";for(var t=["image","title","description","host","url"],n=0;n<t.length;n++){var o=document.createElement("div");if(o.className="jsnippet-"+t[n],o.setAttribute("data-k",t[n]),u.appendChild(o),e[t[n]])if("image"==t[n]){Array.isArray(e.image)||(e.image=[e.image]);for(var r=0;r<e.image.length;r++){var i=document.createElement("img");i.src=e.image[r],o.appendChild(i)}}else o.innerHTML=e[t[n]]}c.editor.appendChild(document.createElement("br")),c.editor.appendChild(u)},c.setData=function(e){c.editor.innerHTML="object"==typeof e?e.content:e,c.options.focus&&F.setCursor(c.editor,!0),a=[]},c.getFiles=function(){for(var e=c.editor.querySelectorAll(".jfile"),t=[],n=0;n<e.length;n++)a[e[n].src]&&t.push(a[e[n].src]);return t},c.getText=function(){return c.editor.innerText},c.getData=function(e){if(e){l={content:""};if(u.innerHTML){l.snippet={};for(var t=0;t<u.children.length;t++){var n=u.children[t].getAttribute("data-k");if(n)if("image"==n){l.snippet.image||(l.snippet.image=[]);for(var o=0;o<u.children[t].children.length;o++)l.snippet.image.push(u.children[t].children[o].getAttribute("src"))}else l.snippet[n]=u.children[t].innerHTML}}var r=Object.keys(a);if(r.length){l.files=[];for(t=0;t<r.length;t++)l.files.push(a[r[t]])}var e=document.createElement("div"),i=(e.innerHTML=c.editor.innerHTML,e.querySelector(".jsnippet")),i=(i&&i.remove(),e.innerHTML);i=(i=(i=i.replace(/<br>/g,"\n")).replace(/<\/div>/g,"</div>\n")).replace(/<(?:.|\n)*?>/gm,""),l.content=i.trim(),D("getData",l)}else var l=c.editor.innerHTML;return l},c.reset=function(){c.editor.innerHTML="",u.innerHTML="",a=[]},c.addPdf=function(n){var e,t;"data"!=n.result.substr(0,4)?console.error("Invalid source"):((e=document.createElement("canvas")).width=60,e.height=60,t=new Image,e.getContext("2d").drawImage(t,0,0,e.width,e.height),e.toBlob(function(e){var t=document.createElement("img");t.src=window.URL.createObjectURL(e),t.title=n.name,t.className="jfile pdf",a[t.src]={file:t.src,extension:"pdf",content:n.result},document.execCommand("insertHtml",!1,t.outerHTML)}))},c.addImage=function(e,o){var r,i;"data"==(e=e||"").substr(0,4)||c.options.remoteParser?("data"==e.substr(0,4)?r=(r=(r=e.split(";"))[0].split("/"))[1]:(r=e.substr(e.lastIndexOf(".")+1),e=c.options.remoteParser+e),(i=new Image).onload=function(){var n=document.createElement("canvas");n.width=i.width,n.height=i.height,n.getContext("2d").drawImage(i,0,0,n.width,n.height),n.toBlob(function(e){var t=document.createElement("img");t.src=window.URL.createObjectURL(e),t.classList.add("jfile"),t.setAttribute("tabindex","900"),t.setAttribute("width",i.width),t.setAttribute("height",i.height),a[t.src]={file:t.src,extension:r,content:n.toDataURL()},c.options.dropAsSnippet||o?(e=t,u.innerHTML||c.appendSnippet({}),u.children[0].appendChild(e),p(),a[t.src].snippet=!0):document.execCommand("insertHtml",!1,t.outerHTML),d()})},i.src=e):console.error("remoteParser not defined in your initialization")},c.addFile=function(e){for(var t,n=[],o=0;o<e.length;o++)e[o].size>c.options.maxFileSize?alert("The file is too big"):(t="image"==(t=e[o].type.split("/"))[0]?1:"pdf"==t[1]?2:0)?(n[o]=new FileReader,n[o].index=o,n[o].type=t,n[o].name=e[o].name,n[o].date=e[o].lastModified,n[o].size=e[o].size,n[o].addEventListener("load",function(e){2==e.target.type?1==c.options.acceptFiles&&c.addPdf(e.target):c.addImage(e.target.result)},!1),n[o].readAsDataURL(e[o])):alert("The extension is not allowed")},c.destroy=function(){c.editor.removeEventListener("mouseup",I),c.editor.removeEventListener("mousedown",N),c.editor.removeEventListener("mousemove",T),c.editor.removeEventListener("keyup",L),c.editor.removeEventListener("keydown",M),c.editor.removeEventListener("dragstart",y),c.editor.removeEventListener("dragenter",x),c.editor.removeEventListener("dragover",w),c.editor.removeEventListener("drop",C),c.editor.removeEventListener("paste",v),c.editor.removeEventListener("blur",E),c.editor.removeEventListener("focus",A),l.editor=null,l.classList.remove("jeditor-container"),r.remove(),u.remove(),c.editor.remove()},c.upload=function(){k.click(c.file)};var h,g=[HTMLUnknownElement,HTMLAudioElement,HTMLEmbedElement,HTMLIFrameElement,HTMLTextAreaElement,HTMLInputElement,HTMLScriptElement],m=["width","height","align","border","src","tabindex"],b=["color","font-weight","font-size","background","background-color","margin"],j=function(t){if(t.attributes&&t.attributes.length){var e=null,n=t.getAttribute("style");if(n)for(var e=[],o=n.split(";"),r=0;r<o.length;r++){var i,l=o[r].trim().split(":");0<=b.indexOf(l[0].trim())&&(i=l.shift(),l=l.join(":"),e.push(i+":"+l))}"IMG"==t.tagName.toUpperCase()&&(c.options.acceptImages&&t.src?(t.setAttribute("tabindex","900"),c.addImage(t.src)):t.parentNode.removeChild(t));for(var s=[],a=0;a<t.attributes.length;a++)s.push(t.attributes[a].name);s.length&&s.forEach(function(e){-1==m.indexOf(e)?t.removeAttribute(e):-1!==t.attributes[a].value.indexOf("<")&&t.attributes[a].value.replace("<","&#60;")}),t.style="",e&&e.length&&t.setAttribute("style",e.join(";"))}if(t.children.length)for(a=0;a<t.children.length;a++)j(t.children[a]);0<=g.indexOf(t.constructor)&&t.remove()},v=function(e){var t,n,o,r;1==c.options.filterPaste&&(e.clipboardData||e.originalEvent.clipboardData?(t=(e.originalEvent||e).clipboardData.getData("text/html"),n=(e.originalEvent||e).clipboardData.getData("text/plain"),o=(e.originalEvent||e).clipboardData.files):window.clipboardData&&(t=window.clipboardData.getData("Html"),n=window.clipboardData.getData("Text"),o=window.clipboardData.files),o.length?c.addFile(o):t?(o=(o=t)&&o.replace(new RegExp("\x3c!--(.*?)--\x3e","gsi"),""),o=(new DOMParser).parseFromString(o,"text/html"),j(o),(r=document.createElement("span")).innerHTML=o.firstChild.innerHTML,r=r,document.execCommand("insertHtml",!1,r.innerHTML)):(t=n.split("\r\n"),e.target.innerText?(t=t.map(function(e){return"<div>"+e+"</div>"}),document.execCommand("insertHtml",!1,t.join(""))):t.map(function(e){var t=document.createElement("div");t.innerText=e,c.editor.appendChild(t)})),e.preventDefault())},y=function(e){s&&s.e&&e.preventDefault()},x=function(e){s||0==c.options.dropZone||(l.classList.add("jeditor-dragging"),e.preventDefault())},w=function(e){s||0==c.options.dropZone||(o&&clearTimeout(o),o=setTimeout(function(){l.classList.remove("jeditor-dragging")},100),e.preventDefault())},C=function(e){if(!s&&0!=c.options.dropZone){var t=null,n=(document.caretRangeFromPoint?t=document.caretRangeFromPoint(e.clientX,e.clientY):e.rangeParent&&(t=document.createRange()).setStart(e.rangeParent,e.rangeOffset),window.getSelection()),t=(n.removeAllRanges(),n.addRange(t),n.anchorNode.parentNode.focus(),(e.originalEvent||e).dataTransfer.getData("text/html")),n=(e.originalEvent||e).dataTransfer.getData("text/plain"),o=(e.originalEvent||e).dataTransfer.files;if(o.length)c.addFile(o);else if(n){var o=t,n=document.createElement("div"),r=(n.innerHTML=o,n.querySelectorAll("img"));if(r.length)for(var i=0;i<r.length;i++)c.addImage(r[i].src)}l.classList.remove("jeditor-dragging"),e.preventDefault()}},E=function(e){D("onevent",e),d(e),"function"==typeof c.options.onblur&&c.options.onblur(l,c,e)},A=function(e){"function"==typeof c.options.onfocus&&c.options.onfocus(l,c,e)},L=function(e){c.editor.innerHTML||(c.editor.innerHTML="<div><br></div>"),"function"==typeof c.options.onkeyup&&c.options.onkeyup(l,c,e)},M=function(e){var t;D("onevent",e),"Delete"==e.key&&"IMG"==e.target.tagName&&(t=e.target.parentNode,f(e.target),t.classList.contains("jsnippet-image"))&&p(),"function"==typeof c.options.onkeydown&&c.options.onkeydown(l,c,e)},I=function(e){var t;s&&s.e&&(s.e.classList.remove("resizing"),1==s.e.changed)&&((t=s.e.cloneNode()).width=parseInt(s.e.style.width)||s.e.getAttribute("width"),t.height=parseInt(s.e.style.height)||s.e.getAttribute("height"),s.e.style.width="",s.e.style.height="",f(s.e),document.execCommand("insertHtml",!1,t.outerHTML)),s=!1},N=function(n){function e(e){var t=e.getBoundingClientRect();t.width-(n.clientX-t.left)<40&&n.clientY-t.top<40&&(e.innerHTML="",e.remove())}if("IMG"==n.target.tagName)if(n.target.style.cursor){var t=n.target.getBoundingClientRect(),o=(s={e:n.target,x:n.clientX,y:n.clientY,w:t.width,h:t.height,d:n.target.style.cursor},n.target.getAttribute("width")||n.target.setAttribute("width",t.width),n.target.getAttribute("height")||n.target.setAttribute("height",t.height),window.getSelection());if(o.rangeCount)for(var r=0;r<o.rangeCount;r++)o.removeRange(o.getRangeAt(r));n.target.classList.add("resizing")}else s=!0;else n.target.classList.contains("jsnippet")?e(n.target):n.target.parentNode.classList.contains("jsnippet")&&e(n.target.parentNode),s=!0},T=function(e){var t,n;"IMG"!=e.target.tagName||e.target.parentNode.classList.contains("jsnippet-image")||1!=c.options.allowImageResize||e.target.getAttribute("tabindex")&&(t=e.target.getBoundingClientRect(),e.clientY-t.top<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="ne-resize":e.clientX-t.left<5?e.target.style.cursor="nw-resize":e.target.style.cursor="n-resize":t.height-(e.clientY-t.top)<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="se-resize":e.clientX-t.left<5?e.target.style.cursor="sw-resize":e.target.style.cursor="s-resize":t.width-(e.clientX-t.left)<5?e.target.style.cursor="e-resize":e.clientX-t.left<5?e.target.style.cursor="w-resize":e.target.style.cursor=""),1==e.which&&s&&s.d&&("e-resize"!=s.d&&"ne-resize"!=s.d&&"se-resize"!=s.d||(s.e.style.width=s.w+(e.clientX-s.x),e.shiftKey?(n=(e.clientX-s.x)*(s.h/s.w),s.e.style.height=s.h+n):n=null),n||"s-resize"!=s.d&&"se-resize"!=s.d&&"sw-resize"!=s.d||e.shiftKey||(s.e.style.height=s.h+(e.clientY-s.y)),s.e.changed=!0)},D=function(e,t){if(c.options.extensions){var n=Object.keys(c.options.extensions);if(n.length)for(var o=0;o<n.length;o++)c.options.extensions[n[o]]&&"function"==typeof c.options.extensions[n[o]][e]&&c.options.extensions[n[o]][e].call(c,t)}};if(document.addEventListener("mouseup",I),document.addEventListener("mousemove",T),c.editor.addEventListener("mousedown",N),c.editor.addEventListener("keyup",L),c.editor.addEventListener("keydown",M),c.editor.addEventListener("dragstart",y),c.editor.addEventListener("dragenter",x),c.editor.addEventListener("dragover",w),c.editor.addEventListener("drop",C),c.editor.addEventListener("paste",v),c.editor.addEventListener("focus",A),c.editor.addEventListener("blur",E),l.appendChild(c.editor),c.options.snippet&&c.appendSnippet(c.options.snippet),c.options.toolbar&&((h=Array.isArray(c.options.toolbar)?{container:!0,responsive:!0,items:c.options.toolbar}:!0===c.options.toolbar?{container:!0,responsive:!0,items:[]}:c.options.toolbar).items&&h.items.length||(h.items=F.getDefaultToolbar(c)),c.options.toolbarOnTop?(l.classList.add("toolbar-on-top"),l.insertBefore(r,l.firstChild)):(c.editor.style.padding="15px",l.appendChild(r)),Z(r,h),r.addEventListener("click",function(){c.editor.focus()})),c.file=document.createElement("input"),c.file.style.display="none",c.file.type="file",c.file.setAttribute("accept","image/*"),c.file.onchange=function(){c.addFile(this.files)},l.appendChild(c.file),c.options.focus&&F.setCursor(c.editor,"initial"==c.options.focus),l.change=c.setData,l.val=function(e){var t;if(void 0===e)return t="true"!==l.getAttribute("data-html"),c.getData(t);c.setData(e)},c.options.extensions){var S=Object.keys(c.options.extensions);if(S.length)for(var O=0;O<S.length;O++)c.options.extensions[S[O]]&&"function"==typeof c.options.extensions[S[O]]&&(c.options.extensions[S[O]]=c.options.extensions[S[O]](l,c))}return"function"==typeof(l.editor=c).options.onload&&c.options.onload(l,c,c.editor),c}E.elements=[];var ee=E;function E(t,e){var n,o={options:{}},r={type:"big",title:"Untitled",width:510,height:472};for(n in r)e&&e.hasOwnProperty(n)?o.options[n]=e[n]:o.options[n]=r[n];return o.state={isMinized:!1},o.setState=function(){o.state.isMinized?o.container.classList.remove("jfloating-minimized"):o.container.classList.add("jfloating-minimized"),o.state.isMinized=!o.state.isMinized},o.close=function(){Components.elements.splice(E.elements.indexOf(o.container),1),o.updatePosition(),t.remove()},o.updatePosition=function(){for(var e=0;e<E.elements.length;e++){var t=E.elements[e],n=E.elements[e-1];t.style.right=e*(n||t).offsetWidth*1.01+"px"}},o.init=function(){for(var e=document.createElement("div");t.children[0];)e.appendChild(t.children[0]);for(o.content=document.createElement("div"),o.content.className="jfloating_content",o.content.innerHTML=t.innerHTML;e.children[0];)o.content.appendChild(e.children[0]);o.container=document.createElement("div"),o.container.className="jfloating",o.container.appendChild(o.content),o.options.title?o.container.setAttribute("title",o.options.title):o.container.classList.add("no-title"),o.options.width&&(o.container.style.width=parseInt(o.options.width)+"px"),o.options.height&&(o.container.style.height=parseInt(o.options.height)+"px"),t.innerHTML="",t.appendChild(o.container),o.container&&o.container.addEventListener("click",function(e){var t,n=e.target.getBoundingClientRect();e.target.classList.contains("jfloating")&&(e=(e.changedTouches&&e.changedTouches[0]?(t=e.changedTouches[0].clientX,e.changedTouches[0]):(t=e.clientX,e)).clientY,n.width-(t-n.left)<50&&e-n.top<50?setTimeout(function(){o.close()},100):o.setState())}),o.container.classList.add("jfloating-"+o.options.type),E.elements.push(o.container),o.updatePosition(),t.floating=o},o.init(),o}var A=function(){function n(e,t){return"function"==typeof n[t.type]?!(!t.allowBlank||""!==e)||n[t.type](e,t):null}function t(){var e=new Date;return e.setHours(0,0,0,0),e}const o={between:function(e,t){return e>=t[0]&&e<=t[1]},"not between":function(e,t){return e<t[0]||e>t[1]},"<":function(e,t){return e<t[0]},"<=":function(e,t){return e<=t[0]},">":function(e,t){return e>t[0]},">=":function(e,t){return e>=t[0]},"=":function(e,t){return e==t[0]},"!=":function(e,t){return e!=t[0]}},r={"valid date":function(){return!0},"=":function(e,t){return e===t[0]},"!=":function(e,t){return e!==t[0]},"<":function(e,t){return e<t[0]},"<=":function(e,t){return e<=t[0]},">":function(e,t){return e>t[0]},">=":function(e,t){return e>=t[0]},between:function(e,t){return e>=t[0]&&e<=t[1]},"not between":function(e,t){return e<t[0]||e>t[1]}},i={contains:function(e,t){return e.includes(t[0])},"not contains":function(e,t){return!e.includes(t[0])},"begins with":function(e,t){return e.startsWith(t[0])},"ends with":function(e,t){return e.endsWith(t[0])},"=":function(e,t){return e===t[0]},"!=":function(e,t){return e!==t[0]},"valid email":function(e){return new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/).test(e)},"valid url":function(e){return new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(e)}},l=(n.url=function(){return!!new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(data)},n.email=function(e){var t=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!(!e||!t.test(e))},n.required=function(e){return!!e.trim()},n.exist=function(e,t){return!!e.toString().trim()},n["not exist"]=function(e,t){return!e.toString().trim()},n.empty=function(e){return!e.toString().trim()},n.notEmpty=function(e){return!!e.toString().trim()},n.number=function(e,t){var n;return n=e,!isNaN(n)&&null!==n&&""!==n&&(!t||!t.criteria||!!o[t.criteria]&&(n=t.value.map(function(e){return parseFloat(e)}),o[t.criteria](e,n)))},n.login=function(e){var t=new RegExp(/^[a-zA-Z0-9._-]+$/);return!(!e||!t.test(e))},n.list=function(t,e){var n=typeof t;if("string"!=n&&"number"!=n)return!1;let o;return o="string"==typeof e.value[0]?e.value[0].split(","):e.value[0],!!Array.isArray(o)&&-1<o.findIndex(function(e){return e==t})},{"one year ago":function(){var e=t();return e.setFullYear(e.getFullYear()-1),e},"one month ago":function(){var e=t();return e.setMonth(e.getMonth()-1),e},"one week ago":function(){var e=t();return e.setDate(e.getDate()-7),e},yesterday:function(){var e=t();return e.setDate(e.getDate()-1),e},today:t,tomorrow:function(){var e=t();return e.setDate(e.getDate()+1),e}});return n.date=function(e,t){var n;return"Invalid Date"!=new Date(e)&&(!t||!t.criteria||!!r[t.criteria]&&(n=t.value.map(function(e){return("string"==typeof e&&l[e]?l[e]():new Date(e)).getTime()}),r[t.criteria](new Date(e).getTime(),n)))},n.text=function(e,t){return"string"==typeof e&&(!t||!t.criteria||!!i[t.criteria]&&i[t.criteria](e,t.value))},n.textLength=function(e,t){return e=e.toString(),n.number(e.length,t)},n}();L.getValue=function(e){var t=null;if("checkbox"==e.type)1==e.checked&&(t=e.value||!0);else if("radio"==e.type)1==e.checked&&(t=e.value);else if("file"==e.type)t=e.files;else if("select"==e.tagName&&1==e.multiple)for(var t=[],n=e.querySelectorAll("options[selected]"),o=0;o<n.length;o++)t.push(n[o].value);else t="function"==typeof e.val?e.val():e.value||"";return t},L.getElements=function(e,t){for(var n,o={},r=e.querySelectorAll("input, select, textarea, div[name]"),i=0;i<r.length;i++)(n=r[i].getAttribute("name"))&&(o[n]=L.getValue(r[i])||"");return 1==t?o:JSON.stringify(o)},L.setElements=function(e,t){for(var n=null,o=null,r=e.querySelectorAll("input, select, textarea, div[name]"),i=0;i<r.length;i++){var l,s=r[i].getAttribute("type");(n=r[i].getAttribute("name"))&&(o=null,(n=n.replace(new RegExp(/\[(.*?)\]/gi),".$1")).match(/\./)?void 0!==(l=O.call(t,n)||"")&&(o=l):void 0!==t[n]&&(o=t[n]),null!==o)&&("checkbox"==s||"radio"==s?r[i].checked=!!o:"file"!=s&&("function"==typeof r[i].val?r[i].val(o):r[i].value=o))}};var te=L;function L(s,e){var t,a={options:{}},n={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(e,t){alert(t)}};for(t in n)e&&e.hasOwnProperty(t)?a.options[t]=e[t]:a.options[t]=n[t];return a.options.validations||(a.options.validations={}),a.options.submitButton||(a.options.submitButton=s.querySelector("input[type=submit]")),a.options.submitButton&&a.options.url&&(a.options.submitButton.onclick=function(){a.save()}),a.options.validations.email||(a.options.validations.email=A.email),a.options.validations.length||(a.options.validations.length=A.length),a.options.validations.required||(a.options.validations.required=A.required),a.setUrl=function(e){a.options.url=e},a.load=function(){R({url:a.options.url,method:"GET",dataType:"json",queue:!0,success:function(e){var t;"function"==typeof a.options.onbeforeload&&(t=a.options.onbeforeload(s,e))&&(e=t),L.setElements(s,e),"function"==typeof a.options.onload&&a.options.onload(s,e)}})},a.save=function(){var e=a.validate();if(e)a.options.onerror(s,e);else{var t=L.getElements(s,!0);if("function"==typeof a.options.onbeforesave)if(!1===(t=a.options.onbeforesave(s,t)))return;R({url:a.options.url,method:"POST",dataType:"json",data:t,success:function(e){"function"==typeof a.options.onsave&&a.options.onsave(s,t,e)}})}},a.remove=function(){if("function"==typeof a.options.onbeforeremove&&!1===a.options.onbeforeremove(s,a))return!1;R({url:a.options.url,method:"DELETE",dataType:"json",success:function(e){"function"==typeof a.options.onremove&&a.options.onremove(s,a,e),a.reset()}})},a.validateElement=function(e){var t=!1,n=L.getValue(e),o=e.getAttribute("data-validation");if("function"!=typeof a.options.validations[o]||a.options.validations[o](n,e)){if(e.classList.contains("error")){for(var o=e,r=!1,i=(o.classList.remove("error"),o.removeAttribute("title"),s.querySelectorAll("input, select, textarea, div[name]")),l=0;l<i.length;l++)i[l].getAttribute("data-validation")&&i[l].classList.contains("error")&&(r=!0);a.options.submitButton&&(r?a.options.submitButton.setAttribute("disabled",!0):a.options.submitButton.removeAttribute("disabled"))}}else(n=e).classList.add("error"),a.options.submitButton&&a.options.submitButton.setAttribute("disabled",!0),o=n.getAttribute("data-error")||"There is an error in the form",n.setAttribute("title",o),t=o;return t},a.reset=function(){for(var e=s.querySelectorAll("input, select, textarea, div[name]"),t=0;t<e.length;t++)e[t].getAttribute("name")&&("checkbox"==e[t].type||"radio"==e[t].type?e[t].checked=!1:"function"==typeof e[t].val?e[t].val(""):e[t].value="")},a.validate=function(){for(var e,t=[],n=s.querySelectorAll("input, select, textarea, div[name]"),o=0;o<n.length;o++)n[o].getAttribute("data-validation")&&(e=a.validateElement(n[o]))&&t.push(e);return 0<t.length&&t.join("<br>")},a.getError=function(){return!!a.validation()},a.setHash=function(){return a.getHash(L.getElements(s))},a.getHash=function(e){var t,n=0;if(0!==e.length)for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},a.isChanged=function(){var e=a.setHash();return a.options.currentHash!=e},a.resetTracker=function(){a.options.currentHash=a.setHash(),a.options.ignore=!1},a.setIgnore=function(e){a.options.ignore=!!e},setTimeout(function(){a.options.currentHash=a.setHash()},1e3),s.addEventListener("keyup",function(e){e.target.getAttribute("data-validation")&&a.validateElement(e.target)}),L.hasEvents||(window.addEventListener("beforeunload",function(e){if(a.isChanged()&&0==a.options.ignore){var t=a.options.message||"o/";if(t)return(e=void 0===e?window.event:e)&&(e.returnValue=t),t}}),L.hasEvents=!0),s.form=a}function ne(t,e){var n,o={options:{}},r={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(n in r)e&&e.hasOwnProperty(n)?o.options[n]=e[n]:o.options[n]=r[n];!o.options.title&&t.getAttribute("title")&&(o.options.title=t.getAttribute("title"));for(var i,l,s=document.createElement("div");t.children[0];)s.appendChild(t.children[0]);for(o.title=document.createElement("div"),o.title.className="jmodal_title",o.options.icon&&o.title.setAttribute("data-icon",o.options.icon),o.content=document.createElement("div"),o.content.className="jmodal_content",o.content.innerHTML=t.innerHTML;s.children[0];)o.content.appendChild(s.children[0]);return o.container=document.createElement("div"),o.container.className="jmodal",o.container.appendChild(o.title),o.container.appendChild(o.content),o.options.padding&&(o.content.style.padding=o.options.padding),o.options.width&&(o.container.style.width=o.options.width),o.options.height&&(o.container.style.height=o.options.height),o.options.title&&((i=document.createElement("h4")).innerText=o.options.title,o.title.appendChild(i)),t.innerHTML="",t.style.display="none",t.appendChild(o.container),o.options.backdrop&&((l=document.createElement("div")).className="jmodal_backdrop",l.onclick=function(){o.close()},t.appendChild(l)),o.open=function(){t.style.display="block";var e=o.container.getBoundingClientRect();k.getWindowWidth()<e.width?(o.container.style.top="",o.container.style.left="",o.container.classList.add("jmodal_fullscreen"),D.slideBottom(o.container,1)):o.options.backdrop&&(l.style.display="block"),"function"==typeof o.options.onopen&&o.options.onopen(t,o)},o.resetPosition=function(){o.container.style.top="",o.container.style.left=""},o.isOpen=function(){return"none"!=t.style.display},o.close=function(){o.isOpen()&&(t.style.display="none",o.options.backdrop&&(l.style.display=""),o.container.classList.remove("jmodal_fullscreen"),"function"==typeof o.options.onclose)&&o.options.onclose(t,o)},o.options.url?R({url:o.options.url,method:"GET",dataType:"text/html",success:function(e){o.content.innerHTML=e,o.options.closed||o.open(),"function"==typeof o.options.onload&&o.options.onload(o)}}):(o.options.closed||o.open(),"function"==typeof o.options.onload&&o.options.onload(o)),t.modal=o,oe(),oe=function(){},o}var oe;oe=function(){var i=null;document.addEventListener("keydown",function(e){if(27==e.which)for(var t=document.querySelectorAll(".jmodal"),n=0;n<t.length;n++)t[n].parentNode.modal.close()}),document.addEventListener("mouseup",function(e){var t,n,o=k.findElement(e.target,"jmodal");o&&(t=o.getBoundingClientRect(),e=(e.changedTouches&&e.changedTouches[0]?(n=e.changedTouches[0].clientX,e.changedTouches[0]):(n=e.clientX,e)).clientY,t.width-(n-t.left)<50)&&e-t.top<50&&o.parentNode.modal.close(),i&&(i.element.style.cursor="auto",i=null)}),document.addEventListener("mousedown",function(e){var t,n,o,r=k.findElement(e.target,"jmodal");r&&(t=r.getBoundingClientRect(),o=(e.changedTouches&&e.changedTouches[0]?(n=e.changedTouches[0].clientX,e.changedTouches[0]):(n=e.clientX,e)).clientY,t.width-(n-t.left)<50&&o-t.top<50||o-t.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),i={left:t.left,top:t.top,x:e.clientX,y:e.clientY,width:t.width,height:t.height,element:r}))}),document.addEventListener("mousemove",function(e){i&&((e=e||window.event).buttons||e.button||e.which?(i.element.style.top=i.top+(e.clientY-i.y)+i.height/2+"px",i.element.style.left=i.left+(e.clientX-i.x)+i.width/2+"px",i.element.style.cursor="move"):i.element.style.cursor="auto")})};ie.isVisible=function(){var e=document.querySelector(".jnotification");return!(!e||!e.parentNode)};var re=ie;function ie(e){var t,n={options:{}},o={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(t in o)e&&e.hasOwnProperty(t)?n.options[t]=e[t]:n.options[t]=o[t];var r,i=document.createElement("div"),l=(i.className="jnotification",n.options.error&&i.classList.add("jnotification-error"),document.createElement("div")),s=(l.className="jnotification-container",i.appendChild(l),document.createElement("div")),a=(s.className="jnotification-header",l.appendChild(s),document.createElement("div"));a.className="jnotification-image",s.appendChild(a),n.options.icon&&((c=document.createElement("img")).src=n.options.icon,a.appendChild(c)),(a=document.createElement("div")).className="jnotification-name",a.innerHTML=n.options.name,s.appendChild(a),1==n.options.closeable&&((c=document.createElement("div")).className="jnotification-close",c.onclick=function(){n.hide()},s.appendChild(c));(a=document.createElement("div")).className="jnotification-date",s.appendChild(a);var c=document.createElement("div");return c.className="jnotification-content",l.appendChild(c),n.options.title&&((s=document.createElement("div")).className="jnotification-title",s.innerHTML=n.options.title,c.appendChild(s)),(a=document.createElement("div")).className="jnotification-message",a.innerHTML=n.options.message,c.appendChild(a),n.show=function(){document.body.appendChild(i),800<k.getWindowWidth()?D.fadeIn(i):D.slideTop(i,1)},n.hide=function(){800<k.getWindowWidth()?D.fadeOut(i,function(){i.parentNode&&(i.parentNode.removeChild(i),r)&&clearTimeout(r)}):D.slideTop(i,0,function(){i.parentNode&&(i.parentNode.removeChild(i),r)&&clearTimeout(r)})},n.show(),1==n.options.autoHide&&(r=setTimeout(function(){n.hide()},n.options.timeout)),k.getWindowWidth()<800&&i.addEventListener("swipeup",function(e){n.hide(),e.preventDefault(),e.stopPropagation()}),n}function le(a,e){var t,n,o,r,c,u;return a.search||(n=function(e){var t;if("function"==typeof c.options.onsearch&&(t=c.options.onsearch(c,e))&&(e=t),u.innerHTML="",e.length){a.style.display="block";for(var n=e.length<11?e.length:10,o=0;o<n;o++){"string"==typeof e[o]?(r=e[o],i=e[o]):(!(r=e[o].text)&&e[o].name&&(r=e[o].name),!(i=e[o].value)&&e[o].id&&(i=e[o].id));var r,i,l=document.createElement("div"),s=(l.setAttribute("data-value",i),l.setAttribute("data-text",r),l.className="jsearch_item",e[o].id&&l.setAttribute("id",e[o].id),c.options.forceSelect&&0==o&&l.classList.add("selected"),document.createElement("img")),s=(e[o].image?s.src=e[o].image:s.style.display="none",l.appendChild(s),document.createElement("div"));s.innerHTML=r,l.appendChild(s),u.appendChild(l)}}else a.style.display=""},o=function(o){var e;o!=c.terms&&(c.terms=o,t=c.options.forceSelect?0:null,Array.isArray(c.options.data)?(e=c.options.data.filter(function(e){var t=e;if("string"==typeof t){if(0<=(""+t).toLowerCase().search(o.toLowerCase()))return!0}else for(var n in t)if(0<=(""+t[n]).toLowerCase().search(o.toLowerCase()))return!0;return!1}),n(e)):R({url:c.options.data+o,method:"GET",dataType:"json",success:function(e){n(e)}}))},c=function(e){r&&clearTimeout(r),r=setTimeout(function(){o(e)},500)},(r=t=null)===e.forceSelect&&(e.forceSelect=!0),c.options={data:e.data||null,input:e.input||null,searchByNode:e.searchByNode||null,onselect:e.onselect||null,forceSelect:e.forceSelect,onsearch:e.onsearch||null,onbeforesearch:e.onbeforesearch||null},c.selectIndex=function(e){var t=e.getAttribute("id"),n=e.getAttribute("data-text"),o=e.getAttribute("data-value"),e=e.children[0].src||"";"function"==typeof c.options.onselect&&c.options.onselect(c,n,o,t,e),c.close()},c.open=function(){a.style.display="block"},c.close=function(){r&&clearTimeout(r),c.terms="",u.innerHTML="",a.style.display=""},c.isOpened=function(){return!!a.style.display},c.keydown=function(e){c.isOpened()&&("Enter"==e.key?null!==t&&u.children[t]?(c.selectIndex(u.children[t]),e.preventDefault()):c.close():"ArrowUp"===e.key?(null!==t&&u.children[0]&&(u.children[t].classList.remove("selected"),c.options.forceSelect||0!==t?(t=Math.max(0,t-1),u.children[t].classList.add("selected")):t=null),e.preventDefault()):"ArrowDown"===e.key&&(null==t?t=-1:u.children[t].classList.remove("selected"),t<9&&u.children[t+1]&&t++,u.children[t].classList.add("selected"),e.preventDefault()))},c.keyup=function(e){var t;if(!c.options.searchByNode&&c.options.input?t="DIV"===c.options.input.tagName?c.options.input.innerText:c.options.input.value:(n=k.getNode())&&(t=n.innerText),"function"==typeof c.options.onbeforesearch){var n=c.options.onbeforesearch(c,t);if(n)t=n;else if(!1===n)return}c(t)},c.blur=function(e){c.close()},c.options.input&&(c.options.input.addEventListener("keyup",c.keyup),c.options.input.addEventListener("keydown",c.keydown),c.options.input.addEventListener("blur",c.blur)),(u=document.createElement("div")).classList.add("jsearch_container"),u.onmousedown=function(e){var t;t=e.target.classList.contains("jsearch_item")?e.target:e.target.parentNode,c.selectIndex(t),e.preventDefault()},a.appendChild(u),a.classList.add("jsearch"),a.search=c)}function se(i,e){var t,l={options:{}},n={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(t in n)e&&e.hasOwnProperty(t)?l.options[t]=e[t]:l.options[t]=n[t];1==l.options.multiple&&i.setAttribute("data-multiple",!0),i.content=[],i.classList.add("jupload"),1==l.options.input&&i.classList.add("input"),l.add=function(e){var t,n;0==l.options.multiple&&(i.content=[],i.innerText=""),"image"==l.options.type?((t=document.createElement("img")).setAttribute("src",e.file),t.setAttribute("tabindex",-1),i.getAttribute("name")||(t.className="jfile",t.content=e),i.appendChild(t)):(t=e.name||e.file,(n=document.createElement("div")).innerText=t||l.options.type,n.classList.add("jupload-item"),n.setAttribute("tabindex",-1),i.appendChild(n)),e.content&&(e.file=k.guid()),i.content.push(e),"function"==typeof l.options.onchange&&l.options.onchange(i,e)},l.addFromFile=function(t){var e;t.type.split("/")[0]==l.options.type?((e=new FileReader).addEventListener("load",function(e){e={file:e.srcElement.result,extension:t.name.substr(t.name.lastIndexOf(".")+1),name:t.name,size:t.size,lastmodified:t.lastModified,content:e.srcElement.result};l.add(e)}),e.readAsDataURL(t)):alert(N.translate("This extension is not allowed"))},l.addFromUrl=function(e){var t,n;"data"==e.substr(0,4)||l.options.remoteParser?"data"==e.substr(0,4)?(n=(n=e.split(";"))[0].split("/"))[0].replace("data:","")==l.options.type?(t={file:e,name:"",extension:n[1],content:e},l.add(t)):alert(l.options.text.extensionNotAllowed):(n=e.substr(e.lastIndexOf(".")+1),e=l.options.remoteParser+e,R({url:e,type:"GET",dataType:"blob",success:function(e){}})):console.error("remoteParser not defined in your initialization")};var o=l.options.type+"/"+l.options.extension,r=document.createElement("input"),s=(r.type="file",r.setAttribute("accept",o),r.onchange=function(){for(var e=0;e<this.files.length;e++)l.addFromFile(this.files[e])},1==l.options.multiple&&r.setAttribute("multiple",!0),null);return i.addEventListener("click",function(e){s=null,i.children.length&&e.target!==i?e.target.parentNode==i&&(s=e.target):k.click(r)}),i.addEventListener("dblclick",function(e){k.click(r)}),i.addEventListener("dragenter",function(e){i.style.border="1px dashed #000"}),i.addEventListener("dragleave",function(e){i.style.border="1px solid #eee"}),i.addEventListener("dragstop",function(e){i.style.border="1px solid #eee"}),i.addEventListener("dragover",function(e){e.preventDefault()}),i.addEventListener("keydown",function(e){s&&46==e.which&&0<=(e=Array.prototype.indexOf.call(i.children,s))&&(i.content.splice(e,1),s.remove(),s=null)}),i.addEventListener("drop",function(e){e.preventDefault(),e.stopPropagation();var t=(e.originalEvent||e).dataTransfer.getData("text/html");if((e.originalEvent||e).dataTransfer.files.length)for(var n=0;n<e.dataTransfer.files.length;n++)l.addFromFile(e.dataTransfer.files[n]);else if(t){0==l.options.multiple&&(i.innerText="");var o=document.createElement("div"),r=(o.innerHTML=t,o.querySelectorAll("img"));if(r.length)for(n=0;n<r.length;n++)l.addFromUrl(r[n].src)}return!(i.style.border="1px solid #eee")}),i.val=function(e){if(void 0===e)return i.content&&i.content.length?i.content:null;if(i.innerText="",i.content=[],e)if(Array.isArray(e))for(var t=0;t<e.length;t++)"string"==typeof e[t]?l.add({file:e[t]}):l.add(e[t]);else"string"==typeof e&&l.add({file:e})},i.upload=i.image=l}function ae(){document.jsuitesComponents=[];const a=function(e,t){return!(!e[t.type]||e[t.type]!=t)||!(!e.component||e.component!=t)||!!e.parentNode&&a(e.parentNode,t)};let c=null,u=!1,l={x:null,y:null},o=document.createElement("div");o.classList.add("jtooltip"),document.addEventListener("mouseup",function(e){u&&u.e&&("function"==typeof u.e.refresh&&l.actioned&&u.e.refresh(),u.e.style.cursor=""),l={x:null,y:null},u=!1}),document.addEventListener("mousedown",function(e){var t,n=M.findElement(e.target,"jpanel");if(n&&!n.classList.contains("readonly")){n.focus();var o=e.target.getBoundingClientRect(),r=(u={e:n,x:e.clientX,y:e.clientY,w:o.width,h:o.height,d:n.style.cursor,resizing:!!n.style.cursor,actioned:!1},n.style.width||(n.style.width=o.width+"px"),n.style.height||(n.style.height=o.height+"px"),window.getSelection());if(r.rangeCount)for(var i=0;i<r.rangeCount;i++)r.removeRange(r.getRangeAt(i));e.preventDefault(),e.stopPropagation()}else u=!1;n=(e.changedTouches&&e.changedTouches[0]?(t=e.changedTouches[0].clientX,e.changedTouches[0]):(t=e.clientX,e)).clientY;var o=e.path||e.composedPath&&e.composedPath(),l=c=o?o[0]:(e.target&&e.target.shadowRoot?e.target.shadowRoot:document).elementFromPoint(t,n);if(document.jsuitesComponents&&0<document.jsuitesComponents.length)for(var s=0;s<document.jsuitesComponents.length;s++)document.jsuitesComponents[s]&&!a(l,document.jsuitesComponents[s])&&document.jsuitesComponents[s].close()}),document.addEventListener("mousemove",function(e){var t,n,o,r,i;u?(i=e.clientX||e.pageX,t=e.clientY||e.pageY,u.resizing?(n=o=null,"e-resize"!=u.d&&"ne-resize"!=u.d&&"se-resize"!=u.d||(o=u.w+(i-u.x),u.e.style.width=o+"px",e.shiftKey?(r=(i-u.x)*(u.h/u.w),n=u.h+r,u.e.style.height=n+"px"):r=!1),r||"s-resize"!=u.d&&"se-resize"!=u.d&&"sw-resize"!=u.d||(n=u.h+(t-u.y),u.e.style.height=n+"px"),"function"==typeof u.e.refresh&&(l.actioned=!0,u.e.refresh("dimensions",o,n))):(null==l.x&&null==l.y&&(l.x=i,l.y=t),r=i-l.x,o=t-l.y,n=u.e.offsetTop+o,o=u.e.offsetLeft+r,u.e.style.top=n+"px",u.e.style.left=o+"px",u.e.style.cursor="move",l.x=i,l.y=t,"function"==typeof u.e.refresh&&(l.actioned=!0,u.e.refresh("position",n,o)))):(r=M.findElement(e.target,"jpanel"))&&r.getAttribute("tabindex")&&(i=r.getBoundingClientRect(),e.clientY-i.top<15?i.width-(e.clientX-i.left)<15?r.style.cursor="ne-resize":e.clientX-i.left<15?r.style.cursor="nw-resize":r.style.cursor="n-resize":i.height-(e.clientY-i.top)<15?i.width-(e.clientX-i.left)<15?r.style.cursor="se-resize":e.clientX-i.left<15?r.style.cursor="sw-resize":r.style.cursor="s-resize":i.width-(e.clientX-i.left)<15?r.style.cursor="e-resize":e.clientX-i.left<15?r.style.cursor="w-resize":r.style.cursor="")}),document.addEventListener("mouseover",function(e){var t,n=e.target.getAttribute("data-tooltip");n?(o.innerText=n,n=(e.changedTouches&&e.changedTouches[0]?(t=e.changedTouches[0].clientX,e.changedTouches[0]):(t=e.clientX,e)).clientY,o.style.top=n+"px",o.style.left=t+"px",document.body.appendChild(o)):o.innerText&&(o.innerText="",document.body.removeChild(o))}),document.addEventListener("dblclick",function(e){var t=M.findElement(e.target,"jpanel");t&&"function"==typeof t.dblclick&&t.dblclick(e)}),document.addEventListener("keydown",function(e){let t=document.activeElement;t&&"Delete"===e.key&&"function"==typeof t.delete&&(t.delete(),e.preventDefault(),e.stopImmediatePropagation()),document.jsuitesComponents&&document.jsuitesComponents.length&&(t=document.jsuitesComponents[document.jsuitesComponents.length-1])&&"Escape"===e.key&&"function"==typeof t.isOpened&&"function"==typeof t.close&&t.isOpened()&&(t.close(),e.preventDefault(),e.stopImmediatePropagation())}),document.addEventListener("contextmenu",function(e){var t,n=document.activeElement;n&&"function"==typeof n.contextmenu?(n.contextmenu(e),e.preventDefault(),e.stopImmediatePropagation()):(n=M.findElement(e.target,function(e){return e.tagName&&e.getAttribute("aria-contextmenu-id")}))&&((t=document.querySelector("#"+n))?(t.contextmenu.open(e),e.preventDefault(),e.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+n))}),document.addEventListener("input",function(e){(e.target.getAttribute("data-mask")||e.target.mask)&&M.mask(e)})}var ce=de(195),ce=de.n(ce),M={...N,...k,version:"5.0.22",setExtensions:function(e){if("object"==typeof e)for(var t=Object.keys(e),n=0;n<t.length;n++)M[t[n]]=e[t[n]]},tracking:T,path:O,sorting:H,lazyLoading:B,ajax:R,animation:D,calendar:U,color:G,contextmenu:$,dropdown:K,editor:Q,floating:ee,form:te,mask:e,modal:ne,notification:re,palette:z,picker:J,progressbar:function(o,e){var t,r={options:{}},n={value:0,onchange:null,width:null};for(t in n)e&&e.hasOwnProperty(t)?r.options[t]=e[t]:r.options[t]=n[t];function i(e){var t,n;e.which&&(t=o.getBoundingClientRect(),(e.changedTouches&&e.changedTouches[0]?(n=e.changedTouches[0].clientX,e.changedTouches[0]):(n=e.clientX,e)).clientY,r.setValue(Math.round((n-t.left)/t.width*100)))}o.classList.add("jprogressbar"),o.setAttribute("tabindex",1),o.setAttribute("data-value",r.options.value);var l=document.createElement("div");return l.style.width=r.options.value+"%",l.style.color="#fff",o.appendChild(l),r.options.width&&(o.style.width=r.options.width),r.setValue=function(e){e=parseInt(e),r.options.value=e,l.style.width=e+"%",o.setAttribute("data-value",e+"%"),o.style.color=e<6?"#000":"#fff",r.options.value=e,"function"==typeof r.options.onchange&&r.options.onchange(o,e),o.value!=r.options.value&&(o.value=r.options.value,"function"==typeof o.oninput)&&o.oninput({type:"input",target:o,value:o.value})},r.getValue=function(){return r.options.value},"touchstart"in document.documentElement==!0?(o.addEventListener("touchstart",i),o.addEventListener("touchend",i)):(o.addEventListener("mousedown",i),o.addEventListener("mousemove",i)),o.change=r.setValue,o.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},o.progressbar=r},rating:function(l,e){var s;return l.rating?l.rating.setOptions(e,!0):((s={options:{},setOptions:function(e,t){var n,o={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(n in o)e&&e.hasOwnProperty(n)?s.options[n]=e[n]:void 0!==s.options[n]&&!0!==t||(s.options[n]=o[n]);l.innerHTML="";for(var r=0;r<s.options.number;r++){var i=document.createElement("div");i.setAttribute("data-index",r+1),i.setAttribute("title",s.options.tooltip[r]),l.appendChild(i)}if(s.options.value)for(r=0;r<s.options.number;r++)r<s.options.value&&l.children[r].classList.add("jrating-selected");return s},setValue:function(e){for(var t=0;t<s.options.number;t++)t<e?l.children[t].classList.add("jrating-selected"):(l.children[t].classList.remove("jrating-over"),l.children[t].classList.remove("jrating-selected"));s.options.value=e,"function"==typeof s.options.onchange&&s.options.onchange(l,e),l.value!=s.options.value&&(l.value=s.options.value,"function"==typeof l.oninput)&&l.oninput({type:"input",target:l,value:l.value})},getValue:function(){return s.options.value}}).setOptions(e),l.classList.add("jrating"),l.addEventListener("click",function(e){e=e.target.getAttribute("data-index");null!=e&&(e==s.options.value?s.setValue(0):s.setValue(e))}),l.addEventListener("mouseover",function(e){for(var t=e.target.getAttribute("data-index"),n=0;n<s.options.number;n++)n<t?l.children[n].classList.add("jrating-over"):l.children[n].classList.remove("jrating-over")}),l.addEventListener("mouseout",function(e){for(var t=0;t<s.options.number;t++)l.children[t].classList.remove("jrating-over")}),l.change=s.setValue,l.val=function(e){if(void 0===e)return s.getValue();s.setValue(e)},l.rating=s)},search:le,slider:function(o,e){var r={options:{},currentImage:null};if(e&&(r.options=e),o.setAttribute("tabindex","900"),r.options.items=[],!o.classList.contains("jslider")){o.classList.add("jslider"),o.classList.add("unselectable"),r.options.height&&(o.style.minHeight=parseInt(r.options.height)+"px"),r.options.width&&(o.style.width=parseInt(r.options.width)+"px"),r.options.grid&&(o.classList.add("jslider-grid"),4<(e=o.children.length)&&o.setAttribute("data-total",e-4),o.setAttribute("data-number",4<e?4:e));var i=document.createElement("div");if(i.classList.add("jslider-counter"),0<o.children.length)for(var t=0;t<o.children.length;t++){r.options.items.push(o.children[t]);var n=document.createElement("div");n.onclick=function(){var e=Array.prototype.slice.call(i.children).indexOf(this);r.show(r.currentImage=r.options.items[e])},i.appendChild(n)}var e=document.createElement("div"),l=(e.className="jslider-caption",document.createElement("div")),s=document.createElement("div");s.className="jslider-close",s.innerHTML="",s.onclick=function(){r.close()},l.appendChild(e),l.appendChild(s)}function a(e){var t;"IMG"==e.target.tagName?r.show(e.target):e.target.classList.contains("jslider-close")||e.target.parentNode.classList.contains("jslider-counter")||e.target.classList.contains("jslider-counter")||(t=e.offsetX||e.changedTouches[0].clientX,e.target.clientWidth-t<40?r.next():t<40&&r.prev())}return r.updateCounter=function(e){for(var t=0;t<i.children.length;t++)if(i.children[t].classList.contains("jslider-counter-focus")){i.children[t].classList.remove("jslider-counter-focus");break}i.children[e].classList.add("jslider-counter-focus")},r.show=function(e){e=e||o.children[0],o.classList.add("jslider-focus"),o.classList.remove("jslider-grid"),o.appendChild(l),o.appendChild(i);var t=r.options.items.indexOf(e);r.updateCounter(t);for(var n=0;n<o.children.length;n++)o.children[n].style.display="";e.style.display="block",e.previousElementSibling?o.classList.add("jslider-left"):o.classList.remove("jslider-left"),e.nextElementSibling&&"IMG"==e.nextElementSibling.tagName?o.classList.add("jslider-right"):o.classList.remove("jslider-right"),r.currentImage=e,r.currentImage.offsetHeight>r.currentImage.offsetWidth&&r.currentImage.classList.add("jslider-vertical"),l.children[0].innerText=r.currentImage.getAttribute("title")},r.open=function(){r.show(),"function"==typeof r.options.onopen&&r.options.onopen(o)},r.close=function(){o.classList.remove("jslider-focus"),o.classList.remove("jslider-left"),o.classList.remove("jslider-right"),r.options.grid&&o.classList.add("jslider-grid");for(var e=0;e<o.children.length;e++)o.children[e].style.display="";i.remove(),l.remove(),r.currentImage=null,"function"==typeof r.options.onclose&&r.options.onclose(o)},r.reset=function(){o.innerHTML=""},r.next=function(){var e=r.currentImage.nextElementSibling;e&&"IMG"===e.tagName&&r.show(r.currentImage.nextElementSibling)},r.prev=function(){r.currentImage.previousElementSibling&&r.show(r.currentImage.previousElementSibling)},"ontouchend"in document.documentElement==!0?o.addEventListener("touchend",a):o.addEventListener("mouseup",a),o.addEventListener("swipeleft",function(e){r.next(),e.preventDefault(),e.stopPropagation()}),o.addEventListener("swiperight",function(e){r.prev(),e.preventDefault(),e.stopPropagation()}),o.addEventListener("keydown",function(e){27==e.which&&r.close()}),o.slider=r},tabs:X,tags:function(s,e){var a,c,u,r,d,p,f,i,t,o,n,l,h,g,m,b,j;return s.tags?s.tags.setOptions(e,!0):(c=function(){return!!(a.options.limit&&s.children.length>=a.options.limit)},r=u=null,a={type:"tags",options:{},setOptions:function(e,t){var n,o={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(n in o)e&&e.hasOwnProperty(n)?a.options[n]=e[n]:void 0!==a.options[n]&&!0!==t||(a.options[n]=o[n]);return a.options.placeholder?s.setAttribute("data-placeholder",a.options.placeholder):s.removeAttribute("data-placeholder"),s.placeholder=a.options.placeholder,a.setValue(a.options.value),i(),a.options.search?r||(r=document.createElement("div"),s.parentNode.insertBefore(r,s.nextSibling),u=le(r,{data:a.options.search,onselect:function(e,t,n){a.selectIndex(t,n)}})):r&&(u=null,r.remove(),r=null),a},add:function(e,t){if("function"==typeof a.options.onbeforechange){var n=a.options.onbeforechange(s,a,a.options.value,e);if(!1===n)return!1;null!=n&&(e=n)}if(u&&u.close(),c())"function"==typeof a.options.onlimit?a.options.onlimit(a,a.options.limit):alert(N.translate("You reach the limit number of entries")+" "+a.options.limit);else{n=k.getNode();if(!(n&&n.parentNode&&n.parentNode.classList.contains("jtags")&&n.nextSibling)||n.nextSibling.innerText&&n.nextSibling.innerText.trim()){if(!s.lastChild||s.lastChild.innerText.trim()||s.removeChild(s.lastChild),e&&"string"!=typeof e)for(var o,r,i=0;i<=e.length;i++)c()||(r=e[i]&&"string"!=typeof e[i]?(o=e[i].text,e[i].value):(o=e[i]||"",null),l=p(o,r));else var l=p(e,e,n);f()}else l=n.nextSibling;t&&d(l)}},setLimit:function(e){a.options.limit=e;for(s.children.length;s.children.length>e;)s.removeChild(s.lastChild)},remove:function(e){e.parentNode.removeChild(e),s.children.length?f():a.add("",!0)},getData:function(){for(var e=[],t=0;t<s.children.length;t++){var n=s.children[t].innerText.replace("\n",""),o=(o=s.children[t].getAttribute("data-value"))||n;(n||o)&&e.push({text:n,value:o})}return e},getValue:function(e){var t=null;if(null!=e)t=(t=s.children[e].getAttribute("data-value"))||s.children[e].innerText.replace("\n","");else{for(var n=[],o=0;o<s.children.length;o++)(t=s.children[o].innerText.replace("\n",""))&&n.push(a.getValue(o));t=n.join(",")}return t},setValue:function(e){e?s.value!=e&&(Array.isArray(e)?a.add(e):(e=(""+e).trim(),e=o(e),s.innerHTML="",a.add(e))):a.reset()},reset:function(){s.classList.add("jtags-empty"),s.innerHTML="<div></div>",f()},isValid:function(){for(var e=0,t=0;t<s.children.length;t++)s.children[t].classList.contains("jtags_error")&&e++;return 0==e},selectIndex:function(e,t){var n=k.getNode();n&&(n.innerText=e,t&&n.setAttribute("data-value",t),n.classList.remove("jtags_error"),c()||a.add("",!0))},search:function(e){e.innerText},destroy:function(){s.removeEventListener("mouseup",m),s.removeEventListener("keydown",l),s.removeEventListener("keyup",h),s.removeEventListener("paste",g),s.removeEventListener("focus",b),s.removeEventListener("blur",j),s.parentNode.removeChild(s)}},d=function(e){var t,n;s.children.length&&(t=document.createRange(),n=window.getSelection(),e=e||s.childNodes[s.childNodes.length-1],t.setStart(e,e.length),t.collapse(!0),n.removeAllRanges(),n.addRange(t),s.scrollLeft=s.scrollWidth)},p=function(e,t,n){var o=document.createElement("div");return o.innerHTML=e||"",t&&o.setAttribute("data-value",t),n&&n.parentNode.classList.contains("jtags")?s.insertBefore(o,n.nextSibling):s.appendChild(o),o},f=function(){var e=a.getValue();e!=a.options.value&&(a.options.value=e,"function"==typeof a.options.onchange&&a.options.onchange(s,a,a.options.value),s.value!=a.options.value)&&(s.value=a.options.value,"function"==typeof s.oninput)&&s.oninput({type:"input",target:s,value:s.value}),i()},i=function(){for(var e=0;e<s.children.length;e++)"DIV"===s.children[e].tagName&&(a.getValue(e)?(s.children[e].classList.add("jtags_label"),"function"!=typeof a.options.validation||!a.getValue(e)||a.options.validation(s.children[e],s.children[e].innerText,s.children[e].getAttribute("data-value"))?s.children[e].classList.remove("jtags_error"):s.children[e].classList.add("jtags_error")):s.children[e].classList.remove("jtags_label"));t()},t=function(){s.innerText.trim()?s.classList.remove("jtags-empty"):s.children.length&&"BR"!==s.children[0].tagName||(s.innerHTML="",d(p()))},o=function(e){var t=[],n="";if(e=e.trim()){for(var o=0;o<e.length;o++)","==e[o]||";"==e[o]||"\n"==e[o]?n&&(t.push(n.trim()),n=""):n+=e[o];n&&t.push(n)}return t},n=0,l=function(e){n=window.getSelection().anchorOffset,t(),"Tab"===e.key||";"===e.key||","===e.key?(1<window.getSelection().anchorOffset&&(c()?"function"==typeof a.options.onlimit&&a.options.onlimit(a,a.options.limit):a.add("",!0)),e.preventDefault()):"Enter"==e.key?u&&u.isOpened()||(1<window.getSelection().anchorOffset&&(c()||a.add("",!0)),e.preventDefault()):"Backspace"==e.key&&1==s.children.length&&window.getSelection().anchorOffset<1&&e.preventDefault(),u&&u.keydown(e),t()},h=function(e){var t;39==e.which?1<(t=window.getSelection().anchorOffset)&&t==n&&a.add("",!0):13==e.which||38==e.which||40==e.which?e.preventDefault():u&&u.keyup(e),i()},g=function(e){e.clipboardData||e.originalEvent.clipboardData?t=(e.originalEvent||e).clipboardData.getData("text/plain"):window.clipboardData&&(t=window.clipboardData.getData("Text"));var t=o(t);if("function"==typeof a.options.onbeforepaste){var n=a.options.onbeforepaste(s,a,t);if(!1===n)return e.preventDefault(),!1;n&&(t=n)}1<t.length?(a.add(t,!0),e.preventDefault()):t[0]&&(document.execCommand("insertText",!1,t[0]),e.preventDefault())},m=function(e){var t;e.target.parentNode&&e.target.parentNode.classList.contains("jtags")&&(e.target.classList.contains("jtags_label")||e.target.classList.contains("jtags_error"))&&(t=e.target.getBoundingClientRect()).width-(e.clientX-t.left)<16&&a.remove(e.target),e.target==s&&d()},b=function(){s.classList.contains("jtags-focus")||(s.children.length&&!a.getValue(s.children.length-1)||c()||p(""),"function"==typeof a.options.onfocus&&a.options.onfocus(s,a,a.getValue()),s.classList.add("jtags-focus"))},j=function(){if(s.classList.contains("jtags-focus")){u&&u.close();for(var e=0;e<s.children.length-1;e++)a.getValue(e)||s.removeChild(s.children[e]);f(),s.classList.remove("jtags-focus"),"function"==typeof a.options.onblur&&a.options.onblur(s,a,a.getValue())}},"touchend"in document.documentElement==!0?s.addEventListener("touchend",m):s.addEventListener("mouseup",m),s.addEventListener("keydown",l),s.addEventListener("keyup",h),s.addEventListener("paste",g),s.addEventListener("focus",b),s.addEventListener("blur",j),s.setAttribute("contenteditable",!0),s.classList.add("jtags"),a.setOptions(e),"function"==typeof a.options.onload&&a.options.onload(s,a),s.change=a.setValue,s.val=function(e){if(void 0===e)return a.getValue();a.setValue(e)},s.tags=a)},toolbar:Z,upload:se,validations:A},ue=(M.image=se,M.image.create=function(e){var t=document.createElement("img");return t.setAttribute("src",e.file),t.className="jfile",t.setAttribute("tabindex",-1),t.content=e,t},M.tracker=te,M.loading=D.loading,M.sha512=ce(),"undefined"==typeof document||document.jsuitesComponents||ae(),M)}(),pe.default;function de(e){var t=o[e];return void 0!==t||(t=o[e]={exports:{}},n[e].call(t.exports,t,t.exports,de)),t.exports}var n,o,pe});